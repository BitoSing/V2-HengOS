<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Heng Application | Productivity Suite</title>

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;600;700&family=Noto+Sans+Khmer:wght@400;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.lordicon.com/lordicon.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <!-- Flatpickr (Date Picker) CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />

  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.11/typed.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <!-- Tesseract.js for OCR -->
  <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>

  <style>
    /* --- THEME VARIABLES --- */
    :root {
      /* Core Colors - Modern Professional Finance Theme */
      --primary-color: #2563eb; /* Modern Blue */
      --primary-dark: #1d4ed8;
      --primary-light: #3b82f6;
      --secondary-color: #7c3aed; /* Purple */
      --secondary-dark: #6d28d9;
      --accent-color: #06b6d4; /* Cyan */
      --success-color: #10b981;
      --warning-color: #f59e0b;
      --danger-color: #ef4444;
      
      /* Typography */
      --font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;
      --heading-font: "Poppins", sans-serif;
      --kh2018: "Noto Sans Khmer", sans-serif;

      /* Gradients - Modern */
      --hero-gradient: linear-gradient(135deg, #1e293b 0%, #312e81 50%, #2563eb 100%);
      --text-gradient: linear-gradient(135deg, #2563eb, #7c3aed);
      --card-gradient: linear-gradient(135deg, #f8fafc, #ffffff);
      --button-gradient: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
      
      /* Glassmorphism - Enhanced */
      --glass-bg: rgba(255, 255, 255, 0.9);
      --glass-border: rgba(255, 255, 255, 0.6);
      --glass-shadow: 0 8px 32px 0 rgba(37, 99, 235, 0.15);

      /* Light Theme Defaults - Professional */
      --bg-color: #f8fafc;
      --bg-secondary: #f1f5f9;
      --header-bg: rgba(255, 255, 255, 0.95);
      --card-bg: #ffffff;
      --card-hover: #f8fafc;
      --input-bg: #f8fafc;
      --input-focus: #ffffff;
      --text-color: #1e293b;
      --text-muted: #64748b;
      --text-light: #94a3b8;
      --heading-color: #0f172a;
      --border-color: #e2e8f0;
      --border-hover: #cbd5e1;

      /* Status Colors */
      --success: #10b981;
      --success-bg: #ecfdf5;
      --danger: #ef4444;
      --danger-bg: #fef2f2;
      --warning: #f59e0b;
      --warning-bg: #fffbeb;
      --warning-text: #92400e;
      --info: #06b6d4;
      --info-bg: #ecfeff;

      /* Shadows & Radius - Modern */
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-md: 0 8px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --shadow-glow: 0 0 20px rgba(37, 99, 235, 0.3);
      --shadow-card: 0 4px 20px rgba(0, 0, 0, 0.08);
      --shadow-card-hover: 0 8px 30px rgba(37, 99, 235, 0.12);
      --radius: 16px;
      --radius-lg: 24px;
      --radius-xl: 32px;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-smooth: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    body.dark-theme {
      --bg-color: #0f172a;
      --header-bg: rgba(15, 23, 42, 0.8);
      --card-bg: #1e293b;
      --input-bg: #334155;
      --text-color: #cbd5e1;
      --text-muted: #94a3b8;
      --heading-color: #f8fafc;
      --border-color: #334155;
      --glass-bg: rgba(30, 41, 59, 0.8);
      --glass-border: rgba(255, 255, 255, 0.1);
      --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
      --warning-bg: #422006;
      --warning-text: #fcd34d;
    }

    /* --- RESET & BASE --- */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; font-size: 16px; }
    
    body {
      font-family: var(--font-family);
      background-color: var(--bg-color);
      color: var(--text-color);
      padding-top: 0; /* Removed for sidebar layout */
      transition: background 0.3s, color 0.3s;
      line-height: 1.7;
      background-image: 
        radial-gradient(at 0% 0%, rgba(99, 102, 241, 0.1) 0px, transparent 50%),
        radial-gradient(at 100% 100%, rgba(236, 72, 153, 0.1) 0px, transparent 50%);
      background-attachment: fixed;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: var(--heading-font);
      color: var(--heading-color);
      line-height: 1.3;
      letter-spacing: -0.02em;
    }

    .khmer-font, :lang(km) { font-family: var(--khmer-font) !important; }

    /* --- LAYOUT --- */
    .app-shell { display: flex; flex-direction: column; min-height: 100vh; }
    main { 
      margin-left: 260px; /* Sidebar width + gap */
      padding: 2rem 3rem 6rem; 
      width: calc(100% - 260px); 
      flex: 1; 
      max-width: 1600px;
    }

    /* --- SIDEBAR (Formerly Header) --- */
    .app-header {
      position: fixed; top: 0; left: 0; bottom: 0;
      width: 240px; z-index: 1000;
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-right: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 0;
      padding: 2.5rem 1.5rem;
      display: flex; flex-direction: column; justify-content: flex-start; align-items: center;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 4px 0 30px rgba(0, 0, 0, 0.03);
    }
    /* Removed redundant .app-header.scrolled styles - they were identical to base */
    body.dark-theme .app-header {
      background: rgba(15, 23, 42, 0.7);
      border-color: rgba(255, 255, 255, 0.08);
    }

    .logo {
      font-size: 1.8rem; font-weight: 800; margin-bottom: 3rem;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      -webkit-background-clip: text; background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: -0.5px;
      position: relative; cursor: pointer;
      display: flex; align-items: center; gap: 0.8rem; width: 100%; justify-content: center;
    }
    .logo::before {
      content: "âœ¨"; font-size: 1.5rem; filter: grayscale(0);
      animation: spin-slow 12s linear infinite;
    }
    @keyframes spin-slow { 100% { transform: rotate(360deg); } }

    .main-nav { 
      display: flex; flex-direction: column; gap: 0.5rem; width: 100%;
      background: transparent; padding: 0; border-radius: 0;
      margin-bottom: auto; /* Push controls to bottom */
      position: relative;
    }
    body.dark-theme .main-nav { background: transparent; }

    .main-nav::before {
      content: '';
      position: absolute;
      top: -1rem;
      left: 1.5rem;
      right: 1.5rem;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--border-color), transparent);
      opacity: 0.3;
    }

    .main-nav a {
      text-decoration: none; color: var(--text-color); font-weight: 500;
      padding: 1rem 1.5rem; border-radius: 16px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      font-size: 0.95rem; display: flex; align-items: center; gap: 12px;
      position: relative; overflow: hidden;
    }
    
    .main-nav a::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.1), transparent);
      transition: left 0.5s ease;
    }
    
    .main-nav a:hover::before {
      left: 100%;
    }
    
    .main-nav a:hover { 
      color: var(--primary-color); 
      background: rgba(99, 102, 241, 0.05); 
      transform: translateX(8px) scale(1.02);
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.1);
    }
    body.dark-theme .main-nav a:hover { background: rgba(99, 102, 241, 0.08); }
    
    .main-nav a i {
      font-size: 1.1rem;
      transition: transform 0.3s ease;
    }
    
    .main-nav a:hover i {
      transform: scale(1.1) rotate(5deg);
    }
    
    .main-nav a.active { 
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(236, 72, 153, 0.05)); 
      color: var(--primary-color); 
      font-weight: 600;
      box-shadow: 0 4px 20px rgba(99, 102, 241, 0.15);
      border: 1px solid rgba(99, 102, 241, 0.2);
      transform: translateX(4px);
    }
    
    .main-nav a.active::after {
      content: '';
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      width: 4px;
      height: 20px;
      background: linear-gradient(180deg, var(--primary-color), var(--secondary-color));
      border-radius: 2px;
      animation: pulse-glow 2s ease-in-out infinite;
    }
    
    @keyframes pulse-glow {
      0%, 100% { opacity: 0.6; transform: translateY(-50%) scale(1); }
      50% { opacity: 1; transform: translateY(-50%) scale(1.2); }
    }

    .header-controls { 
      display: flex; flex-direction: column; gap: 0.8rem; width: 100%; 
      padding-top: 1.5rem; border-top: 1px solid var(--border-color);
      position: relative;
    }
    
    .header-controls::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 60%;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
      opacity: 0.3;
    }
    
    .theme-switch { 
      cursor: pointer; font-size: 1.1rem; padding: 0.9rem; 
      border-radius: 16px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      background: var(--input-bg); width: 100%; height: auto;
      display: flex; align-items: center; justify-content: center; gap: 10px;
      border: 1px solid transparent;
      position: relative; overflow: hidden;
    }
    
    .theme-switch::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.2), transparent);
      transition: left 0.6s ease;
    }
    
    .theme-switch:hover::before {
      left: 100%;
    }
    
    .theme-switch::after { content: "Toggle Theme"; font-size: 0.85rem; font-weight: 500; }
    .theme-switch:hover { 
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); 
      color: white; 
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
      border-color: rgba(99, 102, 241, 0.3);
    }

    /* Language Switcher */
    .language-selector { position: relative; width: 100%; }
    .language-btn {
      background: var(--input-bg); border: 1px solid transparent; width: 100%;
      color: var(--text-color); padding: 12px; border-radius: 16px;
      cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px;
      font-weight: 500; font-size: 0.9rem; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      height: auto; position: relative; overflow: hidden;
    }
    
    .language-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.1), transparent);
      transition: left 0.5s ease;
    }
    
    .language-btn:hover::before {
      left: 100%;
    }
    
    .language-btn:hover { 
      background: var(--card-bg); 
      box-shadow: 0 6px 20px rgba(0,0,0,0.08); 
      transform: translateY(-2px) scale(1.02);
      border-color: rgba(99, 102, 241, 0.2);
    }
    .dropdown-content {
      display: none; position: absolute; left: 105%; bottom: 0; top: auto; right: auto;
      background: var(--card-bg); border: 1px solid var(--border-color);
      border-radius: 20px; overflow: hidden; min-width: 180px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15); z-index: 100; 
      animation: slideInFade 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      padding: 0.6rem;
      backdrop-filter: blur(10px);
    }
    
    @keyframes slideInFade {
      from {
        opacity: 0;
        transform: translateX(-10px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateX(0) scale(1);
      }
    }
    .language-option {
      width: 100%; padding: 12px 18px; border: none; background: none;
      color: var(--text-color); text-align: left; cursor: pointer;
      display: flex; gap: 12px; align-items: center; font-size: 0.9rem;
      transition: all 0.2s ease; border-radius: 12px;
      position: relative; overflow: hidden;
    }
    
    .language-option::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.1), transparent);
      transition: left 0.3s ease;
    }
    
    .language-option:hover::before {
      left: 100%;
    }
    
    .language-option:hover { 
      background: var(--input-bg); 
      color: var(--primary-color);
      transform: translateX(4px);
    }

    /* --- NAVBAR SEARCH --- */
    .nav-search {
      position: relative; margin-bottom: 1rem; width: 100%;
    }
    
    .nav-search input {
      width: 100%; padding: 12px 45px 12px 16px;
      background: var(--input-bg); border: 2px solid transparent;
      border-radius: 16px; color: var(--text-color);
      font-size: 0.9rem; transition: all 0.3s ease;
      font-family: var(--font-family);
    }
    
    .nav-search input:focus {
      outline: none; border-color: var(--primary-color);
      background: var(--card-bg);
      box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
    }
    
    .nav-search i {
      position: absolute; right: 16px; top: 50%;
      transform: translateY(-50%); color: var(--text-muted);
      font-size: 0.9rem; pointer-events: none;
      transition: color 0.3s ease;
    }
    
    .nav-search input:focus + i {
      color: var(--primary-color);
    }
    
    /* Search Results Dropdown */
    .search-results {
      position: absolute; top: 100%; left: 0; right: 0;
      background: var(--card-bg); border: 1px solid var(--border-color);
      border-radius: 16px; margin-top: 0.5rem;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      max-height: 300px; overflow-y: auto; z-index: 100;
      display: none;
    }
    
    .search-result-item {
      padding: 12px 16px; cursor: pointer; transition: background 0.2s;
      display: flex; align-items: center; gap: 12px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .search-result-item:last-child {
      border-bottom: none;
    }
    
    .search-result-item:hover {
      background: var(--input-bg);
    }
    
    .search-result-item i {
      color: var(--primary-color); width: 20px;
    }
    
    .search-result-title {
      font-weight: 500; color: var(--text-color);
    }
    
    .search-result-desc {
      font-size: 0.8rem; color: var(--text-muted);
    }
    .hero-section {
      position: relative;
      background: var(--hero-gradient);
      border-radius: 32px;
      padding: 4rem 2rem 3rem;
      text-align: center; color: white;
      overflow: hidden; margin-bottom: 3rem;
      box-shadow: 0 15px 35px -10px rgba(0, 0, 0, 0.25);
      margin-top: 1rem;
      min-height: 400px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .hero-bg-circle {
      position: absolute; border-radius: 50%;
      background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0) 70%);
      animation: float 10s infinite ease-in-out;
      filter: blur(40px);
    }
    .c1 { width: 600px; height: 600px; top: -200px; left: -100px; animation-delay: 0s; background: radial-gradient(circle, rgba(99, 102, 241, 0.4) 0%, transparent 70%); }
    .c2 { width: 500px; height: 500px; bottom: -100px; right: -50px; animation-delay: 2s; background: radial-gradient(circle, rgba(236, 72, 153, 0.4) 0%, transparent 70%); }
    .c3 { width: 300px; height: 300px; top: 40%; left: 20%; animation-delay: 4s; background: radial-gradient(circle, rgba(6, 182, 212, 0.4) 0%, transparent 70%); }
    
    @keyframes float {
      0%, 100% { transform: translate(0, 0); }
      33% { transform: translate(30px, -50px); }
      66% { transform: translate(-20px, 20px); }
    }

    .hero-content { position: relative; z-index: 2; max-width: 700px; margin: 0 auto; }
    .hero-content h1 {
      font-size: 3rem; font-weight: 800; margin-bottom: 1rem;
      background: var(--text-gradient);
      -webkit-background-clip: text; background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 5px 20px rgba(0,0,0,0.15);
      letter-spacing: -1px;
      line-height: 1.2;
    }
    .hero-content .subtitle { 
      font-size: 1.1rem; color: #e0e7ff; margin-bottom: 2rem; 
      font-weight: 300; max-width: 600px; margin-left: auto; margin-right: auto;
      opacity: 0.9;
    }

    .quote-container {
      margin-top: 2rem; padding: 2.5rem 3rem;
      background: rgba(255, 255, 255, 0.08); backdrop-filter: blur(20px);
      border-radius: 28px; border: 1px solid rgba(255, 255, 255, 0.25);
      min-height: 140px; display: flex; flex-direction: column;
      justify-content: center; align-items: center;
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      max-width: 750px; margin-left: auto; margin-right: auto;
      position: relative; overflow: hidden;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }
    
    .quote-container::before {
      content: '"';
      position: absolute;
      top: -15px;
      left: 25px;
      font-size: 5rem;
      color: rgba(255, 255, 255, 0.15);
      font-family: Georgia, serif;
      animation: float-quote 6s ease-in-out infinite;
    }
    
    .quote-container::after {
      content: '"';
      position: absolute;
      bottom: -35px;
      right: 25px;
      font-size: 5rem;
      color: rgba(255, 255, 255, 0.15);
      font-family: Georgia, serif;
      animation: float-quote 6s ease-in-out infinite reverse;
    }
    
    @keyframes float-quote {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-10px) rotate(5deg); }
    }
    .quote-container:hover { 
      background: rgba(255, 255, 255, 0.12); 
      transform: translateY(-8px) scale(1.03); 
      box-shadow: 0 20px 40px rgba(0,0,0,0.15);
      border-color: rgba(255, 255, 255, 0.4);
    }
    
    .quote-text { 
      font-size: 1.2rem; font-style: italic; color: #fff; margin-bottom: 1rem; 
      font-weight: 300; line-height: 1.6;
      position: relative; z-index: 2;
      transition: all 0.6s ease;
    }
    
    .quote-author { 
      font-size: 0.85rem; font-weight: 700; color: var(--accent-color); 
      text-transform: uppercase; letter-spacing: 2px; 
      background: rgba(0,0,0,0.25); padding: 6px 16px; border-radius: 20px;
      position: relative; z-index: 2;
      transition: all 0.6s ease;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .quote-text.fade-in {
      animation: quoteTextFadeIn 1.2s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }
    
    .quote-author.fade-in {
      animation: quoteAuthorFadeIn 1.2s cubic-bezier(0.4, 0, 0.2, 1) 0.4s forwards;
    }
    
    @keyframes quoteTextFadeIn {
      0% {
        opacity: 0;
        transform: translateY(30px) scale(0.95);
        filter: blur(2px);
      }
      50% {
        opacity: 0.7;
        transform: translateY(-5px) scale(1.02);
        filter: blur(0px);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
        filter: blur(0px);
      }
    }
    
    @keyframes quoteAuthorFadeIn {
      0% {
        opacity: 0;
        transform: translateY(20px) scale(0.9);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }
    
    .quote-text.fade-out {
      animation: quoteTextFadeOut 0.6s ease-in forwards;
    }
    
    .quote-author.fade-out {
      animation: quoteAuthorFadeOut 0.6s ease-in forwards;
    }
    
    @keyframes quoteTextFadeOut {
      to {
        opacity: 0;
        transform: translateY(-20px) scale(1.05);
        filter: blur(1px);
      }
    }
    
    @keyframes quoteAuthorFadeOut {
      to {
        opacity: 0;
        transform: translateY(-15px) scale(0.95);
      }
    }

    /* --- CARDS & GRID --- */
    .section-title {
      font-size: 2.2rem; margin-bottom: 2.5rem; padding-left: 1.5rem;
      border-left: 5px solid var(--primary-color); display: flex; align-items: center;
      font-weight: 700; letter-spacing: -1px;
    }
    #link-grid { 
      display: grid; 
      grid-template-columns: repeat(5, 1fr); 
      gap: 1.5rem; 
      max-width: 1400px;
      margin: 0 auto;
    }
    
    /* Enhanced Mobile Responsive Grid */
    @media (max-width: 1200px) {
      #link-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 1.2rem;
      }
    }
    
    @media (max-width: 900px) {
      #link-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 1rem;
      }
    }
    
    @media (max-width: 768px) {
      #link-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
        padding: 0 1rem;
      }
      
      .link-item {
        padding: 1.5rem 1rem;
        min-height: 180px;
      }
      
      .link-icon {
        width: 50px;
        height: 50px;
        font-size: 1.3rem;
      }
      
      .link-content h3 {
        font-size: 1.1rem;
      }
      
      .link-content p {
        font-size: 0.85rem;
      }
    }
    
    @media (max-width: 480px) {
      #link-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
        padding: 0 0.5rem;
      }
      
      .link-item {
        padding: 1.2rem;
        min-height: 160px;
        flex-direction: row;
        align-items: center;
        gap: 1rem;
      }
      
      .link-icon {
        width: 60px;
        height: 60px;
        flex-shrink: 0;
        margin-bottom: 0;
      }
      
      .link-content {
        flex: 1;
      }
      
      .link-arrow {
        position: static;
        width: 32px;
        height: 32px;
        flex-shrink: 0;
      }
    }
    
    .link-item {
      background: var(--card-bg); 
      border: 1px solid var(--border-color); border-radius: 20px;
      padding: 2rem 1.5rem; text-decoration: none; transition: var(--transition);
      position: relative; overflow: hidden; display: flex; flex-direction: column;
      box-shadow: var(--shadow); min-height: 220px;
    }
    .link-item:hover {
      transform: translateY(-10px); 
      box-shadow: var(--shadow-lg), var(--shadow-glow);
      border-color: var(--primary-color);
    }
    .link-icon {
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(236, 72, 153, 0.1));
      width: 60px; height: 60px; border-radius: 16px;
      display: flex; align-items: center; justify-content: center; margin-bottom: 1rem;
      transition: var(--transition);
      font-size: 1.5rem; color: var(--primary-color);
    }
    .link-item:hover .link-icon { 
      transform: scale(1.1) rotate(5deg); 
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
    }
    .link-content h3 { font-size: 1.2rem; margin-bottom: 0.6rem; font-weight: 700; line-height: 1.3; }
    .link-content p { color: var(--text-muted); font-size: 0.9rem; line-height: 1.5; }
    .link-arrow {
      position: absolute; top: 2rem; right: 2rem; font-size: 1.2rem;
      color: var(--border-color); transition: var(--transition);
      background: var(--input-bg); width: 40px; height: 40px;
      display: flex; align-items: center; justify-content: center; border-radius: 50%;
    }
    .link-item:hover .link-arrow { 
      background: var(--primary-color); color: white; 
      transform: rotate(-45deg); 
    }

    /* Custom Icon Styles */
    .link-icon.custom-icon {
      width: 70px; height: 70px; border-radius: 18px;
      display: flex; align-items: center; justify-content: center;
      font-size: 2rem; color: white;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }

    .link-icon.ocr-icon { background: linear-gradient(135deg, #10b981, #059669); }
    .link-icon.voice-icon { background: linear-gradient(135deg, #6366f1, #4f46e5); }
    .link-icon.business-icon { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
    .link-icon.finance-icon { background: linear-gradient(135deg, #f59e0b, #d97706); }
    .link-icon.email-icon { background: linear-gradient(135deg, #ec4899, #db2777); }



    /* --- CALCULATOR STYLES --- */
    .calc-header { text-align: center; margin-bottom: 3rem; animation: fadeInDown 0.6s ease; }
    .calc-header-title {
      font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      -webkit-background-clip: text; background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .calc-header-subtitle { color: var(--text-muted); font-size: 1.1rem; }

    .calculator-grid { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(420px, 1fr)); 
      gap: 2.5rem; 
      max-width: 1800px;
      margin: 0 auto;
    }
    
    /* Enhanced Business Calc Layout */
    #calc-grid {
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
      align-items: start;
    }
    
    /* Enhanced Responsive Design */
    @media (max-width: 1400px) {
      #calc-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1.5rem;
      }
      
      #finance-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1.5rem;
      }
      
      .calc-card {
        min-height: 240px;
      }
    }
    
    
    @media (max-width: 768px) {
      #calc-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      
      #finance-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      
      .calc-card {
        min-height: auto;
        padding: 1rem;
      }
      
      .calc-header {
        font-size: 1rem;
        margin-bottom: 0.8rem;
      }
      
      .input-group {
        gap: 0.8rem;
      }
      
      .input-row {
        grid-template-columns: 1fr;
        gap: 0.8rem;
      }
      
      .formulas-info-btn-small {
        padding: 8px 12px;
        font-size: 0.8rem;
        min-height: 36px;
      }
      
      .formulas-info-btn-small i {
        font-size: 0.8rem;
      }
    }
    
    @media (max-width: 480px) {
      main {
        padding: 0.8rem;
        padding-top: 3.5rem;
      }
      
      .hero-section {
        margin: 0.8rem 0 1.5rem;
        padding: 1.5rem 0.8rem;
        min-height: 250px;
        border-radius: 16px;
      }
      
      .hero-content h1 {
        font-size: 1.8rem;
      }
      
      .hero-content .subtitle {
        font-size: 0.9rem;
        margin-bottom: 1.5rem;
      }
      
      .quote-container {
        margin-top: 1.5rem;
        padding: 1.5rem;
        min-height: 120px;
        border-radius: 16px;
      }
      
      .quote-text {
        font-size: 1rem;
      }
      
      .section-title {
        font-size: 1.5rem;
        margin-bottom: 1.2rem;
        padding-left: 0.8rem;
      }
      
      .calc-card {
        padding: 1rem;
        border-radius: 14px;
      }
      
      .calc-header-title {
        font-size: 1.6rem;
      }
      
      .calc-header-subtitle {
        font-size: 0.85rem;
      }
      
      .result-value {
        font-size: 1.4rem;
      }
      
      .formulas-info-btn-small {
        padding: 8px 12px;
        font-size: 0.8rem;
        min-height: 36px;
        gap: 6px;
        border-radius: 10px;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
        user-select: none;
        -webkit-user-select: none;
      }
      
      .formulas-info-btn-small span {
        display: inline;
      }
      
      .formulas-info-btn-small i {
        font-size: 0.85rem;
      }
      
      .btn-primary {
        padding: 12px 20px;
        font-size: 0.85rem;
        border-radius: 12px;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
      }
      
      input, select {
        font-size: 0.9rem;
        padding: 12px 14px;
        border-radius: 12px;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
      }
      
      .field-wrapper label {
        font-size: 0.9rem;
        margin-bottom: 0.6rem;
      }
      
      .sub-results {
        grid-template-columns: 1fr;
        gap: 0.5rem;
      }
      
      .calculator-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      
      /* Enhanced back button styles */
      .back-btn {
        padding: 12px 16px;
        font-size: 0.85rem;
        gap: 8px;
        border-radius: 20px;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
      }
      
      .back-btn i {
        font-size: 0.9rem;
        width: 18px;
        height: 18px;
      }
      
      .back-btn-wrapper {
        margin-bottom: 1.2rem;
      }
      
      .back-btn:hover {
        transform: translateX(-4px) translateY(-1px) scale(1.02);
        box-shadow: 0 6px 20px rgba(99, 102, 241, 0.25);
      }
      
      .back-btn:hover i {
        transform: translateX(-2px) rotate(-8deg) scale(1.05);
      }
    }
    
    @media (max-width: 768px) {
      .card-icon {
        width: 56px;
        height: 56px;
        font-size: 1.5rem;
      }
      
      .card-title {
        font-size: 1.3rem;
      }
      
      .result-value {
        font-size: 1.8rem;
      }
      
      .input-row {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      
      .sub-results {
        grid-template-columns: 1fr;
        gap: 0.6rem;
      }
      
      .calculator-grid {
        grid-template-columns: 1fr;
        gap: 1.5rem;
      }
      
      /* Responsive back button styles */
      .back-btn {
        padding: 14px 20px;
        font-size: 0.9rem;
        gap: 10px;
      }
      
      .back-btn i {
        font-size: 1rem;
        width: 20px;
        height: 20px;
      }
      
      .back-btn:hover {
        transform: translateX(-8px) translateY(-2px) scale(1.03);
      }
      
      .back-btn:hover i {
        transform: translateX(-4px) rotate(-12deg) scale(1.05);
      }
    }
    
    @media (max-width: 480px) {
      main {
        padding: 1rem;
      }
      
      .calc-card {
        padding: 1.2rem;
      }
      
      .calc-header-title {
        font-size: 2rem;
      }
      
      .result-value {
        font-size: 1.6rem;
      }
      
      .btn-primary {
        padding: 14px 24px;
        font-size: 0.9rem;
      }
      
      /* Extra small screen back button styles */
      .back-btn {
        padding: 12px 16px;
        font-size: 0.85rem;
        gap: 8px;
        border-radius: 25px;
      }
      
      .back-btn i {
        font-size: 0.9rem;
        width: 18px;
        height: 18px;
      }
      
      .back-btn-wrapper {
        margin-bottom: 1.5rem;
      }
      
      .back-btn:hover {
        transform: translateX(-6px) translateY(-1px) scale(1.02);
        box-shadow: 0 8px 25px rgba(99, 102, 241, 0.25);
      }
      
      .back-btn:hover i {
        transform: translateX(-3px) rotate(-10deg) scale(1.05);
      }
    }
    
    @media (min-width: 1600px) {
      #calc-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 1.8rem;
        max-width: 1800px;
      }
    }
    
    @media (min-width: 1920px) {
      #calc-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 2rem;
        max-width: 2000px;
      }
    }
    
    .calc-card {
      background: var(--card-bg); 
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg); 
      padding: 1.5rem; 
      box-shadow: var(--shadow-card);
      transition: var(--transition-smooth); 
      display: flex; 
      flex-direction: column;
      position: relative;
      overflow: hidden;
      min-height: 260px;
    }
    
    .calc-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .calc-card:hover::before {
      opacity: 1;
    }
    
    .calc-card:hover { 
      transform: translateY(-12px) scale(1.02); 
      box-shadow: var(--shadow-card-hover); 
      border-color: var(--primary-color);
      background: var(--card-hover);
    }
    
    .card-header {
      display: flex; 
      align-items: center; 
      justify-content: space-between;
      margin-bottom: 1rem; 
      padding-bottom: 0.75rem; 
      border-bottom: 2px solid var(--border-color);
      position: relative;
    }
    
    .card-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 80px;
      height: 2px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      border-radius: 1px;
      transition: width 0.3s ease;
    }
    
    .calc-card:hover .card-header::after {
      width: 120px;
    }
    .header-left { display: flex; align-items: center; gap: 12px; }
    .card-icon {
      width: 48px; 
      height: 48px; 
      border-radius: var(--radius);
      background: linear-gradient(135deg, rgba(37, 99, 235, 0.1), rgba(124, 58, 237, 0.1)); 
      color: var(--primary-color);
      display: flex; 
      align-items: center; 
      justify-content: center; 
      font-size: 1.4rem;
      font-weight: 600;
      transition: var(--transition-smooth);
      box-shadow: 0 4px 15px rgba(37, 99, 235, 0.2);
      position: relative;
      overflow: hidden;
    }
    
    .card-icon::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transform: rotate(45deg);
      transition: transform 0.6s ease;
    }
    
    .calc-card:hover .card-icon::before {
      transform: rotate(45deg) translate(50%, 50%);
    }
    
    .calc-card:hover .card-icon {
      transform: scale(1.1) rotate(5deg);
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      box-shadow: 0 8px 25px rgba(37, 99, 235, 0.4);
    }
    .card-title { 
      font-size: 1.25rem; 
      font-weight: 700; 
      color: var(--heading-color);
      letter-spacing: -0.02em;
    }
    
    .reset-btn {
      background: var(--input-bg); 
      border: 2px solid var(--border-color);
      color: var(--text-muted);
      cursor: pointer; 
      font-size: 1.1rem; 
      padding: 14px; 
      border-radius: var(--radius);
      transition: var(--transition-smooth);
      display: flex;
      align-items: center;
      justify-content: center;
      width: 48px;
      height: 48px;
      position: relative;
      overflow: hidden;
    }
    
    .reset-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(239, 68, 68, 0.05));
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: all 0.4s ease;
    }
    
    .reset-btn:hover::before {
      width: 100%;
      height: 100%;
    }
    
    .reset-btn:hover { 
      color: var(--danger-color); 
      transform: rotate(180deg) scale(1.1);
      border-color: rgba(239, 68, 68, 0.3);
      box-shadow: 0 4px 15px rgba(239, 68, 68, 0.2);
    }

    .input-group { 
      display: flex; 
      flex-direction: column; 
      gap: 1rem; 
      margin-bottom: 1.2rem; 
    }
    
    .input-row { 
      display: grid; 
      grid-template-columns: 1fr 1fr; 
      gap: 1.5rem; 
      align-items: end;
    }
    
    .field-wrapper label {
      display: block; 
      font-size: 0.95rem; 
      font-weight: 600; 
      margin-bottom: 0.75rem;
      color: var(--text-color);
      letter-spacing: -0.01em;
      transition: color 0.2s ease;
    }
    
    .field-wrapper:hover label {
      color: var(--primary-color);
    }
    
    .kh-label { 
      font-family: "Noto Sans Khmer"; 
      font-weight: 400; 
      font-size: 0.85rem; 
      color: var(--text-muted); 
      margin-left: 8px;
      opacity: 0.8;
    }
    
    .calc-card input, .calc-card select {
      width: 100%; 
      padding: 10px 12px; 
      font-size: 0.9rem;
      background: var(--input-bg); 
      border: 2px solid var(--border-color);
      border-radius: var(--radius); 
      color: var(--text-color); 
      transition: var(--transition-smooth);
      font-family: var(--font-family);
      font-weight: 500;
      position: relative;
    }
    
    .calc-card input::placeholder {
      color: var(--text-muted);
      opacity: 0.6;
      font-style: normal;
      font-weight: 400;
    }
    
    .calc-card input:focus, .calc-card select:focus {
      outline: none; 
      background: var(--input-focus);
      border-color: var(--primary-color); 
      box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1), var(--shadow-sm);
      transform: translateY(-2px);
    }
    
    .calc-card input:hover, .calc-card select:hover {
      border-color: var(--border-hover);
      background: var(--card-hover);
    }

    .output-area {
      margin-top: auto; 
      padding: 1rem; 
      background: linear-gradient(135deg, var(--input-bg), rgba(37, 99, 235, 0.03));
      border-radius: var(--radius); 
      border: 1px solid var(--border-color);
      position: relative;
      overflow: hidden;
      transition: var(--transition-smooth);
    }
    
    .calc-card:hover .output-area {
      border-color: var(--primary-color);
      background: linear-gradient(135deg, var(--card-hover), rgba(37, 99, 235, 0.05));
    }
    
    .output-area::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      opacity: 0.6;
      transition: opacity 0.3s ease;
    }
    
    .calc-card:hover .output-area::before {
      opacity: 1;
    }
    .main-result {
      text-align: center; 
      margin-bottom: 1rem; 
      background: var(--card-bg);
      padding: 1rem; 
      border-radius: var(--radius); 
      box-shadow: var(--shadow-sm);
      position: relative;
      overflow: hidden;
      transition: var(--transition-smooth);
    }
    
    .calc-card:hover .main-result {
      box-shadow: var(--shadow-md);
      transform: translateY(-2px);
    }
    
    .main-result::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      border-radius: 2px;
      transition: width 0.3s ease;
    }
    
    .calc-card:hover .main-result::before {
      width: 140px;
    }
    .result-label {
      font-size: 0.75rem; 
      text-transform: uppercase; 
      letter-spacing: 1.5px;
      color: var(--text-muted); 
      font-weight: 600; 
      font-style: italic;
      display: block; 
      margin-bottom: 8px;
      opacity: 0.6;
    }
    .result-value {
      font-size: 1.8rem; 
      font-weight: 800; 
      color: var(--primary-dark);
      display: block; 
      line-height: 1.1;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: -0.02em;
      transition: var(--transition-smooth);
    }
    
    .calc-card:hover .result-value {
      transform: scale(1.05);
    }
    .sub-results { 
      display: grid; 
      grid-template-columns: 1fr 1fr; 
      gap: 0.6rem; 
    }
    
    .sub-item { 
      text-align: center; 
      padding: 0.5rem; 
      background: rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      border: 1px solid rgba(226, 232, 240, 0.5);
      transition: all 0.3s ease;
    }
    
    .sub-item:hover {
      background: var(--card-bg);
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }
    
    .sub-val { 
      font-size: 1rem; 
      font-weight: 600; 
      color: var(--text-color);
      display: block;
      margin-top: 2px;
      transition: all 0.3s ease;
    }
    
    /* Positive/Negative value highlighting */
    .sub-val.positive {
      color: var(--success);
      background: linear-gradient(135deg, var(--success), #059669);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 700;
    }
    
    .sub-val.negative {
      color: var(--danger);
      background: linear-gradient(135deg, var(--danger), #dc2626);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 700;
    }
    
    .sub-item.positive {
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05));
      border-color: rgba(16, 185, 129, 0.3);
    }
    
    .sub-item.negative {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.05));
      border-color: rgba(239, 68, 68, 0.3);
    }

    /* --- BUTTONS --- */
    .btn-primary {
      padding: 16px 32px; 
      background: var(--button-gradient);
      color: white; 
      border: none; 
      border-radius: var(--radius); 
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer; 
      transition: var(--transition-smooth); 
      box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
      display: inline-flex; 
      align-items: center; 
      justify-content: center; 
      gap: 10px;
      position: relative;
      overflow: hidden;
    }
    
    .btn-primary::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.6s ease;
    }
    
    .btn-primary:hover::before {
      left: 100%;
    }
    
    .btn-primary:hover { 
      transform: translateY(-3px) scale(1.02); 
      box-shadow: 0 8px 25px rgba(37, 99, 235, 0.4); 
    }
    
    .btn-primary:active { 
      transform: translateY(-1px) scale(0.98); 
      transition: all 0.1s ease;
    }
    
    .back-btn-wrapper {
      display: flex;
      align-items: center;
      margin-bottom: 2rem;
      position: relative;
    }
    
    .back-btn {
      display: inline-flex; 
      align-items: center; 
      gap: 12px;
      text-decoration: none; 
      color: var(--text-color); 
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      padding: 16px 28px; 
      border-radius: 50px; 
      font-weight: 600;
      font-size: 0.95rem;
      letter-spacing: 0.02em;
      position: relative;
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      box-shadow: 0 8px 32px 0 rgba(37, 99, 235, 0.15);
      z-index: 1;
    }
    
    .back-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.15), transparent);
      transition: left 0.6s ease;
      border-radius: 50px;
      z-index: 0;
    }
    
    .back-btn::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      opacity: 0;
      transition: opacity 0.4s ease;
      border-radius: 50px;
      z-index: -1;
    }
    
    .back-btn:hover::before {
      left: 100%;
    }
    
    .back-btn:hover::after {
      opacity: 0.1;
    }
    
    .back-btn i {
      font-size: 1.1rem;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      z-index: 2;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
    }
    
    .back-btn span {
      position: relative;
      z-index: 2;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      font-weight: 600;
    }
    
    .back-btn:hover { 
      color: var(--primary-color); 
      border-color: rgba(99, 102, 241, 0.4); 
      transform: translateX(-12px) translateY(-3px) scale(1.05);
      box-shadow: 0 15px 45px rgba(99, 102, 241, 0.3), 0 8px 32px 0 rgba(31, 38, 135, 0.2);
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(25px);
      -webkit-backdrop-filter: blur(25px);
    }
    
    .back-btn:hover i {
      transform: translateX(-6px) rotate(-15deg) scale(1.1);
      color: var(--primary-color);
      filter: drop-shadow(0 2px 8px rgba(99, 102, 241, 0.4));
    }
    
    .back-btn:hover span {
      font-weight: 700;
      letter-spacing: 0.04em;
    }
    
    .back-btn:active {
      transform: translateX(-8px) translateY(-1px) scale(0.98);
      transition: all 0.1s ease;
      box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
    }
    
    /* Focus styles for accessibility */
    .back-btn:focus-visible {
      outline: 2px solid var(--primary-color);
      outline-offset: 3px;
    }
    
    /* Loading state animation */
    .back-btn.loading {
      pointer-events: none;
      opacity: 0.7;
    }
    
    .back-btn.loading i {
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      100% { transform: rotate(360deg); }
    }
    
    body.dark-theme .back-btn {
      background: rgba(30, 41, 59, 0.8);
      border-color: rgba(255, 255, 255, 0.1);
      box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
    }
    
    body.dark-theme .back-btn:hover {
      background: rgba(30, 41, 59, 0.9);
      border-color: rgba(99, 102, 241, 0.3);
      box-shadow: 0 15px 45px rgba(99, 102, 241, 0.4), 0 8px 32px 0 rgba(0, 0, 0, 0.5);
    }
    
    body.dark-theme .back-btn::after {
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.8), rgba(124, 58, 237, 0.8));
    }

    /* --- FINANCE --- */
    .finance-layout { display: grid; grid-template-columns: 1fr; gap: 2rem; align-items: flex-start; }
    
    /* Finance Grid Equal Height */
    #finance-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.2rem;
      align-items: stretch;
    }
    
    #finance-grid .calc-card {
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    
    #finance-grid .output-area {
      margin-top: auto;
    }
    .finance-info-panel {
      background: var(--card-bg); 
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg); 
      padding: 2.5rem; 
      position: sticky; 
      top: 100px;
      box-shadow: var(--shadow-card);
      transition: var(--transition-smooth);
      overflow: hidden;
    }
    
    .finance-info-panel::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      opacity: 0.8;
    }
    
    .finance-info-panel:hover {
      box-shadow: var(--shadow-card-hover);
      border-color: var(--primary-color);
      transform: translateY(-4px);
    }
    .currency-switcher { 
      display: flex; 
      background: linear-gradient(135deg, var(--input-bg), rgba(37, 99, 235, 0.05)); 
      border-radius: 50px; 
      padding: 3px; 
      border: 1px solid var(--border-color);
      transition: var(--transition-smooth);
      position: relative;
      overflow: hidden;
    }
    
    .currency-switcher:hover {
      border-color: var(--primary-color);
      box-shadow: var(--shadow-sm);
      transform: translateY(-1px);
    }
    
    .currency-btn {
      background: transparent; 
      border: none; 
      border-radius: 50px;
      padding: 6px 12px; 
      cursor: pointer; 
      font-weight: 600; 
      font-size: 0.9rem;
      color: var(--text-muted); 
      transition: var(--transition-smooth);
      position: relative;
      z-index: 2;
      min-width: 35px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .currency-btn:hover {
      color: var(--primary-color);
      transform: scale(1.02);
    }
    
    .currency-btn.active { 
      background: var(--button-gradient); 
      color: white; 
      box-shadow: var(--shadow-sm);
      transform: scale(1.02);
      font-weight: 700;
    }
    
    .currency-btn.active::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.6s ease;
    }
    
    .currency-btn.active:hover::before {
      left: 100%;
    }
    
    .formula-box {
      background: linear-gradient(135deg, var(--input-bg), rgba(37, 99, 235, 0.03)); 
      padding: 1.5rem; 
      border-left: 4px solid var(--primary-color);
      margin-bottom: 1rem; 
      border-radius: var(--radius); 
      font-family: 'Courier New', monospace; 
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-color);
      transition: var(--transition-smooth);
      position: relative;
      overflow: hidden;
    }
    
    .formula-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(37, 99, 235, 0.05), transparent);
      transform: translateX(-100%);
      transition: transform 0.6s ease;
    }
    
    .formula-box:hover::before {
      transform: translateX(100%);
    }
    
    .formula-box:hover {
      background: linear-gradient(135deg, var(--card-hover), rgba(37, 99, 235, 0.05));
      border-left-color: var(--secondary-color);
      transform: translateX(4px);
      box-shadow: var(--shadow-sm);
    }
    .tax-table { 
      width: 100%; 
      border-collapse: collapse; 
      margin-bottom: 1.5rem; 
      font-size: 0.9rem;
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow-sm);
    }
    
    .tax-table th { 
      text-align: left; 
      background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
      color: white; 
      padding: 16px 12px; 
      font-weight: 600;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .tax-table td { 
      padding: 14px 12px; 
      border-bottom: 1px solid var(--border-color);
      transition: var(--transition-smooth);
    }
    
    .tax-table tr:hover td {
      background: var(--input-bg);
    }
    
    .tax-table tr:last-child td {
      border-bottom: none;
    }
    .finance-section-header {
      margin: 2.5rem 0 1.5rem 0; font-size: 1.6rem; border-bottom: 2px solid var(--border-color);
      padding-bottom: 0.8rem; display: flex; align-items: center; gap: 12px;
    }
    
    /* Finance Section Header with Button */
    .finance-section-header-with-btn {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 2.5rem 0 1.5rem 0;
      padding-bottom: 0.8rem;
      border-bottom: 2px solid var(--border-color);
      position: relative;
    }
    
    .finance-section-header-with-btn::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 80px;
      height: 2px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      border-radius: 1px;
      transition: width 0.3s ease;
    }
    
    .finance-section-header-with-btn:hover::after {
      width: 120px;
    }
    
    /* Small Formulas Button */
    .formulas-info-btn-small {
      background: var(--button-gradient);
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: var(--radius);
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
      box-shadow: var(--shadow-sm);
      position: relative;
      overflow: hidden;
      min-height: 40px;
      white-space: nowrap;
    }
    
    .formulas-info-btn-small::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.6s ease;
    }
    
    .formulas-info-btn-small:hover::before {
      left: 100%;
    }
    
    .formulas-info-btn-small:hover {
      transform: translateY(-2px) scale(1.02);
      box-shadow: var(--shadow-md);
    }
    .disclaimer-card {
      background: var(--warning-bg); color: var(--warning-text); padding: 1rem;
      border-radius: 12px; font-size: 0.9rem; margin-bottom: 2rem; border: 1px solid rgba(245, 158, 11, 0.2);
      display: flex; align-items: center; gap: 10px;
    }
    .disclaimer-card::before { content: "\f071"; font-family: "Font Awesome 6 Free"; font-weight: 900; }
    
    /* Formula Card Enhancements */
    .formula-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: var(--radius);
      padding: 2rem;
      margin-bottom: 2rem;
      transition: var(--transition-smooth);
      position: relative;
      overflow: hidden;
    }
    
    .formula-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      opacity: 0.6;
      transition: opacity 0.3s ease;
    }
    
    .formula-card:hover::before {
      opacity: 1;
    }
    
    .formula-card:hover {
      box-shadow: var(--shadow-md);
      border-color: var(--primary-color);
      transform: translateY(-2px);
    }
    
    .formula-card h4 {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--heading-color);
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .formula-card h4::before {
      content: '\f1c0';
      font-family: 'Font Awesome 6 Free';
      font-weight: 900;
      color: var(--primary-color);
      font-size: 1rem;
    }
    
    /* Panel Header Styles */
    .panel-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid var(--border-color);
      position: relative;
    }
    
    .panel-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 80px;
      height: 2px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      border-radius: 1px;
      transition: width 0.3s ease;
    }
    
    .finance-info-panel:hover .panel-header::after {
      width: 120px;
    }
    
    .panel-icon {
      width: 48px;
      height: 48px;
      border-radius: var(--radius);
      background: linear-gradient(135deg, rgba(37, 99, 235, 0.1), rgba(124, 58, 237, 0.1));
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary-color);
      font-size: 1.2rem;
      transition: var(--transition-smooth);
    }
    
    .finance-info-panel:hover .panel-icon {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      transform: scale(1.1) rotate(5deg);
    }
    
    .panel-header h3 {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--heading-color);
      margin: 0;
    }
    
    /* Formula Grid Layout */
    .formula-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }
    
    @media (max-width: 768px) {
      .formula-grid {
        grid-template-columns: 1fr;
      }
    }
    
    /* Formula Note Styles */
    .formula-note {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 1rem;
      padding: 1rem;
      background: var(--info-bg);
      border-radius: var(--radius);
      color: var(--text-color);
      font-size: 0.9rem;
      transition: var(--transition-smooth);
    }
    
    .formula-note:hover {
      background: linear-gradient(135deg, var(--info-bg), rgba(6, 182, 212, 0.05));
      transform: translateX(4px);
    }
    
    .formula-note i {
      color: var(--info);
      font-size: 1rem;
    }
    
    /* Table Wrapper */
    .table-wrapper {
      border-radius: var(--radius);
      overflow: hidden;
      margin-bottom: 1rem;
    }

    /* --- MODAL STYLES --- */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
      z-index: 2000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .modal-overlay.active {
      opacity: 1 !important;
      visibility: visible !important;
      display: flex !important;
    }
    
    .modal {
      background: var(--card-bg);
      border-radius: var(--radius-xl);
      max-width: 900px;
      width: 90%;
      max-height: 85vh;
      overflow: hidden;
      box-shadow: var(--shadow-xl);
      transform: scale(0.9) translateY(20px);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
    }
    
    .modal-overlay.active .modal {
      transform: scale(1) translateY(0);
    }
    
    /* Enhanced Mobile Modal */
    @media (max-width: 768px) {
      .modal-overlay {
        padding: 1rem;
      }
      
      .modal {
        max-width: 100%;
        width: 100%;
        max-height: 95vh;
        border-radius: var(--radius);
      }
      
      .modal-header {
        padding: 1.5rem;
      }
      
      .modal-header h2 {
        font-size: 1.4rem;
      }
      
      .modal-header p {
        font-size: 0.9rem;
      }
      
      .modal-close {
        width: 36px;
        height: 36px;
        font-size: 1rem;
      }
    }
    
    @media (max-width: 480px) {
      .modal-overlay {
        padding: 0.5rem;
      }
      
      .modal {
        max-height: 98vh;
        border-radius: 12px;
      }
      
      .modal-header {
        padding: 1rem;
      }
      
      .modal-header h2 {
        font-size: 1.2rem;
      }
      
      .modal-header p {
        font-size: 0.85rem;
      }
      
      .modal-close {
        width: 32px;
        height: 32px;
        font-size: 0.9rem;
      }
    }
    
    .modal-header {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      padding: 2rem;
      position: relative;
      overflow: hidden;
    }
    
    .modal-header::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -10%;
      width: 300px;
      height: 300px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      animation: float 6s ease-in-out infinite;
    }
    
    .modal-header h2 {
      font-size: 1.8rem;
      color: white;
      font-weight: 700;
      margin: 0;
      position: relative;
      z-index: 2;
    }
    
    .modal-header p {
      margin: 0.5rem 0 0 0;
      opacity: 0.9;
      position: relative;
      z-index: 2;
    }
    
    .modal-close {
      position: absolute;
      top: 1.5rem;
      right: 1.5rem;
      background: rgba(255, 255, 255, 0.2);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      color: white;
      font-size: 1.2rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      z-index: 3;
    }
    
    .modal-close:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: rotate(90deg) scale(1.1);
    }
    
    .modal-body {
      padding: 2.5rem;
      max-height: calc(85vh - 120px);
      overflow-y: auto;
    }
    
    .modal-body::-webkit-scrollbar {
      width: 8px;
    }
    
    .modal-body::-webkit-scrollbar-track {
      background: var(--input-bg);
      border-radius: 4px;
    }
    
    .modal-body::-webkit-scrollbar-thumb {
      background: var(--primary-color);
      border-radius: 4px;
    }
    
    .modal-section {
      margin-bottom: 2.5rem;
    }
    
    .modal-section:last-child {
      margin-bottom: 0;
    }
    
    .modal-section h3 {
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--heading-color);
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .modal-section h3 i {
      color: var(--primary-color);
      font-size: 1.2rem;
    }
    
    /* Formulas Info Button */
    .formulas-info-btn {
      background: var(--button-gradient);
      color: white;
      border: none;
      padding: 16px 24px;
      border-radius: var(--radius);
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: var(--transition-smooth);
      box-shadow: var(--shadow-md);
      margin: 2rem auto 0;
      position: relative;
      overflow: hidden;
    }
    
    .formulas-info-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.6s ease;
    }
    
    .formulas-info-btn:hover::before {
      left: 100%;
    }
    
    .formulas-info-btn:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: var(--shadow-lg);
    }
    
    @media (max-width: 768px) {
      .modal {
        width: 95%;
        max-height: 90vh;
        margin: 20px auto;
      }
      
      .modal-header {
        padding: 1.2rem;
      }
      
      .modal-header h2 {
        font-size: 1.3rem;
        margin-bottom: 0.5rem;
      }
      
      .modal-header p {
        font-size: 0.9rem;
      }
      
      .modal-body {
        padding: 1.2rem;
        max-height: 70vh;
        overflow-y: auto;
      }
      
      .modal-section {
        margin-bottom: 1.5rem;
      }
      
      .modal-section h3 {
        font-size: 1.1rem;
        margin-bottom: 1rem;
      }
      
      .formula-grid {
        grid-template-columns: 1fr;
        gap: 0.8rem;
      }
      
      .formula-box {
        padding: 0.8rem;
        font-size: 0.9rem;
      }
      
      .tax-bracket-table {
        font-size: 0.8rem;
      }
      
      .tax-bracket-table th,
      .tax-bracket-table td {
        padding: 0.5rem;
      }
    }

    /* Formula Explanation Styles */
    .formula-explanation {
      padding: 1.5rem;
      border-left: 4px solid var(--primary-color);
      background: linear-gradient(135deg, var(--input-bg), rgba(37, 99, 235, 0.03));
      border-radius: var(--radius);
      margin-bottom: 1rem;
      transition: var(--transition-smooth);
    }
    
    .formula-explanation:last-child {
      margin-bottom: 0;
    }
    
    .formula-explanation:hover {
      background: linear-gradient(135deg, var(--card-hover), rgba(37, 99, 235, 0.05));
      transform: translateX(4px);
      box-shadow: var(--shadow-sm);
    }
    
    .formula-explanation h4 {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }
    
    .formula-explanation p {
      color: var(--text-muted);
      margin: 0;
      line-height: 1.6;
    }

    /* --- OCR / TEXT EXTRACTION STYLES --- */
    .ocr-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; min-height: 60vh; }
    .ocr-upload-zone {
      background: var(--card-bg); border: 3px dashed var(--border-color);
      border-radius: 24px; padding: 2rem; display: flex; flex-direction: column;
      align-items: center; justify-content: center; text-align: center;
      transition: var(--transition); cursor: pointer; min-height: 400px;
      position: relative; overflow: hidden;
    }
    .ocr-upload-zone:hover, .ocr-upload-zone.drag-over {
      border-color: var(--primary-color); background: rgba(59, 130, 246, 0.05);
    }
    .ocr-preview-img { max-width: 100%; max-height: 350px; border-radius: 12px; box-shadow: var(--shadow-lg); display: none; }
    .ocr-placeholder i { font-size: 4rem; color: var(--text-muted); margin-bottom: 1.5rem; opacity: 0.5; }
    
    .ocr-controls {
      background: var(--card-bg); border: 1px solid var(--border-color);
      border-radius: 24px; padding: 2rem; display: flex; flex-direction: column; gap: 1.5rem;
    }
    .ocr-lang-select { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 10px; }
    .lang-chip {
      background: var(--input-bg); border: 1px solid var(--border-color);
      padding: 12px; text-align: center; border-radius: 12px; cursor: pointer;
      font-size: 0.9rem; transition: var(--transition); display: flex;
      align-items: center; justify-content: center; gap: 6px;
    }
    .lang-chip.active {
      background: rgba(59, 130, 246, 0.1); border-color: var(--primary-color);
      color: var(--primary-color); font-weight: 600;
    }
    .ocr-textarea {
      flex: 1; width: 100%; padding: 1.5rem; border: 1px solid var(--border-color);
      border-radius: 16px; background: var(--input-bg); color: var(--text-color);
      font-family: var(--font-family); resize: none; min-height: 250px;
      font-size: 1rem; line-height: 1.6; transition: var(--transition);
    }
    .ocr-textarea:focus { outline: none; border-color: var(--primary-color); background: var(--card-bg); }
    .ocr-textarea.kh-text { font-family: "Noto Sans Khmer", sans-serif; line-height: 2; }

    .progress-container {
      width: 100%; background: var(--input-bg); border-radius: 10px;
      height: 6px; overflow: hidden; display: none;
    }
    .progress-bar { height: 100%; background: var(--primary-color); width: 0%; transition: width 0.3s; }
    .status-text { font-size: 0.9rem; color: var(--text-muted); text-align: center; font-weight: 500; }

    /* --- ABOUT --- */
    .about-container { margin-top: 3rem; }
    .about-intro { 
      display: flex; align-items: center; gap: 5rem; margin-bottom: 5rem; 
      position: relative; padding: 3rem; background: var(--card-bg); 
      border-radius: 30px; border: 1px solid var(--border-color); 
      box-shadow: var(--shadow-lg); overflow: hidden;
    }
    .about-intro::before {
      content: ''; position: absolute; top: -50%; right: -10%; width: 400px; height: 400px;
      background: radial-gradient(circle, rgba(59, 130, 246, 0.1), transparent);
      border-radius: 50%; pointer-events: none;
    }
    .about-img-wrapper { 
      position: relative; width: 350px; height: 350px; flex-shrink: 0; z-index: 1;
    }
    .about-img-wrapper::before {
      content: ''; position: absolute; top: -10px; left: -10px; right: -10px; bottom: -10px;
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
      border-radius: 35px; z-index: -1; opacity: 0.3; animation: pulse 3s ease-in-out infinite;
    }
    .about-img {
      width: 100%; height: 100%; object-fit: cover; border-radius: 30px;
      box-shadow: var(--shadow-lg); transform: rotate(-3deg); transition: var(--transition);
      border: 8px solid var(--card-bg);
    }
    .about-img-wrapper:hover .about-img { transform: rotate(0deg) scale(1.02); }
    .about-text { position: relative; z-index: 1; }
    .about-text h2 { font-size: 3rem; margin-bottom: 0.5rem; line-height: 1.1; }
    .about-text .highlight {
      background: linear-gradient(120deg, var(--primary-color) 0%, var(--accent-color) 100%);
      -webkit-background-clip: text; background-clip: text;
      -webkit-text-fill-color: transparent; animation: gradient-shift 3s ease infinite;
    }
    .about-text .role { font-size: 1.6rem; color: var(--text-color); margin-bottom: 1.5rem; display: block; }
    .about-text .bio-text { 
      font-size: 1.1rem; line-height: 1.8; color: var(--text-muted); 
      margin-bottom: 2rem; max-width: 600px;
    }
    .social-links { display: flex; gap: 1.2rem; flex-wrap: wrap; }
    .social-btn {
      width: 55px; height: 55px; border-radius: 50%; background: var(--card-bg);
      border: 2px solid var(--border-color); display: flex; align-items: center; justify-content: center;
      color: var(--text-color); font-size: 1.4rem; transition: var(--transition); 
      box-shadow: var(--shadow); position: relative; overflow: hidden;
    }
    .social-btn::before {
      content: ''; position: absolute; inset: 0; background: var(--primary-color);
      transform: scale(0); border-radius: 50%; transition: transform 0.3s ease;
    }
    .social-btn:hover::before { transform: scale(1); }
    .social-btn i { position: relative; z-index: 1; }
    .social-btn:hover { color: white; transform: translateY(-5px) rotate(5deg); border-color: var(--primary-color); }

    /* Stats Section */
    .stats-section { 
      display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
      gap: 2rem; margin-bottom: 5rem;
    }
    .stat-card {
      background: var(--card-bg); padding: 2.5rem 2rem; border-radius: 20px;
      border: 1px solid var(--border-color); text-align: center; transition: var(--transition);
      box-shadow: var(--shadow); position: relative; overflow: hidden;
    }
    .stat-card::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
    }
    .stat-card:hover { transform: translateY(-8px); box-shadow: var(--shadow-lg); border-color: var(--primary-color); }
    .stat-number { 
      font-size: 3rem; font-weight: 800; 
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
      -webkit-background-clip: text; background-clip: text;
      -webkit-text-fill-color: transparent; margin-bottom: 0.5rem;
    }
    .stat-label { font-size: 1rem; color: var(--text-muted); font-weight: 600; }

    .services-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2.5rem; margin-bottom: 5rem; }
    .service-card {
      background: var(--card-bg); padding: 3rem 2rem; border-radius: 24px;
      border: 1px solid var(--border-color); text-align: center; transition: var(--transition);
      box-shadow: var(--shadow); position: relative; overflow: hidden;
    }
    .service-card::before {
      content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.05), rgba(139, 92, 246, 0.05));
      opacity: 0; transition: opacity 0.3s ease;
    }
    .service-card:hover::before { opacity: 1; }
    .service-card:hover { transform: translateY(-10px); border-color: var(--primary-color); box-shadow: var(--shadow-lg); }
    .service-icon { 
      font-size: 3.5rem; color: var(--primary-color); margin-bottom: 1.5rem; 
      transition: var(--transition); position: relative; z-index: 1;
    }
    .service-card:hover .service-icon { transform: scale(1.1) rotate(5deg); }
    .service-card h3 { margin-bottom: 1rem; font-size: 1.4rem; position: relative; z-index: 1; }
    .service-card p { color: var(--text-muted); line-height: 1.6; position: relative; z-index: 1; }

    /* Skills Section */
    .split-section { display: flex; gap: 4rem; flex-wrap: wrap; }
    .col-left, .col-right { flex: 1; min-width: 320px; }
    .skill-bar { margin-bottom: 2rem; }
    .skill-info { display: flex; justify-content: space-between; margin-bottom: 0.8rem; font-weight: 600; }
    .skill-name { display: flex; align-items: center; gap: 0.5rem; }
    .skill-icon { font-size: 1.2rem; color: var(--primary-color); }
    .progress-bg { 
      width: 100%; height: 14px; background: var(--input-bg); border-radius: 10px; 
      overflow: hidden; position: relative; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
    }
    .progress-fill { 
      height: 100%; background: linear-gradient(90deg, var(--primary-color), var(--accent-color)); 
      border-radius: 10px; position: relative; transition: width 1s ease;
      box-shadow: 0 2px 8px rgba(59, 130, 246, 0.4);
    }
    .progress-fill::after {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      animation: shimmer 2s infinite;
    }
    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    @keyframes pulse {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(1.05); }
    }
    @keyframes gradient-shift {
      0%, 100% { filter: hue-rotate(0deg); }
      50% { filter: hue-rotate(10deg); }
    }

    /* Experience Timeline */
    .timeline-section { margin-bottom: 5rem; }
    .timeline { position: relative; padding-left: 3rem; }
    .timeline::before {
      content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 3px;
      background: linear-gradient(180deg, var(--primary-color), var(--accent-color));
      border-radius: 2px;
    }
    .timeline-item { 
      position: relative; margin-bottom: 3rem; padding-left: 2rem;
    }
    .timeline-item::before {
      content: ''; position: absolute; left: -3.5rem; top: 0; width: 16px; height: 16px;
      background: var(--primary-color); border-radius: 50%; border: 3px solid var(--bg-color);
      box-shadow: 0 0 0 4px var(--card-bg);
    }
    .timeline-date { 
      font-size: 0.9rem; color: var(--primary-color); font-weight: 700; 
      margin-bottom: 0.5rem; display: inline-block; padding: 0.3rem 1rem;
      background: rgba(59, 130, 246, 0.1); border-radius: 20px;
    }
    .timeline-content h4 { font-size: 1.3rem; margin-bottom: 0.5rem; }
    .timeline-content p { color: var(--text-muted); line-height: 1.6; }

    .contact-form { display: flex; flex-direction: column; gap: 1.2rem; }
    .form-group input, .form-group textarea {
      width: 100%; padding: 16px; border-radius: 12px; border: 1px solid var(--border-color);
      background: var(--input-bg); color: var(--text-color); font-family: inherit; transition: var(--transition);
    }
    .form-group input:focus, .form-group textarea:focus { 
      outline: none; border-color: var(--primary-color); background: var(--card-bg); 
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    .form-group textarea { resize: vertical; min-height: 150px; }

    footer {
      text-align: center; padding: 5rem 1.5rem 2rem; margin-top: 4rem; color: var(--text-muted);
      font-size: 0.9rem; border-top: 1px solid var(--border-color);
      background: linear-gradient(180deg, var(--bg-color) 0%, rgba(99, 102, 241, 0.05) 50%, var(--card-bg) 100%);
      position: relative; overflow: hidden;
    }
    
    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--primary-color), var(--secondary-color), transparent);
      opacity: 0.6;
      animation: gradient-flow 3s ease-in-out infinite;
    }
    
    footer::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.8), transparent);
      animation: shimmer-flow 4s ease-in-out infinite;
    }
    
    @keyframes gradient-flow {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 0.8; }
    }
    
    @keyframes shimmer-flow {
      0% { left: -100%; }
      100% { left: 100%; }
    }
    
    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 3rem;
      margin-bottom: 3rem;
      position: relative;
      z-index: 2;
    }
    
    .footer-section {
      text-align: left;
      transition: transform 0.3s ease;
    }
    
    .footer-section:hover {
      transform: translateY(-3px);
    }
    
    .footer-section h3 {
      color: var(--text-color);
      font-size: 1.2rem;
      margin-bottom: 1.5rem;
      font-weight: 700;
      position: relative;
      padding-bottom: 0.8rem;
    }
    
    .footer-section h3::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 50px;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      border-radius: 2px;
      transition: width 0.3s ease;
    }
    
    .footer-section:hover h3::after {
      width: 80px;
    }
    
    .footer-section p, .footer-section a {
      color: var(--text-muted);
      text-decoration: none;
      line-height: 1.8;
      transition: color 0.3s ease, transform 0.2s ease;
      display: inline-block;
      margin-bottom: 0.5rem;
    }
    
    .footer-section a:hover {
      color: var(--primary-color);
      transform: translateX(5px);
    }
    
    .footer-section p {
      margin-bottom: 1rem;
    }
    
    .footer-bottom {
      padding-top: 3rem;
      border-top: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 2rem;
      position: relative;
      z-index: 2;
      background: rgba(255, 255, 255, 0.02);
      border-radius: 16px;
      padding: 2rem 2.5rem;
      margin: 0 auto;
      max-width: 1200px;
      backdrop-filter: blur(10px);
    }
    
    .footer-bottom::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      border-radius: 2px;
    }
    
    .footer-copyright {
      display: flex;
      align-items: center;
      gap: 1rem;
      color: var(--text-muted);
      font-size: 0.9rem;
    }
    
    .footer-copyright::before {
      content: 'Â©';
      color: var(--primary-color);
      font-weight: 700;
      font-size: 1.1rem;
    }
    
    .footer-links {
      display: flex;
      gap: 2.5rem;
      flex-wrap: wrap;
      align-items: center;
    }
    
    .footer-links a {
      color: var(--text-muted);
      text-decoration: none;
      font-size: 0.85rem;
      transition: color 0.3s ease, transform 0.2s ease;
      position: relative;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid transparent;
    }
    
    .footer-links a::before {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 2px;
      background: var(--primary-color);
      transition: width 0.3s ease;
    }
    
    .footer-links a:hover {
      color: var(--primary-color);
      transform: translateY(-2px);
      background: rgba(99, 102, 241, 0.1);
      border-color: rgba(99, 102, 241, 0.2);
    }
    
    .footer-links a:hover::before {
      width: 80%;
    }
    
    .footer-heart {
      color: #e74c3c;
      animation: heartbeat 1.5s ease-in-out infinite;
      margin: 0 0.3rem;
    }
    
    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.2); }
    }
    
    .footer-social {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .footer-social a {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--input-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-muted);
      transition: all 0.3s ease;
      border: 1px solid var(--border-color);
    }
    
    .footer-social a:hover {
      background: var(--primary-color);
      color: white;
      transform: translateY(-3px) scale(1.1);
      border-color: var(--primary-color);
      box-shadow: 0 5px 15px rgba(99, 102, 241, 0.3);
    }
    
    .footer-badge {
      display: inline-block;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      margin-top: 1rem;
      animation: pulse-badge 2s ease-in-out infinite;
    }
    
    @keyframes pulse-badge {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    /* Mobile & Tablet */
    @media (max-width: 1024px) {
      body { padding-top: 80px; }
      main { margin-left: 0; width: 100%; padding: 0 1.5rem 4rem; }
      
      footer { padding: 4rem 1.5rem 2rem; margin-top: 3rem; }
      .footer-content { gap: 2rem; }
      .footer-section h3 { font-size: 1.1rem; }
      .footer-social a { width: 35px; height: 35px; }
      
      .app-header {
        position: fixed;
        width: 280px;
        height: 100vh;
        top: 0;
        right: 0;
        transform: translateX(100%);
        flex-direction: column;
        padding: 2.5rem 1.5rem;
        border-left: 1px solid rgba(255,255,255,0.5);
        border-right: none;
        border-radius: 0;
        z-index: 1000;
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: -4px 0 30px rgba(0, 0, 0, 0.1);
      }
      
      .app-header.mobile-open {
        transform: translateX(0);
        box-shadow: -4px 0 40px rgba(0, 0, 0, 0.2);
      }
      
      .app-header.mobile-open .logo {
        animation: slideInLogo 0.6s ease-out 0.2s both;
      }
      
      .app-header.mobile-open .main-nav a {
        animation: slideInNav 0.5s ease-out both;
        animation-fill-mode: both;
      }
      
      .app-header.mobile-open .main-nav a:nth-child(1) { animation-delay: 0.1s; }
      .app-header.mobile-open .main-nav a:nth-child(2) { animation-delay: 0.2s; }
      .app-header.mobile-open .header-controls > * {
        animation: slideInControl 0.5s ease-out both;
      }
      
      .app-header.mobile-open .header-controls > *:nth-child(1) { animation-delay: 0.3s; }
      .app-header.mobile-open .header-controls > *:nth-child(2) { animation-delay: 0.4s; }
      
      @keyframes slideInLogo {
        from {
          opacity: 0;
          transform: translateX(30px) scale(0.8);
        }
        to {
          opacity: 1;
          transform: translateX(0) scale(1);
        }
      }
      
      @keyframes slideInNav {
        from {
          opacity: 0;
          transform: translateX(20px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      
      @keyframes slideInControl {
        from {
          opacity: 0;
          transform: translateX(20px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      
      body.dark-theme .app-header {
        background: rgba(15, 23, 42, 0.95);
        border-color: rgba(255, 255, 255, 0.1);
        box-shadow: 4px 0 30px rgba(0, 0, 0, 0.3);
      }
      
      .logo {
        font-size: 1.6rem;
        margin-bottom: 2rem;
      }
      
      .main-nav {
        margin-bottom: 2rem;
      }
      
      .header-controls {
        padding-top: 1.5rem;
        margin-top: auto;
      }
      
      .hamburger { 
        display: flex; 
        align-items: center; 
        justify-content: center;
        font-size: 1.4rem; 
        color: var(--primary-color); 
        background: linear-gradient(135deg, var(--card-bg), rgba(99, 102, 241, 0.08)); 
        border: 2px solid var(--border-color);
        cursor: pointer;
        width: 56px; 
        height: 56px; 
        border-radius: 18px;
        position: fixed;
        top: 1rem;
        right: 1rem;
        z-index: 1001;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
        overflow: hidden;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        user-select: none;
        -webkit-user-select: none;
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
      }
      
      .hamburger::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.15), transparent);
        transition: left 0.6s ease;
      }
      
      .hamburger:hover::before {
        left: 100%;
      }
      
      .hamburger:hover {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); 
        border-color: var(--primary-color);
        transform: scale(1.08) translateY(-3px) rotate(-5deg);
        box-shadow: 0 12px 35px rgba(99, 102, 241, 0.4);
        color: white;
      }
      
      .hamburger:active {
        transform: scale(0.96) translateY(-1px);
      }
      
      .hamburger.active {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); 
        border-color: var(--primary-color);
        color: white;
        box-shadow: 0 12px 35px rgba(99, 102, 241, 0.4);
        transform: scale(1.05) translateY(-2px);
      }
      
      .hamburger.active i {
        transform: rotate(45deg) scale(1.1);
        color: white;
      }
      
      .hamburger i {
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        font-size: 1.3rem;
        position: relative;
        z-index: 2;
      }
      
      .hamburger:hover i {
        transform: rotate(180deg) scale(1.15);
      }
      
      /* Add pulsing animation for active state */
      .hamburger.active::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 100%;
        height: 100%;
        border: 2px solid var(--primary-color);
        border-radius: 18px;
        transform: translate(-50%, -50%);
        animation: pulse-hamburger 2s ease-in-out infinite;
        pointer-events: none;
      }
      
      @keyframes pulse-hamburger {
        0%, 100% {
          opacity: 0;
          transform: translate(-50%, -50%) scale(1);
        }
        50% {
          opacity: 0.3;
          transform: translate(-50%, -50%) scale(1.2);
        }
      }
      
      @keyframes ripple {
        to {
          transform: scale(4);
          opacity: 0;
        }
      }
      
      /* Overlay for mobile menu */
      .mobile-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
      }
      
      .mobile-overlay.active {
        display: block;
      }
      .app-header.scrolled { width: 95%; top: 0.5rem; }
      
      .logo { margin-bottom: 0; width: auto; font-size: 1.5rem; }
      .logo::before { font-size: 1.2rem; }
      
      .main-nav {
        display: none; position: fixed; top: 80px; left: 0; right: 0;
        width: 90%; margin: 0 auto; background: var(--card-bg);
        border-radius: 24px; padding: 2rem;
        box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        border: 1px solid var(--border-color);
        z-index: 999; max-height: 70vh; overflow-y: auto;
        backdrop-filter: blur(20px);
        transform: translateY(-20px) scale(0.95);
        opacity: 0;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      .main-nav.active { 
        display: flex; 
        transform: translateY(0) scale(1);
        opacity: 1;
      }
      
      .header-controls { 
        flex-direction: row; width: auto; padding: 0; border: none; gap: 0.8rem;
        position: fixed;
        top: 1rem;
        left: 1rem;
        z-index: 1002;
        background: var(--header-bg);
        padding: 0.5rem;
        border-radius: 20px;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid var(--border-color);
      }
      .theme-switch, .language-btn { width: 40px; height: 40px; padding: 0; border-radius: 50%; }
      .theme-switch::after { content: none; }
      .language-btn span { display: none; } /* Hide text on mobile */
      .dropdown-content { left: auto; right: 0; bottom: auto; top: 120%; }
      
      /* Mobile search adjustments */
      .nav-search { margin-bottom: 1.5rem; }
      .search-results { max-height: 200px; }
      
      .hamburger { 
        display: block; font-size: 1.3rem; color: var(--primary-color); 
        background: rgba(255, 255, 255, 0.95); 
        border: 2px solid rgba(99, 102, 241, 0.2);
        cursor: pointer;
        width: 56px; height: 56px; border-radius: 18px;
        display: flex; align-items: center; justify-content: center;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
        position: fixed;
        top: 1rem;
        right: 1rem;
        z-index: 1001;
        overflow: hidden;
        box-shadow: 0 8px 32px rgba(99, 102, 241, 0.15);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        user-select: none;
        -webkit-user-select: none;
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
      }
      
      .hamburger::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.1), transparent);
        transition: left 0.6s ease;
      }
      
      .hamburger:hover::before {
        left: 100%;
      }
      
      .hamburger:hover {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); 
        border-color: var(--primary-color);
        transform: scale(1.05) translateY(-2px);
        box-shadow: 0 12px 40px rgba(99, 102, 241, 0.25);
        color: white;
      }
      
      .hamburger:active {
        transform: scale(0.95);
      }
      
      .hamburger.active {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); 
        border-color: var(--primary-color);
        color: white;
        box-shadow: 0 12px 40px rgba(99, 102, 241, 0.3);
      }
      
      .hamburger.active i {
        transform: rotate(45deg) scale(1.1);
        color: white;
      }
      
      .hamburger i {
        transition: all 0.3s ease;
        font-size: 1.4rem;
        position: relative;
        z-index: 2;
      }
      
      .hamburger:hover i {
        transform: rotate(180deg) scale(1.15);
      }
      
      /* Hamburger Lines Animation */
      .hamburger-lines {
        width: 24px;
        height: 18px;
        position: relative;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        align-items: center;
      }
      
      .line {
        width: 100%;
        height: 2.5px;
        background: var(--primary-color);
        border-radius: 2px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        transform-origin: center;
      }
      
      .hamburger:hover .line {
        background: white;
      }
      
      .hamburger.active .line-1 {
        transform: rotate(45deg) translate(6px, 6px);
        background: white;
      }
      
      .hamburger.active .line-2 {
        opacity: 0;
        transform: translateX(20px);
        background: white;
      }
      
      .hamburger.active .line-3 {
        transform: rotate(-45deg) translate(6px, -6px);
        background: white;
      }

      .finance-layout { grid-template-columns: 1fr; }
      .finance-info-panel { position: static; margin-top: 3rem; }
      .stats-section { grid-template-columns: repeat(2, 1fr); }
      .timeline { padding-left: 2.5rem; }
      .timeline-item { padding-left: 1.5rem; }
      
      /* Responsive grid for tablets */
      #link-grid { 
        grid-template-columns: repeat(2, 1fr); 
        gap: 1.5rem; 
      }
    }

    @media (max-width: 1200px) {
      /* Medium screens - 3 columns */
      #link-grid { 
        grid-template-columns: repeat(3, 1fr); 
        gap: 1.5rem; 
      }
      
      .hero-content h1 { font-size: 2.8rem; }
    }

    @media (max-width: 768px) {
      .hero-content h1 { font-size: 3rem; }
      .app-header { width: 95%; padding: 0.8rem 1.2rem; }
      
      .about-intro { flex-direction: column; text-align: center; gap: 3rem; padding: 3rem 2rem; }
      .about-intro::before { display: none; }
      .about-img-wrapper { width: 300px; height: 300px; }
      .about-text .bio-text { max-width: 100%; }
      .social-links { justify-content: center; }
      
      .stats-section { grid-template-columns: 1fr; gap: 2rem; }
      .stat-number { font-size: 3rem; }
      .services-grid { grid-template-columns: 1fr; gap: 2rem; }
      .split-section { gap: 3rem; }
      .ocr-layout { grid-template-columns: 1fr; }
      
      /* Mobile grid - 1 column */
      #link-grid { 
        grid-template-columns: 1fr; 
        gap: 1.5rem; 
      }
      
      footer { padding: 3rem 1rem 1.5rem; margin-top: 2rem; }
      .footer-content { 
        grid-template-columns: 1fr; 
        gap: 2rem; 
        text-align: center;
      }
      .footer-section { text-align: center; }
      .footer-section h3::after { left: 50%; transform: translateX(-50%); }
      .footer-bottom { flex-direction: column; gap: 1rem; }
      .footer-links { justify-content: center; }
    }
    @media (max-width: 480px) {
      /* Enhanced hamburger button for mobile */
      .hamburger {
        width: 56px;
        height: 56px;
        font-size: 1.4rem;
        border-radius: 18px;
        top: 0.8rem;
        right: 0.8rem;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 2px solid rgba(99, 102, 241, 0.2);
        box-shadow: 0 8px 32px rgba(99, 102, 241, 0.15);
      }
      
      .hamburger i {
        font-size: 1.4rem;
      }
      
      .hamburger:hover {
        transform: scale(1.06) translateY(-2px) rotate(-3deg);
        box-shadow: 0 12px 40px rgba(99, 102, 241, 0.25);
      }
      
      .hamburger.active {
        transform: scale(1.03) translateY(-1px);
      }
    }
    @media (min-width: 769px) { .hamburger { display: none; } }
    @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  </style>
</head>

<body>
  
  <div class="app-shell">

    <!-- Header -->
    <header class="app-header">
      <div class="logo">Heng App</div>

      <nav class="main-nav" id="main-nav">
        <!-- Search Bar -->
        <div class="nav-search" id="nav-search">
          <input type="text" placeholder="Search features..." id="search-input">
          <i class="fas fa-search"></i>
        </div>
        
        <a href="#resources" id="nav-home" class="active">
          <i class="fas fa-home"></i>
          <span data-translate-key="navHome">Home</span>
        </a>
        <a href="#about" id="nav-about">
          <i class="fas fa-user"></i>
          <span data-translate-key="navAbout">About Me</span>
        </a>
      </nav>

      <div class="header-controls">
        <!-- Language -->
        <div class="language-selector" id="lang-switcher">
          <button class="language-btn">
            <img id="flag-icon" src="https://flagcdn.com/us.svg" width="20" alt="Lang">
            <span id="lang-text">EN</span>
            <i class="fas fa-chevron-down" style="font-size:0.8rem"></i>
          </button>
          <div class="dropdown-content" id="lang-dropdown">
            <button class="language-option" onclick="setLanguage('en')">
              <img src="https://flagcdn.com/us.svg" width="20" alt="US"> English
            </button>
            <button class="language-option" onclick="setLanguage('kh')">
              <img src="https://flagcdn.com/kh.svg" width="20" alt="KH"> <span class="khmer-font">ážáŸ’áž˜áŸ‚ážš</span>
            </button>
          </div>
        </div>
        <!-- Theme -->
        <div class="theme-switch" id="theme-toggle">ðŸŒ™</div>
      </div>
    </header>

    <!-- Mobile Menu Button -->
    <button class="hamburger" id="menu-btn" aria-label="Toggle navigation menu" aria-expanded="false">
      <div class="hamburger-lines">
        <span class="line line-1"></span>
        <span class="line line-2"></span>
        <span class="line line-3"></span>
      </div>
    </button>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-overlay" id="mobile-overlay"></div>

    <!-- Main Content Area -->
    <main id="content-area">
      <!-- Javascript will inject content here -->
    </main>

    <footer>
      <div class="footer-content">
        <div class="footer-section">
          <h3>Heng Application</h3>
          <p>Your centralized dashboard for productivity, system tools, and automation. Building efficient solutions for modern workflows.</p>
        </div>
        
        <div class="footer-section">
          <h3>Quick Links</h3>
          <a href="#resources">Home</a><br>
          <a href="#business-calc">Business Tools</a><br>
          <a href="#finance-tools">Finance Hub</a><br>
          <a href="#about">About</a>
        </div>
        
        <div class="footer-section">
          <h3>Resources</h3>
          <a href="#text-extraction">Text Extraction</a><br>
          <a href="#voice-extraction">Voice Tools</a><br>
          <a href="mailto:Singlovesmiles@gmail.com">Contact</a>
        </div>
        
        <div class="footer-section">
          <h3>Connect</h3>
          <p>Follow us on social media for updates and news.</p>
          <div class="footer-social">
            <a href="https://www.facebook.com/sing.rithano.96" target="_blank" title="Facebook">
              <i class="fab fa-facebook-f"></i>
            </a>
            <a href="https://github.com/BitoSing" target="_blank" title="GitHub">
              <i class="fab fa-github"></i>
            </a>
            <a href="https://www.linkedin.com/in/ly-heng-54a474220/" target="_blank" title="LinkedIn">
              <i class="fab fa-linkedin-in"></i>
            </a>
            <a href="https://www.instagram.com/ly_henggg/" target="_blank" title="Instagram">
              <i class="fab fa-instagram"></i>
            </a>
            <a href="https://t.me/LyHengg" target="_blank" title="Telegram">
              <i class="fab fa-telegram-plane"></i>
            </a>
          </div>
          <div class="footer-badge">v2.0</div>
        </div>
      </div>
      
      <div class="footer-bottom">
        <p data-translate-key="footerText">2025 Heng Application. All Rights Reserved.</p>
        <div class="footer-links">
          <a href="#">Privacy Policy</a>
          <a href="#">Terms of Service</a>
        </div>
      </div>
    </footer>
  </div>

  <script>
    // --- MOBILE MENU TOGGLE ---
    const hamburgerBtn = document.getElementById('menu-btn');
    const appHeader = document.querySelector('.app-header');
    const mobileOverlay = document.getElementById('mobile-overlay');
    
    if (hamburgerBtn && appHeader && mobileOverlay) {
      const toggleMobileMenu = (isOpen) => {
        if (isOpen) {
          appHeader.classList.add('mobile-open');
          hamburgerBtn.classList.add('active');
          mobileOverlay.classList.add('active');
          hamburgerBtn.setAttribute('aria-expanded', 'true');
          document.body.style.overflow = 'hidden'; // Prevent background scrolling
        } else {
          appHeader.classList.remove('mobile-open');
          hamburgerBtn.classList.remove('active');
          mobileOverlay.classList.remove('active');
          hamburgerBtn.setAttribute('aria-expanded', 'false');
          document.body.style.overflow = ''; // Restore scrolling
        }
      };
      
      hamburgerBtn.addEventListener('click', (e) => {
        // Add ripple effect
        const ripple = document.createElement('span');
        const rect = hamburgerBtn.getBoundingClientRect();
        const size = Math.max(rect.width, rect.height);
        const x = e.clientX - rect.left - size / 2;
        const y = e.clientY - rect.top - size / 2;
        
        ripple.style.cssText = `
          position: absolute;
          width: ${size}px;
          height: ${size}px;
          border-radius: 50%;
          background: rgba(255, 255, 255, 0.5);
          left: ${x}px;
          top: ${y}px;
          transform: scale(0);
          animation: ripple 0.6s ease-out;
          pointer-events: none;
        `;
        
        hamburgerBtn.appendChild(ripple);
        setTimeout(() => ripple.remove(), 600);
        
        const isOpen = appHeader.classList.contains('mobile-open');
        toggleMobileMenu(!isOpen);
      });
      
      // Close menu when clicking on overlay
      mobileOverlay.addEventListener('click', () => {
        toggleMobileMenu(false);
      });
      
      // Close menu when clicking outside
      document.addEventListener('click', (e) => {
        if (!appHeader.contains(e.target) && !hamburgerBtn.contains(e.target) && !mobileOverlay.contains(e.target)) {
          toggleMobileMenu(false);
        }
      });
      
      // Close menu on Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && appHeader.classList.contains('mobile-open')) {
          toggleMobileMenu(false);
        }
      });
      
      // Handle window resize
      window.addEventListener('resize', () => {
        if (window.innerWidth > 1024 && appHeader.classList.contains('mobile-open')) {
          toggleMobileMenu(false);
        }
      });
      
      // Add swipe gesture support for mobile
      let touchStartX = 0;
      let touchEndX = 0;
      
      document.addEventListener('touchstart', (e) => {
        touchStartX = e.changedTouches[0].screenX;
      });
      
      document.addEventListener('touchend', (e) => {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
      });
      
      function handleSwipe() {
        const swipeThreshold = 50;
        const diff = touchStartX - touchEndX;
        
        // Swipe left to open menu (from right edge)
        if (touchStartX > window.innerWidth - 50 && diff > swipeThreshold && !appHeader.classList.contains('mobile-open')) {
          toggleMobileMenu(true);
        }
        // Swipe right to close menu
        else if (diff < -swipeThreshold && appHeader.classList.contains('mobile-open')) {
          toggleMobileMenu(false);
        }
      }
      
      // Add haptic feedback (if supported)
      if ('vibrate' in navigator) {
        hamburgerBtn.addEventListener('touchstart', () => {
          navigator.vibrate(10);
        });
      }
    }

    // --- CONSTANTS ---
    const KHR_USD_RATE = 4000;
    const CAMBODIA_SALARY_TAX_BRACKETS = [
      { threshold: 1500000, rate: 0.0, deduction: 0 }, { threshold: 2000000, rate: 0.05, deduction: 75000 },
      { threshold: 8500000, rate: 0.1, deduction: 175000 }, { threshold: 12500000, rate: 0.15, deduction: 600000 },
      { threshold: Infinity, rate: 0.2, deduction: 1225000 },
    ];

    // --- TRANSLATIONS ---
    const translations = {
      en: {
        navHome: "Home", navAbout: "About Me",
        heroTitle: "Welcome to Heng Application", heroSubtitle: "Your centralized dashboard for productivity, system tools, and automation.",
        sec_sys: "Systems Supports",
        ss_bizCalc_h3: "Business Calculation", ss_bizCalc_p: "Quickly calculate business numbers.",
        ss_finTools_h3: "Finance Tools", ss_finTools_p: "Interest, Tax & Pricing calculators.",
        ss_sampleEmail_h3: "Sample Email", ss_sampleEmail_p: "Templates for Emails.",

        // NEW OCR KEYS
        ss_hengos_ai_h3: "Text Extraction", ss_hengos_ai_p: "Extract text from images (OCR).",
        "ocr-title": "Text Extraction (OCR)",
        "ocr-subtitle": "Upload an image or Paste (Ctrl+V) to extract text instantly. Supports Khmer, English & Chinese.",
        "ocr-drop-text": "Drop image here, Paste (Ctrl+V), or Click to Upload",
        "btn-extract": "Extract Text",
        "btn-copy": "Copy Text",
        "status-idle": "Ready to process...",
        "status-processing": "Processing...",
        "status-done": "Extraction Complete!",

        // Voice Extraction
        "voice-title": "Voice Extraction",
        "voice-subtitle": "Convert speech to text instantly using AI.",
        "voice-card-title": "Voice Extraction", "voice-card-desc": "Transcribe voice to text.",
        "btn-record": "Start Recording", "btn-stop": "Stop Recording",
        "status-listening": "Listening...", "status-stopped": "Click mic to start",
        "voice-placeholder": "Transcribed text will appear here...",
        "voice-error-browser": "Your browser does not support Speech Recognition.",

        about_hi: "Hello, I'm", about_role_static: "And I am a",
        about_desc: "I am a passionate developer and digital innovator dedicated to creating efficient, user-friendly tools that simplify complex tasks. With expertise in web development, automation, and system design, I build solutions that empower users and streamline workflows. My mission is to bridge the gap between technology and everyday needs through intuitive applications.",
        what_i_do: "What I Do", 
        skill_web: "Web Development", 
        skill_web_desc: "Building responsive, modern websites and web applications using the latest technologies and best practices for optimal user experience.",
        skill_auto: "Automation", 
        skill_auto_desc: "Streamlining workflows and automating repetitive tasks to increase productivity and reduce manual effort.",
        skill_create: "Content Creation", 
        skill_create_desc: "Designing engaging graphics, videos, and multimedia content that captivates audiences and communicates messages effectively.",
        contact_title: "Get In Touch", btn_send: "Send Message",
        footerText: "2025 Heng Application. All Rights Reserved.",
        "back-home": "Back to Home",

        // Business Calc
        "page-title": "Business Suite", "page-subtitle": "Professional calculation tools for Pricing, Subscriptions, and Billing Adjustments.",
        "calc-pricing": "Pricing Calculator", "lbl-orig-price": "Original Price", "kh-orig-price": "ážáŸ’áž›áŸƒážŠáž¾áž˜",
        "lbl-discount": "Discount %", "kh-discount": "áž”áž‰áŸ’áž…áž»áŸ‡áž—áž¶áž‚ážšáž™", "lbl-sale-price": "Sale Price", "kh-sale-price": "ážáž˜áŸ’áž›áŸƒáž›áž€áŸ‹áž…áŸáž‰",
        "res-final": "Final Price", "res-saved": "Discount", "res-diff": "Profit/Loss",
        "calc-sub": "Subscription Calculator", "lbl-start-date": "Start Date", "kh-start-date": "ážáŸ’áž„áŸƒáž…áž¶áž”áŸ‹áž•áŸ’ážáž¾áž˜",
        "lbl-months": "Billing Months", "kh-months": "ážáŸ‚áž”áž“áŸ’áž", "lbl-days": "Days +/-", "kh-days": "ážáŸ’áž„áŸƒáž”áž“áŸ’ážáŸ‚áž˜",
        "lbl-free": "Free Months", "kh-free": "ážáŸ‚áž”áž“áŸ’ážáŸ‚áž˜", "res-expire": "Expires On", "res-duration": "Duration", "res-total-days": "Total Days",
        "calc-invoice": "Invoice Adjustment", "lbl-inv-total": "Total Bill (Incl VAT)", "kh-inv-total": "ážáž˜áŸ’áž›áŸƒážœáž·áž€áŸ’áž€áž™áž”ážáŸ’ážš",
        "lbl-inv-months": "Months", "kh-inv-months": "áž…áŸ†áž“áž½áž“ážáŸ‚", "lbl-sys-price": "System Price (Incl VAT)", "kh-sys-price": "ážáž˜áŸ’áž›áŸƒáž€áŸ’áž“áž»áž„áž”áŸ’ážšáž–áŸáž“áŸ’áž’",
        "res-adj-fee": "Adjustment Fee", "res-new-sys": "Amt (Excl VAT)", "res-vat": "VAT (10%)",
        "calc-billing": "Billing Adjustment", "lbl-m-fee": "Monthly Fee", "kh-m-fee": "ážáŸ’áž›áŸƒáž”áŸ’ážšáž…áž¶áŸ†ážáŸ‚",
        "lbl-days-in": "Days in Month", "kh-days-in": "ážáŸ’áž„áŸƒáž€áŸ’áž“áž»áž„ážáŸ‚", "lbl-method": "Calculate Prorated Charge By",
        "lbl-dates": "Date Range", "lbl-spec-days": "Specific Days", "lbl-rem-fee": "Remaining Fee",
        "res-extra": "Extra Charge", "res-prorated": "Prorated Days", "res-rate": "Daily Rate",

        // Finance Tools
        "fin-title": "Finance & Tax Suite", "fin-subtitle": "Tools for interest, salary tax, and VAT calculations.",
        "sec-interest": "Interest Calculators", "sec-tax": "Cambodia Tax Calculators",
        "lbl-principal": "Principal", "lbl-rate": "Annual Rate (%)", "lbl-time": "Time (Years)", "lbl-compound": "Compound",
        "lbl-gross-sal": "Gross Salary", "lbl-dependents": "Dependents", "lbl-vat-excl": "Amount (Excl. VAT)", "lbl-prop-val": "Property Value",
        "res-interest": "Interest", "res-total": "Total Amount", "res-taxable": "Taxable Sal.", "res-tax-due": "Tax Due",
        "res-vat-amt": "VAT (10%)", "res-total-inc": "Total (Inc. VAT)", "res-transfer-tax": "Transfer Tax (4%)",
        "info-title": "Information & Formulas", "disclaimer": "Disclaimer: For educational purposes only. Consult a tax professional.",
        "val-monthly": "Monthly", "val-quarterly": "Quarterly", "val-yearly": "Annually"
      },
      kh: {
        navHome: "áž‘áŸ†áž–áŸážšážŠáž¾áž˜", navAbout: "áž¢áŸ†áž–áž¸ážáŸ’áž‰áž»áŸ†",
        heroTitle: "ážŸáž¼áž˜ážŸáŸ’ážœáž¶áž‚áž˜áž“áŸáž˜áž€áž€áž¶áž“áŸ‹ Heng Application", heroSubtitle: "áž•áŸ’áž‘áž¶áŸ†áž„áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž•áž›áž·ážáž—áž¶áž–ážšáž”ážŸáŸ‹áž¢áŸ’áž“áž€áŸ”",
        sec_sys: "áž”áŸ’ážšáž–áŸáž“áŸ’áž’áž‡áŸ†áž“áž½áž™",
        ss_bizCalc_h3: "áž€áž¶ážšáž‚ážŽáž“áž¶áž¢áž¶áž‡áž¸ážœáž€áž˜áŸ’áž˜", ss_bizCalc_p: "áž‚ážŽáž“áž¶áž›áŸážáž¢áž¶áž‡áž¸ážœáž€áž˜áŸ’áž˜áŸ”",
        ss_finTools_h3: "áž§áž”áž€ážšážŽáŸáž áž·ážšáž‰áŸ’áž‰ážœážáŸ’ážáž»", ss_finTools_p: "áž€áž¶ážšáž‚ážŽáž“áž¶áž€áž¶ážšáž”áŸ’ážšáž¶áž€áŸ‹ áž“áž·áž„áž–áž“áŸ’áž’áŸ”",
        ss_sampleEmail_h3: "áž‚áŸ†ážšáž¼áž¢áŸŠáž¸áž˜áŸ‚áž›", ss_sampleEmail_p: "áž‚áŸ†ážšáž¼áž“áŸƒáž¢áŸŠáž¸áž˜áŸ‚áž›áŸ”",

        // NEW OCR KEYS
        ss_hengos_ai_h3: "áž‘áž¶áž‰áž™áž€áž¢ážáŸ’ážáž”áž‘", ss_hengos_ai_p: "áž”áŸ†áž”áŸ’áž›áŸ‚áž„ážšáž¼áž”áž—áž¶áž–áž‘áŸ…áž‡áž¶áž¢áž€áŸ’ážŸážš (OCR)áŸ”",
        "ocr-title": "áž‘áž¶áž‰áž™áž€áž¢ážáŸ’ážáž”áž‘ (OCR)",
        "ocr-subtitle": "áž”áž„áŸ’áž áŸ„áŸ‡ážšáž¼áž”áž—áž¶áž– áž¬ Paste (Ctrl+V) ážŠáž¾áž˜áŸ’áž”áž¸áž‘áž¶áž‰áž™áž€áž¢ážáŸ’ážáž”áž‘áŸ” áž‚áž¶áŸ†áž‘áŸ’ážšáž—áž¶ážŸáž¶ážáŸ’áž˜áŸ‚ážš áž¢áž„áŸ‹áž‚áŸ’áž›áŸážŸ áž“áž·áž„áž…áž·áž“áŸ”",
        "ocr-drop-text": "ážŠáž¶áž€áŸ‹ážšáž¼áž”áž—áž¶áž–áž‘áž¸áž“áŸáŸ‡, Paste (Ctrl+V), áž¬ áž…áž»áž…ážŠáž¾áž˜áŸ’áž”áž¸áž”áž„áŸ’áž áŸ„áŸ‡",
        "btn-extract": "áž‘áž¶áž‰áž™áž€áž¢ážáŸ’ážáž”áž‘",
        "btn-copy": "áž…áž˜áŸ’áž›áž„áž¢ážáŸ’ážáž”áž‘",
        "status-idle": "ážšáž„áŸ‹áž…áž¶áŸ†ážŠáŸ†ážŽáž¾ážšáž€áž¶ážš...",
        "status-processing": "áž€áŸ†áž–áž»áž„ážŠáŸ†ážŽáž¾ážšáž€áž¶ážš...",
        "status-done": "ážšáž½áž…ážšáž¶áž›áŸ‹!",

        // Voice Extraction
        "voice-title": "áž‘áž¶áž‰áž™áž€ážŸáŸ†áž¡áŸáž„",
        "voice-subtitle": "áž”áž˜áŸ’áž›áŸ‚áž„áž€áž¶ážšáž“áž·áž™áž¶áž™áž‘áŸ…áž‡áž¶áž¢ážáŸ’ážáž”áž‘áž—áŸ’áž›áž¶áž˜áŸ—ážŠáŸ„áž™áž”áŸ’ážšáž¾ AI áŸ”",
        "voice-card-title": "áž‘áž¶áž‰áž™áž€ážŸáŸ†áž¡áŸáž„", "voice-card-desc": "áž”áž˜áŸ’áž›áŸ‚áž„ážŸáŸ†áž¡áŸáž„áž‘áŸ…áž‡áž¶áž¢ážáŸ’ážáž”áž‘áŸ”",
        "btn-record": "áž…áž¶áž”áŸ‹áž•áŸ’ážáž¾áž˜ážáž", "btn-stop": "áž”áž‰áŸ’ážˆáž”áŸ‹áž€áž¶ážšážáž",
        "status-listening": "áž€áŸ†áž–áž»áž„ážŸáŸ’ážáž¶áž”áŸ‹...", "status-stopped": "áž…áž»áž…áž˜áž¸áž€áŸ’ážšáž¼áž áŸ’ážœáž¼áž“ážŠáž¾áž˜áŸ’áž”áž¸áž…áž¶áž”áŸ‹áž•áŸ’ážáž¾áž˜",
        "voice-placeholder": "áž¢ážáŸ’ážáž”áž‘ážŠáŸ‚áž›áž”áž¶áž“áž”áž˜áŸ’áž›áŸ‚áž„áž“áž¹áž„áž”áž„áŸ’áž áž¶áž‰áž“áŸ…áž‘áž¸áž“áŸáŸ‡...",
        "voice-error-browser": "áž€áž˜áŸ’áž˜ážœáž·áž’áž¸ážšáž»áž€ážšáž€ážšáž”ážŸáŸ‹áž¢áŸ’áž“áž€áž˜áž·áž“áž‚áž¶áŸ†áž‘áŸ’ážšáž€áž¶ážšáž…áž¶áž”áŸ‹áž™áž€ážŸáŸ†áž¡áŸáž„áž‘áŸáŸ”",

        about_hi: "ážŸáž½ážŸáŸ’ážáž¸, ážáŸ’áž‰áž»áŸ†ážˆáŸ’áž˜áŸ„áŸ‡", about_role_static: "áž áž¾áž™ážáŸ’áž‰áž»áŸ†áž‚ážºáž‡áž¶", 
        about_desc: "ážáŸ’áž‰áž»áŸ†áž‡áž¶áž¢áŸ’áž“áž€áž¢áž—áž·ážœážŒáŸ’ážáž“áŸ áž“áž·áž„áž¢áŸ’áž“áž€áž…áŸ’áž“áŸƒáž”áŸ’ážšážŒáž·ážážŒáž¸áž‡áž¸ážáž›ážŠáŸ‚áž›áž˜áž¶áž“áž…áž·ážáŸ’ážážŸáŸ’ážšáž¡áž¶áž‰áŸ‹áž€áŸ’áž“áž»áž„áž€áž¶ážšáž”áž„áŸ’áž€áž¾ážáž§áž”áž€ážšážŽáŸáž”áŸ’ážšáž€áž”ážŠáŸ„áž™áž”áŸ’ážšážŸáž·áž‘áŸ’áž’áž—áž¶áž– áž“áž·áž„áž„áž¶áž™ážŸáŸ’ážšáž½áž›áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹áŸ” áž‡áž¶áž˜áž½áž™áž“áž¹áž„áž‡áŸ†áž“áž¶áž‰áž€áŸ’áž“áž»áž„áž€áž¶ážšáž¢áž—áž·ážœážŒáŸ’ážáž“áŸáž‚áŸáž áž‘áŸ†áž–áŸážš áž”áŸ’ážšáž–áŸáž“áŸ’áž’ážŸáŸ’ážœáŸáž™áž”áŸ’ážšážœážáŸ’ážáž·áž€áž˜áŸ’áž˜ áž“áž·áž„áž€áž¶ážšážšáž…áž“áž¶áž”áŸ’ážšáž–áŸáž“áŸ’áž’ ážáŸ’áž‰áž»áŸ†áž”áž„áŸ’áž€áž¾ážážŠáŸ†ážŽáŸ„áŸ‡ážŸáŸ’ážšáž¶áž™ážŠáŸ‚áž›áž•áŸ’ážáž›áŸ‹áž¢áŸ†ážŽáž¶áž…ážŠáž›áŸ‹áž¢áŸ’áž“áž€áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹ áž“áž·áž„ážŸáž˜áŸ’ážšáž½áž›áž›áŸ†áž áž¼ážšáž€áž¶ážšáž„áž¶ážšáŸ”",
        what_i_do: "áž¢áŸ’ážœáž¸ážŠáŸ‚áž›ážáŸ’áž‰áž»áŸ†áž’áŸ’ážœáž¾", 
        skill_web: "áž€áž¶ážšáž¢áž—áž·ážœážŒáŸ’ážáž“áŸáž‚áŸáž áž‘áŸ†áž–áŸážš", 
        skill_web_desc: "áž”áž„áŸ’áž€áž¾ážáž‚áŸáž áž‘áŸ†áž–áŸážšáž‘áŸ†áž“áž¾áž” áž“áž·áž„áž€áž˜áŸ’áž˜ážœáž·áž’áž¸áž‚áŸáž áž‘áŸ†áž–áŸážšážŠáŸ„áž™áž”áŸ’ážšáž¾áž”áž…áŸ’áž…áŸáž€ážœáž·áž‘áŸ’áž™áž¶ážáŸ’áž˜áž¸áŸ— áž“áž·áž„áž€áž¶ážšáž¢áž“áž»ážœážáŸ’ážáž›áŸ’áž¢áž”áŸ†áž•áž»ážážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž”áž‘áž–áž·ážŸáŸ„áž’áž“áŸáž¢áŸ’áž“áž€áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹ážŠáŸáž›áŸ’áž¢áŸ”",
        skill_auto: "áž”áŸ’ážšáž–áŸáž“áŸ’áž’ážŸáŸ’ážœáŸáž™áž”áŸ’ážšážœážáŸ’ážáž·áž€áž˜áŸ’áž˜", 
        skill_auto_desc: "ážŸáž˜áŸ’ážšáž½áž›áž›áŸ†áž áž¼ážšáž€áž¶ážšáž„áž¶ážš áž“áž·áž„áž’áŸ’ážœáž¾ážŸáŸ’ážœáŸáž™áž”áŸ’ážšážœážáŸ’ážáž·áž€áž˜áŸ’áž˜áž—áž¶ážšáž€áž·áž…áŸ’áž…ážŠážŠáŸ‚áž›áŸ— ážŠáž¾áž˜áŸ’áž”áž¸áž”áž„áŸ’áž€áž¾áž“áž•áž›áž·ážáž—áž¶áž– áž“áž·áž„áž€áž¶ážáŸ‹áž”áž“áŸ’ážáž™áž€áž¶ážšáž„áž¶ážšážŠáŸ„áž™ážŠáŸƒáŸ”",
        skill_create: "áž€áž¶ážšáž”áž„áŸ’áž€áž¾ážáž˜áž¶ážáž·áž€áž¶", 
        skill_create_desc: "ážšáž…áž“áž¶áž€áŸ’ážšáž¶áž áŸ’ážœáž·áž€ ážœáž¸ážŠáŸáž¢áž¼ áž“áž·áž„áž˜áž¶ážáž·áž€áž¶áž–áž áž»áž˜áŸážŒáŸ€ážŠáŸ‚áž›áž‘áž¶áž€áŸ‹áž‘áž¶áž‰ áž“áž·áž„áž”áž„áŸ’áž áž¶áž‰ážŸáž¶ážšáž”áŸ’ážšáž€áž”ážŠáŸ„áž™áž”áŸ’ážšážŸáž·áž‘áŸ’áž’áž—áž¶áž–áŸ”",
        contact_title: "áž‘áž¶áž€áŸ‹áž‘áž„áž˜áž€ážáŸ’áž‰áž»áŸ†", btn_send: "áž•áŸ’áž‰áž¾ážŸáž¶ážš", footerText: "ážšáž€áŸ’ážŸáž¶ážŸáž·áž‘áŸ’áž’áž·áž‚áŸ’ážšáž”áŸ‹áž™áŸ‰áž¶áž„ áŸ¢áŸ áŸ¢áŸ¥ @HengApplication.",
        "back-home": "ážáŸ’ážšáž¡áž”áŸ‹áž‘áŸ…áž‘áŸ†áž–áŸážšážŠáž¾áž˜",

        "page-title": "áž§áž”áž€ážšážŽáŸáž¢áž¶áž‡áž¸ážœáž€áž˜áŸ’áž˜", "page-subtitle": "áž§áž”áž€ážšážŽáŸážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž‚ážŽáž“áž¶ážáž˜áŸ’áž›áŸƒ áž€áž¶ážšáž‡áž¶ážœ áž“áž·áž„ážœáž·áž€áŸ’áž€áž™áž”ážáŸ’ážšáŸ”",
        "calc-pricing": "áž‚ážŽáž“áž¶ážáž˜áŸ’áž›áŸƒáž›áž€áŸ‹", "lbl-orig-price": "ážáŸ’áž›áŸƒážŠáž¾áž˜", "kh-orig-price": "",
        "lbl-discount": "áž”áž‰áŸ’áž…áž»áŸ‡áž—áž¶áž‚ážšáž™", "kh-discount": "", "lbl-sale-price": "ážáž˜áŸ’áž›áŸƒáž›áž€áŸ‹áž…áŸáž‰", "kh-sale-price": "",
        "res-final": "ážáž˜áŸ’áž›áŸƒáž…áž»áž„áž€áŸ’ážšáŸ„áž™", "res-saved": "áž”áž‰áŸ’áž…áž»áŸ‡ážáž˜áŸ’áž›áŸƒ", "res-diff": "áž…áŸ†ážŽáŸáž‰/ážáž¶áž",
        "calc-sub": "áž‚ážŽáž“áž¶áž€áž¶ážšáž‡áž¶ážœ", "lbl-start-date": "ážáŸ’áž„áŸƒáž…áž¶áž”áŸ‹áž•áŸ’ážáž¾áž˜", "kh-start-date": "",
        "lbl-months": "ážáŸ‚áž”áž„áŸ‹áž”áŸ’ážšáž¶áž€áŸ‹", "kh-months": "", "lbl-days": "ážáŸ’áž„áŸƒáž”áž“áŸ’ážáŸ‚áž˜/áž”áž“áŸ’ážáž™", "kh-days": "",
        "lbl-free": "ážáŸ‚áž¥ážáž‚áž·ážážáŸ’áž›áŸƒ", "kh-free": "", "res-expire": "áž•áž»ážáž€áŸ†ážŽážáŸ‹áž“áŸ…", "res-duration": "ážšáž™áŸˆáž–áŸáž›", "res-total-days": "ážáŸ’áž„áŸƒážŸážšáž»áž”",
        "calc-invoice": "áž€áŸ‚ážáž˜áŸ’ážšáž¼ážœážœáž·áž€áŸ’áž€áž™áž”ážáŸ’ážš", "lbl-inv-total": "ážáž˜áŸ’áž›áŸƒážŸážšáž»áž” (ážšáž½áž˜áž¢áž¶áž€ážš)", "kh-inv-total": "",
        "lbl-inv-months": "áž…áŸ†áž“áž½áž“ážáŸ‚", "kh-inv-months": "", "lbl-sys-price": "ážáž˜áŸ’áž›áŸƒáž€áŸ’áž“áž»áž„áž”áŸ’ážšáž–áŸáž“áŸ’áž’ (ážšáž½áž˜áž¢áž¶áž€ážš)", "kh-sys-price": "",
        "res-adj-fee": "ážáŸ’áž›áŸƒáž€áŸ‚ážáž˜áŸ’ážšáž¼ážœ", "res-new-sys": "áž‘áž¹áž€áž”áŸ’ážšáž¶áž€áŸ‹ (áž˜áž·áž“ážšáž½áž˜áž¢áž¶áž€ážš)", "res-vat": "áž¢áž¶áž€ážš (áŸ¡áŸ %)",
        "calc-billing": "áž€áŸ‚ážáž˜áŸ’ážšáž¼ážœáž€áž¶ážšáž”áž„áŸ‹áž”áŸ’ážšáž¶áž€áŸ‹", "lbl-m-fee": "ážáŸ’áž›áŸƒáž”áŸ’ážšáž…áž¶áŸ†ážáŸ‚", "kh-m-fee": "",
        "lbl-days-in": "ážáŸ’áž„áŸƒáž€áŸ’áž“áž»áž„ážáŸ‚", "kh-days-in": "", "lbl-method": "áž‚ážŽáž“áž¶ážŠáŸ„áž™",
        "lbl-dates": "áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘", "lbl-spec-days": "áž…áŸ†áž“áž½áž“ážáŸ’áž„áŸƒ", "lbl-rem-fee": "ážáŸ’áž›áŸƒáž“áŸ…ážŸáž›áŸ‹",
        "res-extra": "ážáŸ’áž›áŸƒáž”áž“áŸ’ážáŸ‚áž˜", "res-prorated": "áž…áŸ†áž“áž½áž“ážáŸ’áž„áŸƒ", "res-rate": "ážáž˜áŸ’áž›áŸƒáž€áŸ’áž“áž»áž„áž˜áž½áž™ážáŸ’áž„áŸƒ",

        // Finance Tools KH
        "fin-title": "áž áž·ážšáž‰áŸ’áž‰ážœážáŸ’ážáž» & áž–áž“áŸ’áž’ážŠáž¶ážš", "fin-subtitle": "áž§áž”áž€ážšážŽáŸážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž‚ážŽáž“áž¶áž€áž¶ážšáž”áŸ’ážšáž¶áž€áŸ‹, áž–áž“áŸ’áž’áž›áž¾áž”áŸ’ážšáž¶áž€áŸ‹áž”áŸ€ážœážáŸ’ážŸ, áž“áž·áž„ áž¢áž¶áž€ážšáŸ”",
        "sec-interest": "áž€áž¶ážšáž‚ážŽáž“áž¶áž€áž¶ážšáž”áŸ’ážšáž¶áž€áŸ‹", "sec-tax": "áž€áž¶ážšáž‚ážŽáž“áž¶áž–áž“áŸ’áž’ (áž€áž˜áŸ’áž–áž»áž‡áž¶)",
        "lbl-principal": "áž”áŸ’ážšáž¶áž€áŸ‹ážŠáž¾áž˜", "lbl-rate": "áž¢ážáŸ’ážšáž¶áž€áž¶ážšáž”áŸ’ážšáž¶áž€áŸ‹ (%)", "lbl-time": "ážšáž™áŸˆáž–áŸáž› (áž†áŸ’áž“áž¶áŸ†)", "lbl-compound": "áž€áž¶ážšáž”áŸ’ážšáž¶áž€áŸ‹áž•áŸ’ážŸáŸ†",
        "lbl-gross-sal": "áž”áŸ’ážšáž¶áž€áŸ‹ážáŸ‚ážŸážšáž»áž”", "lbl-dependents": "áž…áŸ†áž“áž½áž“áž¢áŸ’áž“áž€áž€áŸ’áž“áž»áž„áž”áž“áŸ’áž‘áž»áž€", "lbl-vat-excl": "ážáž˜áŸ’áž›áŸƒáž˜áž·áž“ážšáž½áž˜áž¢áž¶áž€ážš", "lbl-prop-val": "ážáž˜áŸ’áž›áŸƒáž¢áž…áž›áž“áž‘áŸ’ážšáž–áŸ’áž™",
        "res-interest": "áž€áž¶ážšáž”áŸ’ážšáž¶áž€áŸ‹", "res-total": "ážŸážšáž»áž”", "res-taxable": "áž”áŸ’ážšáž¶áž€áŸ‹áž‡áž¶áž”áŸ‹áž–áž“áŸ’áž’", "res-tax-due": "áž–áž“áŸ’áž’ážáŸ’ážšáž¼ážœáž”áž„áŸ‹",
        "res-vat-amt": "áž¢áž¶áž€ážš (áŸ¡áŸ %)", "res-total-inc": "ážŸážšáž»áž” (ážšáž½áž˜áž¢áž¶áž€ážš)", "res-transfer-tax": "áž–áž“áŸ’áž’áž”áŸ’ážšážáž¶áž”áŸ‹ážáŸ’ážšáž¶ (áŸ¤%)",
        "info-title": "áž–áŸážáŸŒáž˜áž¶áž“ & ážšáž¼áž”áž˜áž“áŸ’áž", "disclaimer": "áž€áž¶ážšáž”ážŠáž·ážŸáŸáž’áŸ– ážŸáž˜áŸ’ážšáž¶áž”áŸ‹ážáŸ‚áž‚áŸ„áž›áž”áŸ†ážŽáž„áž¢áž”áŸ‹ážšáŸ†áž”áŸ‰áž»ážŽáŸ’ážŽáŸ„áŸ‡áŸ” ážŸáž¼áž˜áž–áž·áž‚áŸ’ážšáŸ„áŸ‡áž‡áž¶áž˜áž½áž™áž¢áŸ’áž“áž€áž‡áŸ†áž“áž¶áž‰áž–áž“áŸ’áž’ážŠáž¶ážšáŸ”",
        "val-monthly": "áž”áŸ’ážšáž…áž¶áŸ†ážáŸ‚", "val-quarterly": "áž”áŸ’ážšáž…áž¶áŸ†ážáŸ’ážšáž¸áž˜áž¶ážŸ", "val-yearly": "áž”áŸ’ážšáž…áž¶áŸ†áž†áŸ’áž“áž¶áŸ†"
      }
    };

    const quotes = [
      { text: "Simplicity is the soul of efficiency.", author: "Austin Freeman" },
      { text: "Code is like humor. When you have to explain it, itâ€™s bad.", author: "Cory House" },
      { text: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
      { text: "Automation applied to an efficient operation will magnify the efficiency.", author: "Bill Gates" }
    ];

    // --- HTML TEMPLATES ---

    const homePageHTML = `
        <section class="hero-section">
            <div class="hero-bg-circle c1"></div><div class="hero-bg-circle c2"></div><div class="hero-bg-circle c3"></div>
            <div class="hero-content">
                <h1 data-translate-key="heroTitle">Welcome to Heng Application</h1>
                <p class="subtitle" data-translate-key="heroSubtitle">Your centralized dashboard for productivity...</p>
                <div class="quote-container"><p class="quote-text" id="quote-text"></p><span class="quote-author" id="quote-author"></span></div>
            </div>
        </section>
        <section class="system-supports">
            <h2 class="section-title" data-translate-key="sec_sys">Systems Supports</h2>
            <div id="link-grid">
                <a href="#business-calc" class="link-item">
                    <div class="link-icon custom-icon business-icon">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <div class="link-content"><h3 data-translate-key="ss_bizCalc_h3">Business Calculation</h3><p data-translate-key="ss_bizCalc_p">Quickly calculate business numbers.</p></div>
                    <div class="link-arrow"><i class="fas fa-arrow-right"></i></div>
                </a>
                <a href="#finance-tools" class="link-item">
                    <div class="link-icon custom-icon finance-icon">
                        <i class="fas fa-coins"></i>
                    </div>
                    <div class="link-content"><h3 data-translate-key="ss_finTools_h3">Finance Tools</h3><p data-translate-key="ss_finTools_p">Interest, Tax & Pricing.</p></div>
                    <div class="link-arrow"><i class="fas fa-arrow-right"></i></div>
                </a>
                <a href="EmailTemplate.html" class="link-item">
                    <div class="link-icon custom-icon email-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <div class="link-content"><h3 data-translate-key="ss_sampleEmail_h3">Sample Email</h3><p data-translate-key="ss_sampleEmail_p">Templates for Emails.</p></div>
                    <div class="link-arrow"><i class="fas fa-arrow-right"></i></div>
                </a>
                <a href="#text-extraction" class="link-item">
                    <div class="link-icon custom-icon ocr-icon">
                        <i class="fas fa-image"></i>
                    </div>
                    <div class="link-content"><h3 data-translate-key="ss_hengos_ai_h3">Text Extraction</h3><p data-translate-key="ss_hengos_ai_p">Extract text from images.</p></div>
                    <div class="link-arrow"><i class="fas fa-arrow-right"></i></div>
                </a>
                <a href="#voice-extraction" class="link-item">
                    <div class="link-icon custom-icon voice-icon">
                        <i class="fas fa-microphone-alt"></i>
                    </div>
                    <div class="link-content"><h3 data-translate-key="voice-card-title">Voice Extraction</h3><p data-translate-key="voice-card-desc">Transcribe voice to text.</p></div>
                    <div class="link-arrow"><i class="fas fa-arrow-right"></i></div>
                </a>
            </div>
        </section>
    `;

    const aboutPageHTML = `
        <div class="about-container">
            <div class="about-intro">
                <div class="about-text">
                    <h3 data-translate-key="about_hi" style="font-size:1.5rem; color:var(--text-color);">Hello, I'm</h3>
                    <h2><span class="highlight">Heng Application</span></h2>
                    <span class="role"><span data-translate-key="about_role_static">And I am a</span> <span class="typing" style="color:var(--primary-color); font-weight:700;"></span></span>
                    <p class="bio-text" data-translate-key="about_desc">I am a passionate developer and digital innovator dedicated to creating efficient, user-friendly tools that simplify complex tasks. With expertise in web development, automation, and system design, I build solutions that empower users and streamline workflows. My mission is to bridge the gap between technology and everyday needs through intuitive applications.</p>
                    <div class="social-links">
                        <a href="https://www.facebook.com/sing.rithano.96" target="_blank" rel="noopener noreferrer" class="social-btn" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://www.instagram.com/ly_henggg/" target="_blank" rel="noopener noreferrer" class="social-btn" title="Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="https://t.me/LyHengg" target="_blank" rel="noopener noreferrer" class="social-btn" title="Telegram"><i class="fab fa-telegram-plane"></i></a>
                        <a href="https://www.linkedin.com/in/ly-heng-54a474220/" target="_blank" rel="noopener noreferrer" class="social-btn" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://github.com/BitoSing" target="_blank" rel="noopener noreferrer" class="social-btn" title="GitHub"><i class="fab fa-github"></i></a>
                        <a href="https://twitter.com/LYHENG096" target="_blank" rel="noopener noreferrer" class="social-btn" title="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="mailto:Singlovesmiles@gmail.com" class="social-btn" title="Email"><i class="fas fa-envelope"></i></a>
                    </div>
                </div>
                <div class="about-img-wrapper"><img src="Img/Pro1.JPG" alt="Heng Application - Professional profile photo" class="about-img"></div>
            </div>

            <h2 class="section-title" data-translate-key="what_i_do">What I Do</h2>
            <div class="services-grid">
                <div class="service-card">
                    <div class="service-icon"><i class="fas fa-code"></i></div>
                    <h3 data-translate-key="skill_web">Web Development</h3>
                    <p data-translate-key="skill_web_desc">Building responsive, modern websites and web applications using the latest technologies and best practices for optimal user experience.</p>
                </div>
                <div class="service-card">
                    <div class="service-icon"><i class="fas fa-robot"></i></div>
                    <h3 data-translate-key="skill_auto">Automation</h3>
                    <p data-translate-key="skill_auto_desc">Streamlining workflows and automating repetitive tasks to increase productivity and reduce manual effort.</p>
                </div>
                <div class="service-card">
                    <div class="service-icon"><i class="fas fa-pen-nib"></i></div>
                    <h3 data-translate-key="skill_create">Content Creation</h3>
                    <p data-translate-key="skill_create_desc">Designing engaging graphics, videos, and multimedia content that captivates audiences and communicates messages effectively.</p>
                </div>
                <div class="service-card">
                    <div class="service-icon"><i class="fas fa-mobile-alt"></i></div>
                    <h3>UI/UX Design</h3>
                    <p>Creating intuitive and beautiful user interfaces that provide seamless experiences across all devices and platforms.</p>
                </div>
                <div class="service-card">
                    <div class="service-icon"><i class="fas fa-database"></i></div>
                    <h3>System Integration</h3>
                    <p>Connecting different systems and services to work together harmoniously, enabling efficient data flow and operations.</p>
                </div>
                <div class="service-card">
                    <div class="service-icon"><i class="fas fa-chart-line"></i></div>
                    <h3>Business Solutions</h3>
                    <p>Developing custom tools and calculators that solve real business problems and support data-driven decision making.</p>
                </div>
            </div>

            <div class="split-section">
                <div class="col-left">
                    <h2 class="section-title">Technical Skills</h2>
                    <div class="skill-bar">
                        <div class="skill-info">
                            <span class="skill-name"><i class="fab fa-html5 skill-icon"></i> HTML/CSS/JS</span>
                            <span>95%</span>
                        </div>
                        <div class="progress-bg"><div class="progress-fill" style="width:95%"></div></div>
                    </div>
                    <div class="skill-bar">
                        <div class="skill-info">
                            <span class="skill-name"><i class="fab fa-python skill-icon"></i> Python/Automation</span>
                            <span>90%</span>
                        </div>
                        <div class="progress-bg"><div class="progress-fill" style="width:90%"></div></div>
                    </div>
                    <div class="skill-bar">
                        <div class="skill-info">
                            <span class="skill-name"><i class="fab fa-react skill-icon"></i> React/Vue.js</span>
                            <span>85%</span>
                        </div>
                        <div class="progress-bg"><div class="progress-fill" style="width:85%"></div></div>
                    </div>
                    <div class="skill-bar">
                        <div class="skill-info">
                            <span class="skill-name"><i class="fab fa-node-js skill-icon"></i> Node.js/Backend</span>
                            <span>80%</span>
                        </div>
                        <div class="progress-bg"><div class="progress-fill" style="width:80%"></div></div>
                    </div>
                    <div class="skill-bar">
                        <div class="skill-info">
                            <span class="skill-name"><i class="fas fa-database skill-icon"></i> Database/SQL</span>
                            <span>85%</span>
                        </div>
                        <div class="progress-bg"><div class="progress-fill" style="width:85%"></div></div>
                    </div>
                    <div class="skill-bar">
                        <div class="skill-info">
                            <span class="skill-name"><i class="fas fa-paint-brush skill-icon"></i> UI/UX Design</span>
                            <span>88%</span>
                        </div>
                        <div class="progress-bg"><div class="progress-fill" style="width:88%"></div></div>
                    </div>
                </div>
                <div class="col-right">
                    <h2 class="section-title">Work Experience</h2>
                    <div class="timeline">
                        <div class="timeline-item">
                            <span class="timeline-date">Jul 2025 - Oct 2025</span>
                            <div class="timeline-content">
                                <h4>Acting Manager, Customer Relationships</h4>
                                <p style="font-weight: 600; color: var(--text-color); margin-bottom: 0.5rem;">EZECOM Co., LTD & CAMGSM Co., LTD</p>
                                <p>Managed the complete customer lifecycle for EZECOM (FTTH Consumer) and Cellcard bases. Achieved and maintained a 95% Revenue Renewal Rate through targeted initiatives. Prevented subscriber churn through strategic retention efforts and streamlined processes across renewal, retention, and collection teams.</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <span class="timeline-date">Jun 2024 - Jul 2025</span>
                            <div class="timeline-content">
                                <h4>Team Leader, Retention and Collection</h4>
                                <p style="font-weight: 600; color: var(--text-color); margin-bottom: 0.5rem;">EZECOM Co., LTD</p>
                                <p>Spearheaded the Collections and Retention Team, overseeing all operational activities. Drove a high-performance culture by actively mentoring and coaching team specialists. Strategically managed KPIs to maintain accountability and ensure the team hit the 95% revenue renewal target.</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <span class="timeline-date">Dec 2022 - Jun 2024</span>
                            <div class="timeline-content">
                                <h4>Enterprise, Retention and Collection Officer</h4>
                                <p style="font-weight: 600; color: var(--text-color); margin-bottom: 0.5rem;">EZECOM Co., LTD</p>
                                <p>Secured high-value enterprise accounts by managing and enhancing strategic partnerships. Successfully transitioned into the Collections Team while serving as Enterprise Retention Officer. Proactively developed and presented customized deals and retention packages to enterprise clients.</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <span class="timeline-date">May 2022 - Nov 2022</span>
                            <div class="timeline-content">
                                <h4>ATM/CIM Officer</h4>
                                <p style="font-weight: 600; color: var(--text-color); margin-bottom: 0.5rem;">ABA Bank at Independent Monument Branch</p>
                                <p>Managed end-to-end cash flow reconciliation for all ATM and CIM operations. Ensured operational efficiency by overseeing the functionality of all self-service machines. Provided crucial linguistic support to the teller team by offering on-demand Chinese translation.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="split-section" style="margin-top: 3rem;">
                <div class="col-left">
                    <h2 class="section-title">Core Values</h2>
                    <div class="service-card" style="text-align: left; margin-bottom: 1.5rem;">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                            <i class="fas fa-lightbulb" style="font-size: 2rem; color: var(--primary-color);"></i>
                            <h3 style="margin: 0;">Innovation</h3>
                        </div>
                        <p>Constantly exploring new technologies and approaches to solve problems in creative ways.</p>
                    </div>
                    <div class="service-card" style="text-align: left; margin-bottom: 1.5rem;">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                            <i class="fas fa-users" style="font-size: 2rem; color: var(--primary-color);"></i>
                            <h3 style="margin: 0;">User-Centric</h3>
                        </div>
                        <p>Designing with the end-user in mind, ensuring intuitive and accessible experiences for everyone.</p>
                    </div>
                    <div class="service-card" style="text-align: left;">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                            <i class="fas fa-award" style="font-size: 2rem; color: var(--primary-color);"></i>
                            <h3 style="margin: 0;">Excellence</h3>
                        </div>
                        <p>Committed to delivering high-quality work that exceeds expectations and stands the test of time.</p>
                    </div>
                </div>
                <div class="col-right">
                    <h2 class="section-title" data-translate-key="contact_title">Get In Touch</h2>
                    <p style="color: var(--text-muted); margin-bottom: 1.5rem; line-height: 1.6;">Have a project in mind or want to collaborate? Feel free to reach out! I'm always open to discussing new opportunities and ideas.</p>
                    <form class="contact-form">
                        <div class="form-group"><input type="text" placeholder="Your Name" required></div>
                        <div class="form-group"><input type="email" placeholder="Your Email" required></div>
                        <div class="form-group"><textarea placeholder="Your Message..." required></textarea></div>
                        <button type="submit" class="btn-primary" data-translate-key="btn_send">Send Message</button>
                    </form>
                </div>
            </div>
        </div>
    `;

    const businessCalcHTML = `
        <div class="back-btn-wrapper"><a href="#resources" class="back-btn"><i class="fas fa-arrow-left"></i><span data-translate-key="back-home">Back to Home</span></a></div>
        <div class="calc-header"><h1 class="calc-header-title" data-translate-key="page-title">Business Suite</h1><p class="calc-header-subtitle" data-translate-key="page-subtitle">Tools for Pricing, Subscriptions, and Billing.</p></div>
        <div class="calculator-grid" id="calc-grid">
          <!-- Pricing -->
          <div class="calc-card" data-type="pricing">
            <div class="card-header"><div class="header-left"><div class="card-icon"><i class="fas fa-tag"></i></div><h2 class="card-title" data-translate-key="calc-pricing">Pricing</h2></div><button class="reset-btn"><i class="fas fa-sync-alt"></i></button></div>
            <div class="input-group"><div class="field-wrapper"><label><span data-translate-key="lbl-orig-price">Original</span></label><input type="text" id="p-orig" placeholder="$1,000.00" data-format="currency"></div>
              <div class="input-row"><div class="field-wrapper"><label><span data-translate-key="lbl-discount">Discount %</span></label><input type="text" id="p-disc" placeholder="15.5" data-format="number"></div><div class="field-wrapper"><label><span data-translate-key="lbl-sale-price">Sale Price</span></label><input type="text" id="p-sale" placeholder="850.75" data-format="currency"></div></div></div>
            <div class="output-area"><div class="main-result"><span class="result-label" data-translate-key="res-final">Final</span><span class="result-value" id="res-p-final">$0.00</span></div><div class="sub-results"><div class="sub-item"><span class="result-label" data-translate-key="res-saved">Saved</span><span class="sub-val" id="res-p-saved">0%</span></div><div class="sub-item"><span class="result-label" data-translate-key="res-diff">P/L</span><span class="sub-val" id="res-p-diff">$0.00</span></div></div></div>
          </div>
          <!-- Subscription -->
          <div class="calc-card" data-type="sub">
            <div class="card-header"><div class="header-left"><div class="card-icon"><i class="fas fa-calendar-alt"></i></div><h2 class="card-title" data-translate-key="calc-sub">Sub</h2></div><button class="reset-btn"><i class="fas fa-sync-alt"></i></button></div>
            <div class="input-group"><div class="input-row"><div class="field-wrapper"><label><span data-translate-key="lbl-start-date">Start</span></label><input type="text" id="s-start" class="date-input" placeholder="Date"></div><div class="field-wrapper"><label><span data-translate-key="lbl-months">Months</span></label><input type="text" id="s-months" placeholder="12" data-format="int"></div></div>
            <div class="input-row"><div class="field-wrapper"><label><span data-translate-key="lbl-days">Days +/-</span></label><input type="text" id="s-days" placeholder="5" data-format="int"></div><div class="field-wrapper"><label><span data-translate-key="lbl-free">Free</span></label><input type="text" id="s-free" placeholder="1" data-format="int"></div></div></div>
            <div class="output-area"><div class="main-result"><span class="result-label" data-translate-key="res-expire">Expires</span><span class="result-value" id="res-s-end">---</span></div><div class="sub-results"><div class="sub-item"><span class="result-label" data-translate-key="res-duration">Duration</span><span class="sub-val" id="res-s-dur">0 M</span></div><div class="sub-item"><span class="result-label" data-translate-key="res-total-days">Days</span><span class="sub-val" id="res-s-total">0</span></div></div></div>
          </div>
          <!-- Invoice -->
          <div class="calc-card" data-type="invoice">
            <div class="card-header"><div class="header-left"><div class="card-icon"><i class="fas fa-file-invoice-dollar"></i></div><h2 class="card-title" data-translate-key="calc-invoice">Invoice</h2></div><button class="reset-btn"><i class="fas fa-sync-alt"></i></button></div>
            <div class="input-group"><div class="input-row"><div class="field-wrapper"><label><span data-translate-key="lbl-inv-total">Total</span></label><input type="text" id="i-total" placeholder="$216.50" data-format="currency"><span class="helper-note" id="i-note"></span></div><div class="field-wrapper"><label><span data-translate-key="lbl-inv-months">Months</span></label><input type="text" id="i-months" placeholder="12" data-format="int"></div></div><div class="field-wrapper"><label><span data-translate-key="lbl-sys-price">System Price</span></label><input type="text" id="i-sys" placeholder="$1,100.00" data-format="currency"></div></div>
            <div class="output-area"><div class="main-result"><span class="result-label" data-translate-key="res-adj-fee">Adj Fee</span><span class="result-value" id="res-i-fee">$0.00</span></div><div class="sub-results"><div class="sub-item"><span class="result-label" data-translate-key="res-new-sys">Excl VAT</span><span class="sub-val" id="res-i-sys">$0.00</span></div><div class="sub-item"><span class="result-label" data-translate-key="res-vat">VAT</span><span class="sub-val" id="res-i-vat">$0.00</span></div></div></div>
          </div>
          <!-- Billing -->
          <div class="calc-card" data-type="billing">
            <div class="card-header"><div class="header-left"><div class="card-icon"><i class="fas fa-calculator"></i></div><h2 class="card-title" data-translate-key="calc-billing">Billing</h2></div><button class="reset-btn"><i class="fas fa-sync-alt"></i></button></div>
            <div class="input-group">
              <div class="input-row"><div class="field-wrapper"><label><span data-translate-key="lbl-m-fee">Fee</span></label><input type="text" id="b-fee" placeholder="100.00" data-format="currency"></div><div class="field-wrapper"><label><span data-translate-key="lbl-days-in">Days/Mo</span></label><select id="b-dim"><option value="30" data-translate-key="days-30">30 Days</option><option value="31" data-translate-key="days-31">31 Days</option><option value="29" data-translate-key="days-29">29 Days</option><option value="28" data-translate-key="days-28">28 Days</option></select></div></div>
              <div class="input-sub-heading" data-translate-key="lbl-method" style="font-size: 0.75rem; color: var(--text-muted); text-align: center; margin: 0.6rem 0; border-bottom: 1px solid var(--border-color); padding-bottom: 0.3rem;">Calculate Prorated Charge By</div>
              <div class="input-row"><div class="field-wrapper"><label data-translate-key="lbl-dates">Dates</label><input type="text" id="b-start" class="date-input billing-by" placeholder="Start"></div><div class="field-wrapper"><label>&nbsp;</label><input type="text" id="b-end" class="date-input billing-by" placeholder="End"></div></div>
              <div class="input-row"><div class="field-wrapper"><label data-translate-key="lbl-spec-days">Specific Days</label><input type="text" id="b-days-spec" class="billing-by" placeholder="Overrides dates" data-format="int"></div><div class="field-wrapper"><label data-translate-key="lbl-rem-fee">Remaining Fee</label><input type="text" id="b-rem-fee" class="billing-by" placeholder="Calculates days" data-format="currency"></div></div>
            </div>
            <div class="output-area"><div class="main-result"><span class="result-label" data-translate-key="res-extra">Extra</span><span class="result-value" id="res-b-extra">$0.00</span></div><div class="sub-results"><div class="sub-item"><span class="result-label" data-translate-key="res-prorated">Days</span><span class="sub-val" id="res-b-days">0</span></div><div class="sub-item"><span class="result-label" data-translate-key="res-rate">Rate/Day</span><span class="sub-val" id="res-b-rate">$0.00</span></div></div></div>
          </div>
        </div>
    `;

    const financeCalcHTML = `
        <div class="back-btn-wrapper"><a href="#resources" class="back-btn"><i class="fas fa-arrow-left"></i><span data-translate-key="back-home">Back to Home</span></a></div>
        <div class="calc-header"><h1 class="calc-header-title" data-translate-key="fin-title">Finance Hub</h1><p class="calc-header-subtitle" data-translate-key="fin-subtitle">Interest & Tax Calculators</p></div>
        
        <div class="finance-layout">
            <!-- Left Column: Calculators -->
            <div class="calculators-column">
                <div class="finance-section-header-with-btn">
                    <h2 class="finance-section-header"><i class="fas fa-percentage" style="color:var(--primary-color)"></i> <span data-translate-key="sec-interest">Interest</span></h2>
                    <button class="formulas-info-btn-small" id="formulas-info-btn">
                        <i class="fas fa-calculator"></i>
                        <span>Formulas & Info</span>
                    </button>
                </div>
                <div class="calculator-grid" id="finance-grid">
                    <!-- Simple Interest -->
                    <div class="calc-card" data-type="fin-simple">
                        <div class="card-header"><div class="header-left"><div class="card-icon"><i class="fas fa-chart-line"></i></div><h2 class="card-title">Simple Interest</h2></div><button class="reset-btn"><i class="fas fa-sync-alt"></i></button></div>
                        <div class="input-group">
                            <div class="field-wrapper"><label data-translate-key="lbl-principal">Principal</label><input type="text" id="si-p" placeholder="$1,000.00" data-format="currency"></div>
                            <div class="input-row"><div class="field-wrapper"><label data-translate-key="lbl-rate">Rate %</label><input type="text" id="si-r" placeholder="5.0%" data-format="number"></div><div class="field-wrapper"><label data-translate-key="lbl-time">Time (Yr)</label><input type="text" id="si-t" placeholder="3 years" data-format="number"></div></div>
                        </div>
                        <div class="output-area"><div class="main-result"><span class="result-label" data-translate-key="res-total">Total</span><span class="result-value" id="si-res-total">$0.00</span></div><div class="sub-results"><div class="sub-item"><span class="result-label" data-translate-key="res-interest">Interest</span><span class="sub-val" id="si-res-int">$0.00</span></div></div></div>
                    </div>
                    <!-- Compound Interest -->
                    <div class="calc-card" data-type="fin-compound">
                        <div class="card-header"><div class="header-left"><div class="card-icon"><i class="fas fa-chart-pie"></i></div><h2 class="card-title">Compound Interest</h2></div><button class="reset-btn"><i class="fas fa-sync-alt"></i></button></div>
                        <div class="input-group">
                            <div class="field-wrapper"><label data-translate-key="lbl-principal">Principal</label><input type="text" id="ci-p" placeholder="$1,000.00" data-format="currency"></div>
                            <div class="input-row"><div class="field-wrapper"><label data-translate-key="lbl-rate">Rate %</label><input type="text" id="ci-r" placeholder="5.0%" data-format="number"></div><div class="field-wrapper"><label data-translate-key="lbl-time">Time (Yr)</label><input type="text" id="ci-t" placeholder="3 years" data-format="number"></div></div>
                            <div class="field-wrapper"><label data-translate-key="lbl-compound">Compound</label><select id="ci-n"><option value="12" data-translate-key="val-monthly">Monthly</option><option value="4" data-translate-key="val-quarterly">Quarterly</option><option value="1" data-translate-key="val-yearly">Annually</option></select></div>
                        </div>
                        <div class="output-area"><div class="main-result"><span class="result-label" data-translate-key="res-total">Total</span><span class="result-value" id="ci-res-total">$0.00</span></div><div class="sub-results"><div class="sub-item"><span class="result-label" data-translate-key="res-interest">Interest</span><span class="sub-val" id="ci-res-int">$0.00</span></div></div></div>
                    </div>
                </div>

                <h2 class="finance-section-header" style="margin-top:3rem"><i class="fas fa-landmark" style="color:var(--primary-color)"></i> <span data-translate-key="sec-tax">Tax (Cambodia)</span></h2>
                <div class="disclaimer-card" data-translate-key="disclaimer">Disclaimer: For educational purposes only.</div>
                
                <div class="calculator-grid">
                    <!-- Salary Tax -->
                    <div class="calc-card" data-type="fin-salary" data-currency="khr">
                        <div class="card-header">
                            <div class="header-left"><div class="card-icon"><i class="fas fa-money-bill-wave"></i></div><h2 class="card-title">Salary Tax</h2></div>
                            <div class="currency-switcher"><button class="currency-btn active" data-curr="khr">áŸ›</button><button class="currency-btn" data-curr="usd">$</button></div>
                        </div>
                        <div class="input-group">
                            <div class="field-wrapper"><label data-translate-key="lbl-gross-sal">Gross Salary</label><input type="text" id="st-gross" placeholder="3,000,000 KHR" data-format="currency"></div>
                            <div class="field-wrapper"><label data-translate-key="lbl-dependents">Dependents</label><input type="text" id="st-dep" placeholder="0" data-format="int"></div>
                        </div>
                        <div class="output-area"><div class="main-result"><span class="result-label" data-translate-key="res-tax-due">Tax Due</span><span class="result-value" id="st-res-tax">0</span></div><div class="sub-results"><div class="sub-item"><span class="result-label" data-translate-key="res-taxable">Taxable</span><span class="sub-val" id="st-res-taxable">0</span></div></div></div>
                    </div>
                    <!-- VAT -->
                    <div class="calc-card" data-type="fin-vat" data-currency="khr">
                        <div class="card-header">
                            <div class="header-left"><div class="card-icon"><i class="fas fa-receipt"></i></div><h2 class="card-title">VAT (10%)</h2></div>
                            <div class="currency-switcher"><button class="currency-btn active" data-curr="khr">áŸ›</button><button class="currency-btn" data-curr="usd">$</button></div>
                        </div>
                        <div class="input-group">
                            <div class="field-wrapper"><label data-translate-key="lbl-vat-excl">Excl. VAT</label><input type="text" id="vat-amt" placeholder="10,000 KHR" data-format="currency"></div>
                        </div>
                        <div class="output-area"><div class="main-result"><span class="result-label" data-translate-key="res-total-inc">Total</span><span class="result-value" id="vat-res-total">0</span></div><div class="sub-results"><div class="sub-item"><span class="result-label" data-translate-key="res-vat-amt">VAT</span><span class="sub-val" id="vat-res-only">0</span></div></div></div>
                    </div>
                    <!-- Property Tax -->
                    <div class="calc-card" data-type="fin-prop" data-currency="usd">
                        <div class="card-header">
                            <div class="header-left"><div class="card-icon"><i class="fas fa-home"></i></div><h2 class="card-title">Property Transfer</h2></div>
                            <div class="currency-switcher"><button class="currency-btn" data-curr="khr">áŸ›</button><button class="currency-btn active" data-curr="usd">$</button></div>
                        </div>
                        <div class="input-group">
                            <div class="field-wrapper"><label data-translate-key="lbl-prop-val">Value</label><input type="text" id="pt-val" placeholder="$100,000.00" data-format="currency"></div>
                        </div>
                        <div class="output-area"><div class="main-result"><span class="result-label" data-translate-key="res-transfer-tax">Tax (4%)</span><span class="result-value" id="pt-res-tax">0</span></div></div>
                    </div>
                </div>
            </div>
        </div>
    `;

    const textExtractionHTML = `
        <div class="back-btn-wrapper"><a href="#resources" class="back-btn"><i class="fas fa-arrow-left"></i><span data-translate-key="back-home">Back to Home</span></a></div>
        
        <div class="ocr-header-compact">
            <h1 data-translate-key="ocr-title">Text Extraction</h1>
            <p data-translate-key="ocr-subtitle">Upload an image to extract text instantly.</p>
        </div>

        <div class="ocr-split-layout">
            <!-- Left Panel: Image Input -->
            <div class="ocr-panel ocr-left">
                <div class="ocr-upload-container" id="ocr-dropzone">
                    <input type="file" id="ocr-file-input" accept="image/*" hidden>
                    
                    <!-- Empty State -->
                    <div class="upload-placeholder" id="ocr-empty-state">
                        <div class="icon-box"><i class="fas fa-cloud-upload-alt"></i></div>
                        <h3 data-translate-key="ocr-drop-text">Click or Drop Image Here</h3>
                        <p class="sm-text">Supports JPG, PNG, BMP</p>
                    </div>

                    <!-- Preview State -->
                    <div class="image-preview-wrapper" id="ocr-preview-state" style="display:none;">
                        <img id="ocr-preview" src="" alt="Preview">
                        <button class="btn-remove" id="ocr-remove-img" title="Remove Image"><i class="fas fa-trash"></i></button>
                    </div>
                </div>

                <!-- Language Selection -->
                <div class="language-selection">
                    <h4>Select Languages:</h4>
                    <div class="lang-grid" id="ocr-lang-grid">
                        <button class="lang-btn active" data-lang="eng+khm+chi_sim">All Languages</button>
                        <button class="lang-btn" data-lang="eng">English</button>
                        <button class="lang-btn" data-lang="khm">Khmer</button>
                        <button class="lang-btn" data-lang="chi_sim">Chinese</button>
                        <button class="lang-btn" data-lang="eng+khm">Eng + Khmer</button>
                        <button class="lang-btn" data-lang="eng+chi_sim">Eng + Chinese</button>
                        <button class="lang-btn" data-lang="khm+chi_sim">Khmer + Chinese</button>
                    </div>
                </div>
            </div>

            <!-- Right Panel: Controls & Output -->
            <div class="ocr-panel ocr-right">
                <div class="ocr-action-area">
                    <button id="btn-start-ocr" class="btn-primary btn-full">
                        <i class="fas fa-bolt"></i> <span data-translate-key="btn-extract">Extract Text</span>
                    </button>
                    
                    <div class="progress-bar-strip" id="ocr-progress-con">
                        <div class="progress-fill" id="ocr-bar"></div>
                        <span class="progress-text" id="ocr-status">Ready</span>
                    </div>
                </div>

                <div class="ocr-output-area">
                    <div class="output-toolbar">
                        <span class="label">Result:</span>
                        <button class="btn-icon-text" id="btn-copy-ocr"><i class="fas fa-copy"></i> Copy</button>
                    </div>
                    <textarea id="ocr-result-box" class="ocr-textarea" placeholder="Extracted text will appear here..." readonly></textarea>
                </div>
            </div>
        </div>

        <style>
            /* Split Layout Styles */
            .ocr-header-compact { text-align: center; margin-bottom: 2rem; }
            .ocr-header-compact h1 { font-size: 2rem; margin-bottom: 0.5rem; }
            
            .ocr-split-layout {
                display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;
                max-width: 1100px; margin: 0 auto; min-height: 500px;
            }

            .ocr-panel {
                background: var(--card-bg); border: 1px solid var(--border-color);
                border-radius: 24px; padding: 1.5rem; display: flex; flex-direction: column;
                box-shadow: var(--shadow); transition: var(--transition);
            }
            .ocr-panel:hover { box-shadow: var(--shadow-lg); border-color: var(--primary-color); }

            /* Left Panel */
            .ocr-upload-container {
                flex: 1; border: 2px dashed var(--border-color); border-radius: 16px;
                position: relative; overflow: hidden; display: flex; align-items: center; justify-content: center;
                background: var(--input-bg); cursor: pointer; transition: 0.3s; min-height: 350px;
                margin-bottom: 1.5rem;
            }
            .ocr-upload-container:hover { border-color: var(--primary-color); background: rgba(59, 130, 246, 0.05); }
            
            .upload-placeholder { text-align: center; color: var(--text-muted); pointer-events: none; }
            .icon-box { font-size: 3rem; margin-bottom: 1rem; color: var(--primary-color); opacity: 0.8; }
            .sm-text { font-size: 0.85rem; opacity: 0.7; margin-top: 0.5rem; }

            .image-preview-wrapper { width: 100%; height: 100%; position: relative; display: flex; align-items: center; justify-content: center; background: #000; }
            #ocr-preview { max-width: 100%; max-height: 100%; object-fit: contain; }
            .btn-remove {
                position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.6);
                color: white; border: none; width: 32px; height: 32px; border-radius: 50%;
                cursor: pointer; display: flex; align-items: center; justify-content: center;
                transition: 0.2s;
            }
            .btn-remove:hover { background: #ef4444; }

            /* Language Selection */
            .language-selection {
                background: var(--input-bg); border: 1px solid var(--border-color);
                border-radius: 16px; padding: 1rem;
            }
            .language-selection h4 {
                margin: 0 0 1rem 0; font-size: 0.9rem; font-weight: 600;
                color: var(--text-color);
            }
            .lang-grid {
                display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 8px;
            }
            .lang-btn {
                background: var(--card-bg); border: 1px solid var(--border-color);
                padding: 8px 12px; border-radius: 8px; cursor: pointer;
                font-size: 0.75rem; transition: var(--transition);
                text-align: center; font-weight: 500;
            }
            .lang-btn:hover {
                background: rgba(59, 130, 246, 0.1); border-color: var(--primary-color);
                color: var(--primary-color);
            }
            .lang-btn.active {
                background: var(--primary-color); border-color: var(--primary-color);
                color: white;
            }

            /* Right Panel */
            .ocr-right { gap: 1.5rem; }
            
            .btn-full { width: 100%; padding: 14px; border-radius: 12px; font-size: 1rem; display: flex; align-items: center; justify-content: center; gap: 8px; }
            
            .progress-bar-strip {
                height: 6px; background: var(--input-bg); border-radius: 3px; margin-top: 1rem;
                position: relative; display: none;
            }
            .progress-fill { height: 100%; background: var(--primary-color); width: 0%; transition: width 0.2s; }
            .progress-text {
                position: absolute; top: -20px; right: 0; font-size: 0.75rem; color: var(--primary-color); font-weight: 700;
            }

            .ocr-output-area { flex: 1; display: flex; flex-direction: column; }
            .output-toolbar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
            .output-toolbar .label { font-weight: 600; font-size: 0.9rem; }
            .btn-icon-text {
                background: var(--primary-color); color: white; border: none;
                padding: 6px 12px; border-radius: 8px; cursor: pointer;
                font-size: 0.8rem; display: flex; align-items: center; gap: 6px;
                transition: var(--transition);
            }
            .btn-icon-text:hover { background: var(--primary-dark); transform: translateY(-1px); }

            .ocr-textarea {
                flex: 1; width: 100%; padding: 1rem; border: 1px solid var(--border-color);
                border-radius: 12px; background: var(--input-bg); color: var(--text-color);
                font-family: var(--font-family); resize: none; min-height: 200px;
                font-size: 0.95rem; line-height: 1.6; transition: var(--transition);
            }
            .ocr-textarea:focus { outline: none; border-color: var(--primary-color); background: var(--card-bg); }
            .ocr-textarea.kh-text { font-family: "Noto Sans Khmer", sans-serif; line-height: 2; }

            /* Responsive */
            @media (max-width: 768px) {
                .ocr-split-layout { grid-template-columns: 1fr; gap: 1.5rem; }
                .lang-grid { grid-template-columns: repeat(2, 1fr); }
                .ocr-upload-container { min-height: 250px; }
            }
        </style>
    `;

    const voiceExtractionHTML = `
        <div class="back-btn-wrapper"><a href="#resources" class="back-btn"><i class="fas fa-arrow-left"></i><span data-translate-key="back-home">Back to Home</span></a></div>
        
        <div class="voice-extraction-container">
            <div class="voice-header">
                <div class="voice-header-icon">
                    <i class="fas fa-microphone-alt"></i>
                </div>
                <h1 data-translate-key="voice-title">Voice Extraction</h1>
                <p data-translate-key="voice-subtitle">Convert speech to text instantly using AI.</p>
            </div>

            <div class="voice-main-layout">
                <!-- Left Panel: Recording Controls -->
                <div class="voice-control-panel">
                    <div class="voice-visualizer-container">
                        <div class="visualizer-glow"></div>
                        <div class="voice-visualizer" id="voice-waves">
                            <div class="wave"></div>
                            <div class="wave"></div>
                            <div class="wave"></div>
                            <div class="wave"></div>
                            <div class="wave"></div>
                        </div>
                    </div>
                    
                    <div class="voice-controls">
                        <button id="btn-record" class="btn-record" title="Click to Record">
                            <div class="record-btn-inner">
                                <i class="fas fa-microphone"></i>
                            </div>
                        </button>
                        <p id="voice-status" class="status-text" data-translate-key="status-stopped">Click mic to start</p>
                        <div class="status-indicator">
                            <span class="indicator-dot"></span>
                            <span class="indicator-text">Ready</span>
                        </div>
                    </div>

                    <div class="voice-divider">
                        <span class="divider-text">OR</span>
                    </div>

                    <div class="voice-upload-section">
                        <input type="file" id="voice-file-input" accept="audio/*" hidden>
                        <button class="btn-upload" onclick="document.getElementById('voice-file-input').click()">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <span>Upload Audio File</span>
                        </button>
                        <p class="upload-info" id="audio-file-name">Supports MP3, WAV, M4A</p>
                    </div>

                    <div class="voice-tips">
                        <div class="tip-item">
                            <i class="fas fa-lightbulb"></i>
                            <span>Speak clearly for best results</span>
                        </div>
                        <div class="tip-item">
                            <i class="fas fa-volume-up"></i>
                            <span>Ensure minimal background noise</span>
                        </div>
                    </div>
                </div>

                <!-- Right Panel: Output -->
                <div class="voice-output-panel">
                    <div class="output-header">
                        <div class="output-title">
                            <i class="fas fa-file-alt"></i>
                            <span>Transcription Result</span>
                        </div>
                        <div class="output-actions">
                            <button class="btn-action" id="btn-clear-voice" title="Clear Text">
                                <i class="fas fa-eraser"></i>
                            </button>
                            <button class="btn-action" id="btn-copy-voice" title="Copy Text">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button class="btn-action" id="btn-download-voice" title="Download Text">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                    <div class="output-content">
                        <textarea id="voice-result-box" class="voice-textarea" data-translate-key="voice-placeholder" placeholder="Your transcribed text will appear here..."></textarea>
                        <div class="output-stats">
                            <span class="stat-item"><i class="fas fa-font"></i> <span id="char-count">0</span> characters</span>
                            <span class="stat-item"><i class="fas fa-align-left"></i> <span id="word-count">0</span> words</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <style>
            /* Voice Extraction Styles */
            .voice-extraction-container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; }
            .voice-header { text-align: center; margin-bottom: 3rem; position: relative; }
            .voice-header-icon { width: 80px; height: 80px; margin: 0 auto 1.5rem; background: linear-gradient(135deg, #3b82f6, #8b5cf6); border-radius: 20px; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; color: white; box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3); animation: float 3s ease-in-out infinite; }
            .voice-header h1 { font-size: 2.5rem; margin-bottom: 0.5rem; background: linear-gradient(135deg, var(--primary-color), #8b5cf6); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; }
            .voice-header p { color: var(--text-muted); font-size: 1.1rem; }
            .voice-main-layout { display: grid; grid-template-columns: 400px 1fr; gap: 2rem; margin-bottom: 3rem; }

            /* Control Panel */
            .voice-control-panel { background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 24px; padding: 2rem; box-shadow: var(--shadow); display: flex; flex-direction: column; gap: 1.5rem; }
            .voice-visualizer-container { position: relative; height: 120px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; }
            .visualizer-glow { position: absolute; width: 200px; height: 200px; background: radial-gradient(circle, rgba(59, 130, 246, 0.2), transparent); border-radius: 50%; filter: blur(30px); opacity: 0; transition: opacity 0.3s; }
            .voice-visualizer.active ~ .visualizer-glow, .voice-visualizer.active + .visualizer-glow { opacity: 1; }
            .voice-visualizer { display: flex; align-items: center; justify-content: center; gap: 8px; height: 80px; position: relative; z-index: 1; }
            .wave { width: 10px; height: 30px; background: linear-gradient(180deg, var(--primary-color), #8b5cf6); border-radius: 5px; animation: wave 1.2s infinite ease-in-out; animation-play-state: paused; box-shadow: 0 0 10px rgba(59, 130, 246, 0.3); }
            .wave:nth-child(1) { animation-delay: 0s; } .wave:nth-child(2) { animation-delay: 0.1s; } .wave:nth-child(3) { animation-delay: 0.2s; } .wave:nth-child(4) { animation-delay: 0.3s; } .wave:nth-child(5) { animation-delay: 0.4s; }
            .voice-visualizer.active .wave { animation-play-state: running; }
            @keyframes wave { 0%, 100% { height: 30px; opacity: 0.6; } 50% { height: 70px; opacity: 1; } }

            .voice-controls { text-align: center; }
            .btn-record { width: 100px; height: 100px; border-radius: 50%; border: none; background: linear-gradient(135deg, #ef4444, #dc2626); cursor: pointer; box-shadow: 0 8px 25px rgba(239, 68, 68, 0.4); transition: all 0.3s ease; position: relative; overflow: hidden; margin: 0 auto; display: block; }
            .btn-record::before { content: ''; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 0; height: 0; background: rgba(255, 255, 255, 0.3); border-radius: 50%; transition: width 0.3s, height 0.3s; }
            .btn-record:hover::before { width: 100%; height: 100%; }
            .btn-record:hover { transform: scale(1.05); box-shadow: 0 12px 35px rgba(239, 68, 68, 0.5); }
            .record-btn-inner { position: relative; z-index: 1; color: white; font-size: 2.5rem; display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; }
            .btn-record.recording { animation: pulse-record 1.5s infinite; }
            @keyframes pulse-record { 0% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7); } 70% { box-shadow: 0 0 0 25px rgba(220, 38, 38, 0); } 100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0); } }

            .status-text { margin-top: 1rem; font-size: 1rem; color: var(--text-color); font-weight: 500; }
            .status-indicator { display: flex; align-items: center; justify-content: center; gap: 8px; margin-top: 0.5rem; }
            .indicator-dot { width: 8px; height: 8px; background: #10b981; border-radius: 50%; transition: background 0.3s; }
            .indicator-text { font-size: 0.85rem; color: var(--text-muted); }
            .btn-record.recording + .status-text + .status-indicator .indicator-dot { background: #ef4444; animation: pulse-dot 2s infinite; }
            @keyframes pulse-dot { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

            .voice-divider { position: relative; text-align: center; margin: 1.5rem 0; }
            .voice-divider::before { content: ''; position: absolute; top: 50%; left: 0; right: 0; height: 1px; background: var(--border-color); }
            .divider-text { position: relative; background: var(--card-bg); padding: 0 1rem; color: var(--text-muted); font-size: 0.85rem; font-weight: 600; }

            .voice-upload-section { text-align: center; }
            .btn-upload { width: 100%; padding: 1rem; background: var(--input-bg); border: 2px dashed var(--border-color); border-radius: 12px; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; gap: 10px; color: var(--text-color); font-size: 1rem; font-weight: 500; }
            .btn-upload:hover { border-color: var(--primary-color); background: rgba(59, 130, 246, 0.05); transform: translateY(-2px); }
            .btn-upload i { font-size: 1.3rem; color: var(--primary-color); }
            .upload-info { margin-top: 0.5rem; font-size: 0.8rem; color: var(--text-muted); }
            .voice-tips { background: rgba(59, 130, 246, 0.05); border-radius: 12px; padding: 1rem; display: flex; flex-direction: column; gap: 0.75rem; }
            .tip-item { display: flex; align-items: center; gap: 10px; font-size: 0.85rem; color: var(--text-muted); }
            .tip-item i { color: var(--primary-color); font-size: 1rem; }

            /* Output Panel */
            .voice-output-panel { background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 24px; padding: 2rem; box-shadow: var(--shadow); display: flex; flex-direction: column; }
            .output-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border-color); }
            .output-title { display: flex; align-items: center; gap: 10px; font-size: 1.1rem; font-weight: 600; color: var(--text-color); }
            .output-title i { color: var(--primary-color); }
            .output-actions { display: flex; gap: 8px; }
            .btn-action { width: 36px; height: 36px; border-radius: 8px; border: 1px solid var(--border-color); background: var(--input-bg); color: var(--text-color); cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; }
            .btn-action:hover { background: var(--primary-color); color: white; border-color: var(--primary-color); transform: translateY(-2px); }
            .output-content { flex: 1; display: flex; flex-direction: column; }
            .voice-textarea { flex: 1; width: 100%; min-height: 400px; padding: 1.5rem; border: 1px solid var(--border-color); border-radius: 12px; background: var(--input-bg); resize: vertical; font-family: var(--font-family); font-size: 1rem; line-height: 1.8; color: var(--text-color); transition: all 0.3s; }
            .voice-textarea:focus { outline: none; border-color: var(--primary-color); background: var(--card-bg); box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }
            .output-stats { display: flex; gap: 2rem; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color); }
            .stat-item { display: flex; align-items: center; gap: 8px; font-size: 0.9rem; color: var(--text-muted); }
            .stat-item i { color: var(--primary-color); }
            .stat-item span { font-weight: 600; color: var(--text-color); }

            @media (max-width: 968px) {
                .voice-main-layout { grid-template-columns: 1fr; }
                .voice-control-panel { order: 1; }
                .voice-output-panel { order: 2; }
            }
        </style>
    `;

    // --- VOICE EXTRACTION LOGIC ---
    function initVoice() {
        const recordBtn = document.getElementById('btn-record');
        const statusText = document.getElementById('voice-status');
        const resultBox = document.getElementById('voice-result-box');
        const copyBtn = document.getElementById('btn-copy-voice');
        const clearBtn = document.getElementById('btn-clear-voice');
        const downloadBtn = document.getElementById('btn-download-voice');
        const visualizer = document.getElementById('voice-waves');
        const fileInput = document.getElementById('voice-file-input');
        const fileNameDisplay = document.getElementById('audio-file-name');
        const charCount = document.getElementById('char-count');
        const wordCount = document.getElementById('word-count');
        const indicatorText = document.querySelector('.indicator-text');

        let recognition;
        let isRecording = false;

        function updateStats() {
            if(!resultBox) return;
            const text = resultBox.value;
            const chars = text.length;
            const words = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
            if(charCount) charCount.innerText = chars;
            if(wordCount) wordCount.innerText = words;
        }

        if(resultBox) resultBox.addEventListener('input', updateStats);

        // Speech Recognition Setup
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.continuous = true;
            recognition.interimResults = true;
            recognition.lang = currentLang === 'kh' ? 'km-KH' : 'en-US';

            recognition.onstart = () => {
                isRecording = true;
                recordBtn.classList.add('recording');
                visualizer.classList.add('active');
                statusText.innerText = translations[currentLang]['status-listening'] || "Listening...";
                if(indicatorText) indicatorText.innerText = "Recording...";
            };

            recognition.onend = () => {
                isRecording = false;
                recordBtn.classList.remove('recording');
                visualizer.classList.remove('active');
                statusText.innerText = translations[currentLang]['status-stopped'] || "Click mic to start";
                if(indicatorText) indicatorText.innerText = "Ready";
            };

            recognition.onresult = (event) => {
                let interimTranscript = '';
                let finalTranscript = '';

                for (let i = event.resultIndex; i < event.results.length; ++i) {
                    if (event.results[i].isFinal) {
                        finalTranscript += event.results[i][0].transcript;
                    } else {
                        interimTranscript += event.results[i][0].transcript;
                    }
                }
                
                // Append final to textarea
                if (finalTranscript) {
                    // Add a space if there is already text
                    const prefix = resultBox.value.length > 0 ? ' ' : '';
                    resultBox.value += prefix + finalTranscript;
                    updateStats();
                    // Scroll to bottom
                    resultBox.scrollTop = resultBox.scrollHeight;
                }
            };

            recognition.onerror = (event) => {
                console.error("Speech recognition error", event.error);
                statusText.innerText = "Error: " + event.error;
                if(indicatorText) indicatorText.innerText = "Error";
                isRecording = false;
                recordBtn.classList.remove('recording');
                visualizer.classList.remove('active');
            };

            recordBtn.addEventListener('click', () => {
                if (isRecording) {
                    recognition.stop();
                } else {
                    // Refresh Lang in case user switched it
                    recognition.lang = currentLang === 'kh' ? 'km-KH' : 'en-US';
                    try {
                        recognition.start();
                    } catch (e) {
                        console.error("Recognition start error:", e);
                    }
                }
            });

        } else {
            recordBtn.disabled = true;
            recordBtn.style.background = '#94a3b8';
            statusText.innerText = "Browser not supported.";
            if(indicatorText) indicatorText.innerText = "Not Supported";
            alert("Your browser does not support the Web Speech API. Please use Google Chrome or Edge.");
        }

        // Handle File Upload (Mock + Education)
        if(fileInput) {
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    fileNameDisplay.innerText = "Selected: " + file.name;
                    // Technical limitation explanation
                    const msg = `[System Note]: \nThe Web Speech API in browsers only supports live microphone input for security and privacy reasons. It cannot directly transcribe audio files (MP3/WAV) without a backend server.\n\nFile selected: ${file.name}\n\nPlease use the microphone button above to transcribe live speech.`;
                    resultBox.value = msg;
                    updateStats();
                }
            });
        }

        // Buttons
        if(copyBtn) {
            copyBtn.addEventListener('click', () => {
                if(!resultBox.value) return;
                navigator.clipboard.writeText(resultBox.value).then(() => {
                    const icon = copyBtn.querySelector('i');
                    icon.className = 'fas fa-check';
                    setTimeout(() => icon.className = 'fas fa-copy', 2000);
                });
            });
        }

        if(clearBtn) {
            clearBtn.addEventListener('click', () => {
                if(confirm("Clear all text?")) {
                    resultBox.value = '';
                    updateStats();
                }
            });
        }

        if(downloadBtn) {
            downloadBtn.addEventListener('click', () => {
                const text = resultBox.value;
                if(!text) {
                    alert('No text to download!');
                    return;
                }
                const blob = new Blob([text], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'transcription_' + new Date().toISOString().slice(0,10) + '.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });
        }
        
        updateStats();
    }


    // --- LOGIC ---

    let currentLang = localStorage.getItem("userLanguage") || "en";
    let quoteInterval;

    function loadPage(page) {
      const contentArea = document.getElementById("content-area");
      // Cleanup
      if (quoteInterval) clearInterval(quoteInterval);

      if (page === "about") {
        contentArea.innerHTML = aboutPageHTML;
        initTypedEffect();
      } else if (page === "business-calc") {
        contentArea.innerHTML = businessCalcHTML;
        initCalculators();
      } else if (page === "finance-tools") {
        contentArea.innerHTML = financeCalcHTML;
        initFinanceCalc();
      } else if (page === "text-extraction") {
        contentArea.innerHTML = textExtractionHTML;
        initOCR();
      } else if (page === "voice-extraction") {
        contentArea.innerHTML = voiceExtractionHTML;
        initVoice();
      } else {
        contentArea.innerHTML = homePageHTML;
        startQuoteRotation();
      }

      applyTranslations(currentLang);
      // Nav Highlighting
      document.querySelectorAll(".main-nav a").forEach(link => {
        link.classList.remove("active");
        if (page === "resources" || page === "business-calc" || page === "finance-tools" || page === "text-extraction" || page === "voice-extraction") {
          if (link.id === "nav-home") link.classList.add("active");
        } else if (link.getAttribute("href") === `#${page}`) {
          link.classList.add("active");
        }
      });
      window.scrollTo(0, 0);
    }

    function handleHashChange() {
      const hash = window.location.hash.replace("#", "");
      let page = "resources";
      if (hash === "about") page = "about";
      if (hash === "business-calc") page = "business-calc";
      if (hash === "finance-tools") page = "finance-tools";
      if (hash === "text-extraction") page = "text-extraction";
      if (hash === "voice-extraction") page = "voice-extraction";
      loadPage(page);
    }

    // Enhanced Quote Logic with Smooth Animations
    function startQuoteRotation() {
      const textEl = document.getElementById("quote-text");
      const authEl = document.getElementById("quote-author");
      const container = document.querySelector(".quote-container");
      if (!textEl) return;
      let index = 0;
      let isAnimating = false;
      
      // Initial quote with animation
      displayQuote(0);
      
      // Rotate quotes
      quoteInterval = setInterval(() => {
        if (!isAnimating) {
          index = (index + 1) % quotes.length;
          displayQuote(index);
        }
      }, 7000); // Longer interval for better readability
      
      function displayQuote(idx) {
        if (isAnimating) return;
        isAnimating = true;
        
        // Remove any existing animation classes
        textEl.classList.remove('fade-in', 'fade-out');
        authEl.classList.remove('fade-in', 'fade-out');
        
        // Force reflow
        void textEl.offsetWidth;
        
        // Add fade out animation
        textEl.classList.add('fade-out');
        authEl.classList.add('fade-out');
        
        // Wait for fade out to complete, then update content
        setTimeout(() => {
          // Update content
          textEl.innerText = `"${quotes[idx].text}"`;
          authEl.innerText = `- ${quotes[idx].author}`;
          
          // Remove fade out classes
          textEl.classList.remove('fade-out');
          authEl.classList.remove('fade-out');
          
          // Force reflow
          void textEl.offsetWidth;
          
          // Add fade in animation
          textEl.classList.add('fade-in');
          authEl.classList.add('fade-in');
          
          // Mark animation as complete after fade in
          setTimeout(() => {
            isAnimating = false;
          }, 1200);
        }, 600);
      }
    }
    function initTypedEffect() {
      const typingEl = document.querySelector(".typing");
      if (typingEl && window.Typed) new Typed(typingEl, { strings: ["Web Developer.", "Graphic Designer.", "Creator."], typeSpeed: 60, backSpeed: 30, loop: true });
    }

    // --- SHARED UTILS ---
    function getVal(id) {
      const el = document.getElementById(id);
      if (!el) return 0;
      return parseFloat(el.value.replace(/[^0-9.-]/g, '')) || 0;
    }
    function formatMoney(num, currency = "$", decimals = 2) {
      if (currency === "áŸ›") return "áŸ› " + num.toLocaleString('en-US', { maximumFractionDigits: 0 });
      return currency + num.toLocaleString('en-US', { minimumFractionDigits: decimals, maximumFractionDigits: decimals });
    }
    function updateUI(id, val, isSubResult = false) {
      const el = document.getElementById(id);
      if (el) { 
        el.innerText = val; 
        
        // Add positive/negative highlighting for sub-results
        if (isSubResult && el.classList.contains('sub-val')) {
          const parentItem = el.closest('.sub-item');
          const numericValue = parseFloat(val.replace(/[^0-9.-]/g, ''));
          
          // Remove existing classes
          el.classList.remove('positive', 'negative');
          if (parentItem) {
            parentItem.classList.remove('positive', 'negative');
          }
          
          // Add appropriate classes based on value
          if (!isNaN(numericValue)) {
            if (numericValue > 0) {
              el.classList.add('positive');
              if (parentItem) parentItem.classList.add('positive');
            } else if (numericValue < 0) {
              el.classList.add('negative');
              if (parentItem) parentItem.classList.add('negative');
            }
          }
        }
        
        el.style.opacity = 0.5; 
        setTimeout(() => el.style.opacity = 1, 150); 
      }
    }

    // --- BUSINESS CALC LOGIC ---
    function initCalculators() {
      flatpickr(".date-input", { dateFormat: "d / M / Y", onChange: (sd, ds, ins) => ins.element.dispatchEvent(new Event('input', { bubbles: true })) });
      setupInputs();

      // Reset Logic
      document.querySelectorAll(".reset-btn").forEach(btn => {
        btn.addEventListener("click", (e) => {
          const card = e.target.closest(".calc-card");
          card.querySelectorAll("input").forEach(i => { i.value = ""; if (i._flatpickr) i._flatpickr.clear(); });
          card.querySelectorAll("select").forEach(s => s.selectedIndex = 0);
          
          // Reset outputs
          const type = card.dataset.type;
          if (type === 'pricing') { updateUI('res-p-final', '$0.00'); updateUI('res-p-saved', '0%'); updateUI('res-p-diff', '$0.00'); }
          else if (type === 'sub') { updateUI('res-s-end', '---'); updateUI('res-s-dur', '0 M'); updateUI('res-s-total', '0'); }
          else if (type === 'invoice') { updateUI('res-i-fee', '$0.00'); updateUI('res-i-sys', '$0.00'); updateUI('res-i-vat', '$0.00'); document.getElementById('i-note').innerText = ''; }
          else if (type === 'billing') { updateUI('res-b-extra', '$0.00'); updateUI('res-b-days', '0'); updateUI('res-b-rate', '$0.00'); }
        });
      });

      // Calc Listener
      document.getElementById("calc-grid").addEventListener("input", handleCalculatorEvent);
      document.getElementById("calc-grid").addEventListener("change", handleCalculatorEvent);
    }

    function handleCalculatorEvent(e) {
      const target = e.target;
      const card = target.closest(".calc-card");
      if (card) {
        const type = card.dataset.type;
        if (type === 'billing' && target.classList.contains('billing-by')) {
          clearOtherBillingInputs(target);
        }
        runBusinessCalc(card, target.id);
      }
    }

    function runBusinessCalc(card, triggeredBy) {
      const type = card.dataset.type;
      if (type === 'pricing') calculatePricing(triggeredBy);
      else if (type === 'sub') calculateEndDate();
      else if (type === 'invoice') calculateInvoiceAdjustment();
      else if (type === 'billing') calculateBillingAdjustment();
    }

    // --- HELPER FUNCTIONS ---
    function stripSeparators(value) { return value ? String(value).replace(/[, $]/g, "").trim() : ""; }
    function parseNum(value) { 
      const cleaned = stripSeparators(value);
      const num = cleaned !== "" ? parseFloat(cleaned) : 0;
      // Add bounds checking to prevent calculation errors
      if (isNaN(num) || !isFinite(num)) return 0;
      if (Math.abs(num) > 999999999) return 0; // Prevent extremely large numbers
      return num;
    }
    function formatCurrency(num, precision = 2) { 
      if (isNaN(num) || !isFinite(num)) return `$0.00`;
      return `$${num.toLocaleString("en-US", { minimumFractionDigits: precision, maximumFractionDigits: precision })}`; 
    }
    function formatPercent(num) { 
      if (isNaN(num) || !isFinite(num)) return "0.0000%";
      return `${num.toLocaleString("en-US", { minimumFractionDigits: 4, maximumFractionDigits: 4 })}%`; 
    }
    function formatDate(date) {
      const day = String(date.getDate()).padStart(2, "0");
      const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
      return `${day} / ${monthNames[date.getMonth()]} / ${date.getFullYear()}`;
    }
    function parseCustomDate(dateString) {
      if (!dateString) return null;
      const parts = dateString.split(" / ");
      if (parts.length !== 3) return null;
      const day = parseInt(parts[0], 10);
      const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
      const month = monthNames.indexOf(parts[1]);
      const year = parseInt(parts[2], 10);
      if (isNaN(day) || month === -1 || isNaN(year)) return null;
      const date = new Date(year, month, day);
      return isNaN(date.getTime()) ? null : date;
    }

    // --- CALCULATION LOGIC ---
    function calculatePricing(triggeredBy) {
      // Cache DOM elements for better performance
      const elements = {
        origInput: document.getElementById("p-orig"),
        discInput: document.getElementById("p-disc"),
        saleInput: document.getElementById("p-sale"),
        finalResult: document.getElementById("res-p-final"),
        savedResult: document.getElementById("res-p-saved"),
        diffResult: document.getElementById("res-p-diff")
      };

      const originalPrice = parseNum(elements.origInput.value);
      const discountPercent = parseNum(elements.discInput.value);
      const priceAfterDiscountVal = parseNum(elements.saleInput.value);

      if (!originalPrice || originalPrice <= 0) return;

      let finalPrice = originalPrice;
      let finalDiscount = 0;

      if (triggeredBy === "p-sale" && !isNaN(priceAfterDiscountVal)) {
        finalDiscount = ((originalPrice - priceAfterDiscountVal) / originalPrice) * 100;
        finalPrice = priceAfterDiscountVal;
      } else if (!isNaN(discountPercent)) {
        finalPrice = originalPrice * (1 - discountPercent / 100);
        finalDiscount = discountPercent;
      } else if (!isNaN(priceAfterDiscountVal)) {
        finalDiscount = ((originalPrice - priceAfterDiscountVal) / originalPrice) * 100;
        finalPrice = priceAfterDiscountVal;
      }

      const profit = finalPrice - originalPrice;
      updateUI("res-p-final", formatCurrency(finalPrice));
      updateUI("res-p-saved", formatPercent(Math.abs(finalDiscount)), true);
      updateUI("res-p-diff", formatCurrency(profit), true);
    }

    function calculateEndDate() {
      const startInput = document.getElementById("s-start");
      const startChargeDate = parseCustomDate(startInput.value);
      const monthRenew = parseInt(stripSeparators(document.getElementById("s-months").value)) || 0;
      const freeMonth = parseInt(stripSeparators(document.getElementById("s-free").value)) || 0;
      const additionalDays = parseInt(stripSeparators(document.getElementById("s-days").value)) || 0;

      if (!startChargeDate) {
        updateUI("res-s-end", "---"); updateUI("res-s-dur", "0 M"); updateUI("res-s-total", "0");
        return;
      }

      const startDate = new Date(startChargeDate);
      startDate.setHours(0, 0, 0, 0);
      const totalMonths = monthRenew + freeMonth;

      let expiryDate = new Date(startDate);
      expiryDate.setMonth(expiryDate.getMonth() + totalMonths);
      expiryDate.setDate(expiryDate.getDate() - 1 + additionalDays);

      let years = 0, months = 0, days = 0;
      if (expiryDate >= startDate) {
        let endDateCloned = new Date(expiryDate);
        months = (endDateCloned.getFullYear() - startDate.getFullYear()) * 12 + (endDateCloned.getMonth() - startDate.getMonth());
        let tempStartDate = new Date(startDate);
        tempStartDate.setMonth(tempStartDate.getMonth() + months);
        if (tempStartDate > endDateCloned) {
          months--;
          tempStartDate.setMonth(tempStartDate.getMonth() - 1);
        }
        days = Math.floor((endDateCloned - tempStartDate) / (1000 * 60 * 60 * 24)) + 1;
        years = Math.floor(months / 12);
        months = months % 12;
      }

      let durationParts = [];
      if (years > 0) durationParts.push(`${years}Y`);
      if (months > 0) durationParts.push(`${months}M`);
      if (days > 0) durationParts.push(`${days}D`);

      const timeDiff = expiryDate.getTime() - startDate.getTime();
      const totalDays = timeDiff < 0 ? 0 : Math.round(timeDiff / (1000 * 60 * 60 * 24)) + 1;

      updateUI("res-s-end", formatDate(expiryDate));
      updateUI("res-s-dur", durationParts.length > 0 ? durationParts.join(" ") : "0 Days", true);
      updateUI("res-s-total", totalDays, true);
    }

    function calculateInvoiceAdjustment() {
      const amountVat = parseNum(document.getElementById("i-total").value) || 0;
      const priceInSystem = parseNum(document.getElementById("i-sys").value) || 0;
      const months = parseInt(stripSeparators(document.getElementById("i-months").value));

      const priceWithoutVat = amountVat / 1.1;
      const systemWithoutVat = priceInSystem / 1.1;

      const noteElement = document.getElementById("i-note");
      if (amountVat > 0) {
        noteElement.innerText = `(Excl: ${formatCurrency(priceWithoutVat, 4)})`;
      } else {
        noteElement.innerText = "";
      }

      let adjustmentFee = 0;
      if (months > 0) {
        adjustmentFee = parseFloat(((priceWithoutVat - systemWithoutVat) / months).toFixed(4));
      }

      const totalAdjustment = adjustmentFee * (months || 0);
      const newPriceInclVat = (systemWithoutVat + totalAdjustment) * 1.1;
      const vatAmount = priceWithoutVat * 0.1;

      updateUI("res-i-fee", formatCurrency(isNaN(adjustmentFee) ? 0 : adjustmentFee, 4), true);
      updateUI("res-i-sys", formatCurrency(isNaN(newPriceInclVat) ? 0 : newPriceInclVat, 4), true);
      updateUI("res-i-vat", formatCurrency(isNaN(vatAmount) ? 0 : vatAmount, 4), true);
    }

    function clearOtherBillingInputs(target) {
      const daysInput = document.getElementById("b-days-spec");
      const feeInput = document.getElementById("b-rem-fee");
      const fromInput = document.getElementById("b-start");
      const toInput = document.getElementById("b-end");
      const fromPicker = fromInput._flatpickr;
      const toPicker = toInput._flatpickr;

      if (target.id === "b-days-spec") {
        if (feeInput.value) feeInput.value = "";
        if (fromPicker && fromPicker.selectedDates.length) fromPicker.clear();
        if (toPicker && toPicker.selectedDates.length) toPicker.clear();
      } else if (target.id === "b-rem-fee") {
        if (daysInput.value) daysInput.value = "";
        if (fromPicker && fromPicker.selectedDates.length) fromPicker.clear();
        if (toPicker && toPicker.selectedDates.length) toPicker.clear();
      } else if (target.id === "b-start" || target.id === "b-end") {
        if (daysInput.value) daysInput.value = "";
        if (feeInput.value) feeInput.value = "";
      }
    }

    function calculateBillingAdjustment() {
      const feeInput = document.getElementById("b-fee");
      const monthlyFee = parseNum(feeInput.value);
      
      if (!monthlyFee) {
        updateUI("res-b-rate", "$0.00"); updateUI("res-b-extra", "$0.00"); updateUI("res-b-days", "0");
        return;
      }

      const daysOfMonth = parseInt(document.getElementById("b-dim").value);
      const perDayRate = monthlyFee / daysOfMonth;
      updateUI("res-b-rate", formatCurrency(perDayRate), true);

      let daysToCharge = 0;
      const daysToProRate = parseInt(stripSeparators(document.getElementById("b-days-spec").value));
      const fromDate = parseCustomDate(document.getElementById("b-start").value);
      const toDate = parseCustomDate(document.getElementById("b-end").value);
      const remainingFee = parseNum(document.getElementById("b-rem-fee").value);

      if (!isNaN(daysToProRate)) {
        daysToCharge = daysToProRate;
      } else if (fromDate && toDate) {
        if (toDate >= fromDate) {
          daysToCharge = Math.round((toDate.getTime() - fromDate.getTime()) / (1000 * 60 * 60 * 24)) + 1;
        }
      } else if (!isNaN(remainingFee)) {
        daysToCharge = Math.round(remainingFee / perDayRate);
      }

      const extraCharge = perDayRate * daysToCharge;
      updateUI("res-b-extra", formatCurrency(isNaN(extraCharge) ? 0 : extraCharge), true);
      updateUI("res-b-days", daysToCharge, true);
    }

    function setupInputs() {
      document.querySelectorAll("input[data-format]").forEach(input => {
        input.addEventListener("input", (e) => {
          const format = e.target.dataset.format;
          let value = e.target.value;
          
          if (format === "currency" || format === "number") {
            // Allow numbers with decimal points
            const cleaned = value.replace(/[^0-9.]/g, "");
            const parts = cleaned.split(".");
            
            // Only allow one decimal point
            if (parts.length > 2) {
              const decimalIndex = cleaned.indexOf(".");
              e.target.value = cleaned.substring(0, decimalIndex + 1) + cleaned.substring(decimalIndex + 1).replace(/\./g, "");
            } else {
              e.target.value = cleaned;
            }
          } else if (format === "int") {
            // Only allow integers including negative numbers
            // Allow minus sign only at the beginning
            const cursorPos = e.target.selectionStart;
            const hasMinusAtStart = value.length > 0 && value[0] === '-';
            const cleaned = value.replace(/[^0-9-]/g, "");
            
            // Ensure only one minus sign and it's at the beginning
            const minusCount = (cleaned.match(/-/g) || []).length;
            if (minusCount > 1) {
              // Remove all minus signs except the first one
              e.target.value = '-' + cleaned.replace(/-/g, "");
            } else if (minusCount === 1 && cleaned[0] !== '-') {
              // Move minus sign to beginning if it's not there
              e.target.value = '-' + cleaned.replace(/-/g, "");
            } else {
              e.target.value = cleaned;
            }
            
            // Restore cursor position
            setTimeout(() => {
              e.target.setSelectionRange(cursorPos, cursorPos);
            }, 0);
          }
        });
        
        // Format on blur for better UX
        input.addEventListener("blur", (e) => {
          const format = e.target.dataset.format;
          const value = parseNum(e.target.value);
          
          if (format === "currency" && value !== 0) {
            e.target.value = formatCurrency(value, 2);
          } else if (format === "number" && value !== 0) {
            e.target.value = value.toLocaleString("en-US", { minimumFractionDigits: 2, maximumFractionDigits: 2 });
          }
        });
      });
    }

    // --- FINANCE CALC LOGIC ---
    function initFinanceCalc() {
      setupInputs();

      // Resets
      document.querySelectorAll(".reset-btn").forEach(btn => {
        btn.addEventListener("click", e => {
          const card = e.target.closest(".calc-card");
          card.querySelectorAll("input").forEach(i => i.value = "");
          runFinanceCalc(card);
        });
      });

      // Inputs
      document.getElementById("finance-grid").parentElement.addEventListener("input", e => {
        const card = e.target.closest(".calc-card");
        if (card) runFinanceCalc(card);
      });
      document.getElementById("finance-grid").parentElement.addEventListener("change", e => {
        const card = e.target.closest(".calc-card");
        if (card) runFinanceCalc(card);
      });

      // Currency Switcher
      document.querySelectorAll(".currency-btn").forEach(btn => {
        btn.addEventListener("click", e => {
          const card = btn.closest(".calc-card");
          const newCurr = btn.dataset.curr;
          const oldCurr = card.dataset.currency;
          if (newCurr === oldCurr) return;

          // Toggle active state
          card.querySelector(".currency-btn.active").classList.remove("active");
          btn.classList.add("active");
          card.dataset.currency = newCurr;

          // Convert Input Value
          const input = card.querySelector("input[data-format='currency']");
          let val = getVal(input.id);
          if (newCurr === 'usd' && oldCurr === 'khr') val /= KHR_USD_RATE;
          else if (newCurr === 'khr' && oldCurr === 'usd') val *= KHR_USD_RATE;

          // Update input nicely
          input.value = val.toFixed(newCurr === 'usd' ? 2 : 0);

          runFinanceCalc(card);
        });
      });
    }

    function runFinanceCalc(card) {
      const type = card.dataset.type;
      const curr = card.dataset.currency === 'khr' ? 'áŸ›' : '$';

      if (type === 'fin-simple') {
        const p = getVal('si-p'), r = getVal('si-r') / 100, t = getVal('si-t');
        const i = p * r * t;
        updateUI('si-res-int', formatMoney(i));
        updateUI('si-res-total', formatMoney(p + i));
      } else if (type === 'fin-compound') {
        const p = getVal('ci-p'), r = getVal('ci-r') / 100, t = getVal('ci-t'), n = parseFloat(document.getElementById('ci-n').value);
        const a = p * Math.pow(1 + r / n, n * t);
        updateUI('ci-res-total', formatMoney(a));
        updateUI('ci-res-int', formatMoney(a - p));
      } else if (type === 'fin-salary') {
        let gross = getVal('st-gross'), dep = getVal('st-dep');
        // If USD, convert to KHR for calculation
        if (curr === '$') gross *= KHR_USD_RATE;

        const rebate = dep * 150000;
        let taxable = Math.max(0, gross - rebate);
        let tax = 0;
        for (let b of CAMBODIA_SALARY_TAX_BRACKETS) {
          if (taxable < b.threshold) {
            tax = (taxable * b.rate) - b.deduction; break;
          }
        }
        tax = Math.max(0, tax);

        // Display (Convert back if needed)
        if (curr === '$') { taxable /= KHR_USD_RATE; tax /= KHR_USD_RATE; }

        updateUI('st-res-taxable', formatMoney(taxable, curr, curr === '$' ? 2 : 0));
        updateUI('st-res-tax', formatMoney(tax, curr, curr === '$' ? 2 : 0));
      } else if (type === 'fin-vat') {
        const amt = getVal('vat-amt');
        updateUI('vat-res-total', formatMoney(amt * 1.1, curr, curr === '$' ? 2 : 0));
        updateUI('vat-res-only', formatMoney(amt * 0.1, curr, curr === '$' ? 2 : 0));
      } else if (type === 'fin-prop') {
        let val = getVal('pt-val');
        updateUI('pt-res-tax', formatMoney(val * 0.04, curr, curr === '$' ? 2 : 0));
      }
    }

    // --- OCR LOGIC ---
    function initOCR() {
      const dropzone = document.getElementById('ocr-dropzone');
      const fileInput = document.getElementById('ocr-file-input');
      const emptyState = document.getElementById('ocr-empty-state');
      const previewState = document.getElementById('ocr-preview-state');
      const preview = document.getElementById('ocr-preview');
      const removeBtn = document.getElementById('ocr-remove-img');
      
      const extractBtn = document.getElementById('btn-start-ocr');
      const resultBox = document.getElementById('ocr-result-box');
      const statusText = document.getElementById('ocr-status');
      const progressBar = document.getElementById('ocr-bar');
      const progressCon = document.getElementById('ocr-progress-con');
      const copyBtn = document.getElementById('btn-copy-ocr');

      let currentImageFile = null;
      let currentWorker = null;

      // Language options with proper Tesseract codes
      const languages = {
        'eng': { name: 'English', code: 'eng' },
        'khm': { name: 'Khmer', code: 'khm' },
        'chi_sim': { name: 'Chinese (Simplified)', code: 'chi_sim' },
        'eng+khm': { name: 'English + Khmer', code: 'eng+khm' },
        'eng+chi_sim': { name: 'English + Chinese', code: 'eng+chi_sim' },
        'khm+chi_sim': { name: 'Khmer + Chinese', code: 'khm+chi_sim' },
        'eng+khm+chi_sim': { name: 'All Languages', code: 'eng+khm+chi_sim' }
      };

      let selectedLang = 'eng+khm+chi_sim';

      // 1. Handle File Input
      if(emptyState) emptyState.addEventListener('click', () => fileInput.click());
      fileInput.addEventListener('change', (e) => {
        if (e.target.files.length > 0) handleFile(e.target.files[0]);
      });

      // 2. Handle Drag & Drop
      dropzone.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropzone.classList.add('drag-over');
      });
      dropzone.addEventListener('dragleave', () => dropzone.classList.remove('drag-over'));
      dropzone.addEventListener('drop', (e) => {
        e.preventDefault();
        dropzone.classList.remove('drag-over');
        if (e.dataTransfer.files.length > 0) handleFile(e.dataTransfer.files[0]);
      });

      // 3. Handle Paste
      document.addEventListener('paste', (e) => {
        // Only check paste if OCR page is active
        if(window.location.hash !== '#text-extraction') return;
        
        const items = e.clipboardData.items;
        for (let i = 0; i < items.length; i++) {
          if (items[i].type.indexOf("image") !== -1) {
            handleFile(items[i].getAsFile());
            break;
          }
        }
      });

      function handleFile(file) {
        currentImageFile = file;
        const reader = new FileReader();
        reader.onload = (e) => {
          preview.src = e.target.result;
          emptyState.style.display = 'none';
          previewState.style.display = 'flex'; // Flex for centering
        };
        reader.readAsDataURL(file);
      }

      if(removeBtn) removeBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        currentImageFile = null;
        fileInput.value = "";
        preview.src = "";
        previewState.style.display = 'none';
        emptyState.style.display = 'block';
      });

      // 4. Language Setup and Selection
      resultBox.classList.add('kh-text');

      // Add language selection event listeners
      const langGrid = document.getElementById('ocr-lang-grid');
      if (langGrid) {
        langGrid.addEventListener('click', (e) => {
          if (e.target.classList.contains('lang-btn')) {
            // Remove active class from all buttons
            document.querySelectorAll('.lang-btn').forEach(btn => {
              btn.classList.remove('active');
            });
            
            // Add active class to clicked button
            e.target.classList.add('active');
            
            // Update selected language
            selectedLang = e.target.dataset.lang;
            console.log('Selected language:', selectedLang);
          }
        });
      }

      // 5. Image preprocessing function
      function preprocessImage(imgElement) {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        
        // Set canvas dimensions to match image
        canvas.width = imgElement.naturalWidth;
        canvas.height = imgElement.naturalHeight;
        
        // Draw image
        ctx.drawImage(imgElement, 0, 0);
        
        // Get image data for processing
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const data = imageData.data;
        
        // Convert to grayscale and enhance contrast
        for (let i = 0; i < data.length; i += 4) {
          // Convert to grayscale using luminance formula
          const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;
          
          // Apply contrast enhancement
          const enhanced = gray > 128 ? 255 : 0;
          
          data[i] = enhanced;     // Red
          data[i + 1] = enhanced; // Green
          data[i + 2] = enhanced; // Blue
          // Alpha channel (data[i + 3]) remains unchanged
        }
        
        // Put processed image data back
        ctx.putImageData(imageData, 0, 0);
        
        return canvas;
      }

      // 6. Run Tesseract with improved error handling
      extractBtn.addEventListener('click', async () => {
        if (!currentImageFile) {
          alert("Please upload or paste an image first.");
          return;
        }

        extractBtn.disabled = true;
        extractBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        progressCon.style.display = 'block';
        progressBar.style.width = '0%';
        statusText.innerText = "Initializing...";

        try {
          // Clean up any existing worker
          if (currentWorker) {
            await currentWorker.terminate();
            currentWorker = null;
          }

          // Create new worker with enhanced options
          currentWorker = await Tesseract.createWorker({
            logger: m => {
              console.log('Tesseract:', m);
              if (m.status === 'recognizing text') {
                const p = (m.progress * 100).toFixed(0);
                statusText.innerText = `Recognizing... ${p}%`;
                progressBar.style.width = `${p}%`;
              } else if (m.status === 'loading language traineddata') {
                statusText.innerText = `Loading language data...`;
                progressBar.style.width = '30%';
              } else if (m.status === 'initializing api') {
                statusText.innerText = `Initializing OCR engine...`;
                progressBar.style.width = '60%';
              } else if (m.status && m.status.includes('loading')) {
                statusText.innerText = "Loading OCR data...";
                progressBar.style.width = '20%';
              } else {
                statusText.innerText = m.status || "Processing...";
              }
            }
          });

          // Load and initialize with retry logic
          statusText.innerText = "Loading language data...";
          await currentWorker.loadLanguage(selectedLang);
          await currentWorker.initialize(selectedLang);

          // Set OCR parameters for better accuracy
          await currentWorker.setParameters({
            tessedit_pageseg_mode: '3', // Auto detect
            tessedit_char_whitelist: '', // Allow all characters
            tessedit_ocr_engine_mode: '1', // LSTM OCR engine
          });

          statusText.innerText = "Processing image...";
          
          // Preprocess the image for better OCR
          const img = new Image();
          img.onload = async () => {
            try {
              const processedCanvas = preprocessImage(img);
              
              // Perform OCR on processed image
              const { data: { text, confidence, words } } = await currentWorker.recognize(processedCanvas);
              
              // Display results
              resultBox.value = text || "No text detected in the image.";
              statusText.innerText = `Done! Confidence: ${(confidence * 100).toFixed(1)}%`;
              progressBar.style.width = '100%';
              
              // Log word-level confidence for debugging
              console.log('OCR Results:', { text, confidence, words: words?.slice(0, 5) });
              
            } catch (processingError) {
              console.error('Image processing error:', processingError);
              throw new Error('Failed to process image for OCR');
            }
          };
          
          img.onerror = () => {
            throw new Error('Failed to load image for processing');
          };
          
          img.src = URL.createObjectURL(currentImageFile);
          
        } catch (err) {
          console.error('OCR Error:', err);
          statusText.innerText = "Error occurred";
          
          // Provide user-friendly error messages
          let errorMessage = "OCR processing failed. ";
          if (err.message.includes('network') || err.message.includes('fetch')) {
            errorMessage += "Please check your internet connection and try again.";
          } else if (err.message.includes('language') || err.message.includes('traineddata')) {
            errorMessage += "Language data could not be loaded. Please try again.";
          } else if (err.message.includes('memory') || err.message.includes('size')) {
            errorMessage += "Image may be too large. Try a smaller image.";
          } else {
            errorMessage += "Please try again with a clearer image.";
          }
          
          alert(errorMessage + "\n\nTechnical details: " + err.message);
          
        } finally {
          // Clean up worker
          if (currentWorker) {
            try {
              await currentWorker.terminate();
            } catch (e) {
              console.warn('Error terminating worker:', e);
            }
            currentWorker = null;
          }
          
          // Reset UI
          extractBtn.disabled = false;
          extractBtn.innerHTML = '<i class="fas fa-bolt"></i> <span data-translate-key="btn-extract">Extract Text</span>';
        }
      });

      // 6. Copy Result
      copyBtn.addEventListener('click', () => {
        if(!resultBox.value) return;
        navigator.clipboard.writeText(resultBox.value).then(() => {
            const originalHTML = copyBtn.innerHTML;
            copyBtn.innerHTML = '<i class="fas fa-check"></i> Copied';
            setTimeout(() => copyBtn.innerHTML = originalHTML, 2000);
        });
      });
    }

    // --- INIT ---
    function setLanguage(lang) {
      currentLang = lang; localStorage.setItem("userLanguage", lang);
      document.getElementById("flag-icon").src = lang === 'kh' ? "https://flagcdn.com/kh.svg" : "https://flagcdn.com/us.svg";
      document.getElementById("lang-text").innerText = lang === 'kh' ? "KH" : "EN";
      document.getElementById("lang-dropdown").style.display = 'none';
      applyTranslations(lang);
    }

    function applyTranslations(lang) {
      document.documentElement.lang = lang === 'kh' ? 'km' : 'en';
      document.querySelectorAll("[data-translate-key]").forEach(el => {
        const key = el.dataset.translateKey;
        if (translations[lang][key]) {
          // Sanitize text content to prevent XSS
          const text = translations[lang][key];
          if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
            el.placeholder = text;
          } else {
            el.textContent = text; // Use textContent instead of innerText for security
          }
        }
      });
      document.querySelectorAll(".kh-label").forEach(el => el.style.display = lang === 'kh' ? 'none' : 'inline-block');
      document.body.classList.toggle("font-khmer", lang === 'kh');
    }

    function toggleTheme() {
      document.body.classList.toggle("dark-theme");
      const isDark = document.body.classList.contains("dark-theme");
      document.getElementById("theme-toggle").innerText = isDark ? "â˜€ï¸" : "ðŸŒ™";
      localStorage.setItem("theme", isDark ? "dark" : "light");
    }

    document.addEventListener("DOMContentLoaded", () => {
      if (localStorage.getItem("theme") === "dark") {
        document.body.classList.add("dark-theme"); document.getElementById("theme-toggle").innerText = "â˜€ï¸";
      }
      setLanguage(currentLang);
      handleHashChange();
      window.addEventListener("hashchange", handleHashChange);
      document.getElementById("theme-toggle").addEventListener("click", toggleTheme);
      const langBtn = document.querySelector(".language-btn");
      const langDrop = document.getElementById("lang-dropdown");
      langBtn.addEventListener("click", (e) => { e.stopPropagation(); langDrop.style.display = langDrop.style.display === "block" ? "none" : "block"; });
      document.addEventListener("click", () => langDrop.style.display = "none");
      const menuBtn = document.getElementById("menu-btn");
      const nav = document.getElementById("main-nav");
      menuBtn.addEventListener("click", () => {
        const isActive = nav.classList.toggle("active");
        menuBtn.classList.toggle("active");
        // Update ARIA expanded state for accessibility
        menuBtn.setAttribute("aria-expanded", isActive);
      });
      
      // Search functionality
      const searchInput = document.getElementById("search-input");
      const searchResults = document.createElement("div");
      searchResults.className = "search-results";
      document.querySelector(".nav-search").appendChild(searchResults);
      
      const searchableItems = [
        { title: "Business Calculators", desc: "Pricing, subscriptions, billing tools", icon: "fas fa-calculator", hash: "#business-calc" },
        { title: "Finance Tools", desc: "Interest, tax, and financial calculators", icon: "fas fa-chart-line", hash: "#finance-tools" },
        { title: "Text Extraction", desc: "OCR text extraction from images", icon: "fas fa-image", hash: "#text-extraction" },
        { title: "Voice Extraction", desc: "Voice to text transcription", icon: "fas fa-microphone", hash: "#voice-extraction" },
        { title: "About", desc: "Learn more about the application", icon: "fas fa-user", hash: "#about" }
      ];
      
      searchInput.addEventListener("input", (e) => {
        const query = e.target.value.toLowerCase().trim();
        
        if (query.length < 2) {
          searchResults.style.display = "none";
          return;
        }
        
        const filtered = searchableItems.filter(item => 
          item.title.toLowerCase().includes(query) || 
          item.desc.toLowerCase().includes(query)
        );
        
        if (filtered.length > 0) {
          searchResults.innerHTML = filtered.map(item => `
            <div class="search-result-item" onclick="window.location.hash='${item.hash}'">
              <i class="${item.icon}"></i>
              <div>
                <div class="search-result-title">${item.title}</div>
                <div class="search-result-desc">${item.desc}</div>
              </div>
            </div>
          `).join("");
          searchResults.style.display = "block";
        } else {
          searchResults.innerHTML = `
            <div class="search-result-item">
              <i class="fas fa-search"></i>
              <div>
                <div class="search-result-title">No results found</div>
                <div class="search-result-desc">Try searching for something else</div>
              </div>
            </div>
          `;
          searchResults.style.display = "block";
        }
      });
      
      // Close search results when clicking outside
      document.addEventListener("click", (e) => {
        if (!e.target.closest(".nav-search")) {
          searchResults.style.display = "none";
        }
      });
      
      // Navbar scroll effect
      const header = document.querySelector('.app-header');
      let lastScroll = 0;
      window.addEventListener('scroll', () => {
        const currentScroll = window.pageYOffset;
        if (currentScroll > 50) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
        lastScroll = currentScroll;
      });
    });

    // --- MODAL FUNCTIONALITY ---
    let formulasInfoBtn = null;
    let formulasModal = null;
    let modalClose = null;
    
    // Function to initialize modal elements
    function initModalElements() {
      console.log('Initializing modal elements...');
      formulasInfoBtn = document.getElementById('formulas-info-btn');
      formulasModal = document.getElementById('formulas-modal');
      modalClose = document.getElementById('modal-close');
      
      console.log('Elements found:', {
        formulasInfoBtn: !!formulasInfoBtn,
        formulasModal: !!formulasModal,
        modalClose: !!modalClose
      });
      
      // Remove existing listeners to prevent duplicates
      if (formulasInfoBtn) {
        // Clone and replace to remove all existing event listeners
        const newBtn = formulasInfoBtn.cloneNode(true);
        formulasInfoBtn.parentNode.replaceChild(newBtn, formulasInfoBtn);
        formulasInfoBtn = newBtn;
        
        // Add fresh event listener with mobile support
        formulasInfoBtn.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          console.log('Formulas button clicked!');
          openModal();
        });
        
        // Add touch support for mobile
        formulasInfoBtn.addEventListener('touchstart', function(e) {
          e.preventDefault();
          console.log('Formulas button touched!');
          openModal();
        }, { passive: false });
        
        console.log('Event listeners added to formulas info button');
      } else {
        console.error('Formulas info button not found!');
      }
      
      if (modalClose) {
        modalClose.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          closeModal();
        });
        
        // Touch support for close button
        modalClose.addEventListener('touchstart', function(e) {
          e.preventDefault();
          closeModal();
        }, { passive: false });
        
        console.log('Event listener added to modal close button');
      }
      
      if (formulasModal) {
        // Click outside to close
        formulasModal.addEventListener('click', (e) => {
          if (e.target === formulasModal) {
            closeModal();
          }
        });
        
        // Touch outside to close for mobile
        formulasModal.addEventListener('touchstart', (e) => {
          if (e.target === formulasModal) {
            e.preventDefault();
            closeModal();
          }
        }, { passive: false });
        
        console.log('Event listener added to modal overlay');
      }
    }
    
    // Function to open modal
    function openModal() {
      console.log('Opening modal...');
      console.log('formulasModal:', formulasModal);
      if (formulasModal) {
        // Force display and visibility
        formulasModal.style.display = 'flex';
        formulasModal.style.opacity = '1';
        formulasModal.style.visibility = 'visible';
        formulasModal.classList.add('active');
        document.body.style.overflow = 'hidden';
        
        // Prevent body scroll on mobile
        document.body.style.position = 'fixed';
        document.body.style.width = '100%';
        
        console.log('Modal classes after adding:', formulasModal.className);
        console.log('Modal styles:', {
          display: formulasModal.style.display,
          opacity: formulasModal.style.opacity,
          visibility: formulasModal.style.visibility
        });
      } else {
        console.error('Modal element not found!');
      }
    }
    
    // Function to close modal
    function closeModal() {
      console.log('Closing modal...');
      if (formulasModal) {
        formulasModal.classList.remove('active');
        formulasModal.style.display = '';
        formulasModal.style.opacity = '';
        formulasModal.style.visibility = '';
        document.body.style.overflow = '';
        
        // Restore body scroll
        document.body.style.position = '';
        document.body.style.width = '';
      }
    }
    
    // Close modal with Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && formulasModal && formulasModal.classList.contains('active')) {
        closeModal();
      }
    });
    
    // Initialize modal when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initModalElements);
    } else {
      initModalElements();
    }
    
    // Also initialize when finance section is loaded (for dynamic content)
    setTimeout(initModalElements, 100);
    setTimeout(initModalElements, 500);
    
    // Add a global test function for debugging
    window.testModal = function() {
      console.log('Testing modal manually...');
      initModalElements();
      openModal();
    };
    
    // Add a global function to check modal state
    window.checkModal = function() {
      console.log('Modal state check:');
      console.log('Button exists:', !!document.getElementById('formulas-info-btn'));
      console.log('Modal exists:', !!document.getElementById('formulas-modal'));
      console.log('Close button exists:', !!document.getElementById('modal-close'));
      const modal = document.getElementById('formulas-modal');
      if (modal) {
        console.log('Modal classes:', modal.className);
        console.log('Modal computed style display:', window.getComputedStyle(modal).display);
        console.log('Modal computed style opacity:', window.getComputedStyle(modal).opacity);
        console.log('Modal computed style visibility:', window.getComputedStyle(modal).visibility);
      }
    };

    // --- ENHANCED CURRENCY SWITCHING ---
    function enhanceCurrencySwitching() {
      document.querySelectorAll('.currency-switcher').forEach(switcher => {
        const buttons = switcher.querySelectorAll('.currency-btn');
        const card = switcher.closest('.calc-card');
        
        buttons.forEach(btn => {
          btn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            // Get current active button
            const activeBtn = switcher.querySelector('.currency-btn.active');
            if (!activeBtn) return;
            
            const currentCurrency = activeBtn.dataset.curr;
            const newCurrency = this.dataset.curr;
            
            if (currentCurrency === newCurrency) return;
            
            // Add smooth transition class
            card.classList.add('currency-transitioning');
            
            // Update button states with animation
            buttons.forEach(b => {
              b.classList.remove('active');
              b.style.transform = 'scale(0.95)';
            });
            
            // Activate new button with delay for smooth effect
            setTimeout(() => {
              this.classList.add('active');
              this.style.transform = 'scale(1.02)';
              
              // Update card currency attribute
              card.dataset.currency = newCurrency;
              
              // Convert and update values
              convertCurrencyValues(card, currentCurrency, newCurrency);
              
              // Remove transition class
              setTimeout(() => {
                card.classList.remove('currency-transitioning');
                buttons.forEach(b => b.style.transform = '');
              }, 300);
            }, 150);
          });
        });
      });
    }
    
    function convertCurrencyValues(card, fromCurr, toCurr) {
      const inputs = card.querySelectorAll('input[data-format="currency"]');
      const outputs = card.querySelectorAll('.result-value, .sub-val');
      
      // Conversion rates (KHR to USD)
      const rates = {
        'khr': { 'usd': 0.00025, 'khr': 1 },
        'usd': { 'khr': 4000, 'usd': 1 }
      };
      
      const rate = rates[fromCurr]?.[toCurr];
      if (!rate) {
        console.error('Invalid conversion rate from', fromCurr, 'to', toCurr);
        return;
      }
      
      console.log('Converting from', fromCurr, 'to', toCurr, 'with rate:', rate);
      
      // Convert input values
      inputs.forEach(input => {
        if (input.value) {
          const numValue = parseFloat(input.value.replace(/[^\d.]/g, ''));
          if (!isNaN(numValue)) {
            const convertedValue = numValue * rate;
            input.value = formatCurrency(convertedValue, toCurr);
            console.log('Input converted:', numValue, 'â†’', convertedValue);
          }
        }
        
        // Update placeholder
        updatePlaceholder(input, toCurr);
      });
      
      // Convert output values
      outputs.forEach(output => {
        if (output.textContent && output.textContent !== '0') {
          const numValue = parseFloat(output.textContent.replace(/[^\d.]/g, ''));
          if (!isNaN(numValue)) {
            const convertedValue = numValue * rate;
            output.textContent = formatCurrency(convertedValue, toCurr);
            console.log('Output converted:', numValue, 'â†’', convertedValue);
          }
        }
      });
    }
    
    function formatCurrency(value, currency) {
      if (currency === 'khr') {
        return Math.round(value).toLocaleString();
      } else {
        return value.toFixed(2).toLocaleString();
      }
    }
    
    function updatePlaceholder(input, currency) {
      const placeholders = {
        'khr': {
          'si-p': '1,000,000 KHR',
          'ci-p': '1,000,000 KHR',
          'st-gross': '3,000,000 KHR',
          'vat-amt': '10,000 KHR'
        },
        'usd': {
          'si-p': '$1,000.00',
          'ci-p': '$1,000.00',
          'pt-val': '$100,000.00'
        }
      };
      
      if (placeholders[currency] && placeholders[currency][input.id]) {
        input.placeholder = placeholders[currency][input.id];
      }
    }
    
    // Add currency transition styles
    const style = document.createElement('style');
    style.textContent = `
      .currency-transitioning {
        pointer-events: none;
      }
      
      .currency-transitioning input,
      .currency-transitioning .result-value {
        transition: all 0.3s ease;
        opacity: 0.7;
      }
      
      .currency-btn {
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
      }
    `;
    document.head.appendChild(style);
    
    // Initialize enhanced currency switching
    document.addEventListener('DOMContentLoaded', function() {
      // Initial setup
      enhanceCurrencySwitching();
      
      // Re-initialize when finance section is loaded
      const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          if (mutation.addedNodes.length) {
            const switchers = document.querySelectorAll('.currency-switcher');
            if (switchers.length > 0) {
              enhanceCurrencySwitching();
            }
          }
        });
      });
      
      observer.observe(document.body, {
        childList: true,
        subtree: true
      });
      
      // Also try initializing after a delay to catch dynamic content
      setTimeout(() => {
        enhanceCurrencySwitching();
      }, 500);
    });
    
    // Immediate initialization for any existing elements
    enhanceCurrencySwitching();
    
    // Simple fallback for immediate functionality
    document.addEventListener('click', function(e) {
      if (e.target.matches('.currency-btn')) {
        e.preventDefault();
        const switcher = e.target.closest('.currency-switcher');
        if (switcher) {
          const buttons = switcher.querySelectorAll('.currency-btn');
          buttons.forEach(b => b.classList.remove('active'));
          e.target.classList.add('active');
        }
      }
    });
  </script>

  <!-- Formulas & Information Modal -->
  <div class="modal-overlay" id="formulas-modal">
    <div class="modal">
      <div class="modal-header">
        <h2>Formulas & Information</h2>
        <p>Complete guide to financial calculations and tax rates</p>
        <button class="modal-close" id="modal-close">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="modal-body">
        <!-- Tax Information Section -->
        <div class="modal-section">
          <h3><i class="fas fa-money-bill-wave"></i> Tax on Salary (Monthly)</h3>
          <div class="formula-card">
            <div class="table-wrapper">
              <table class="tax-table">
                <thead>
                  <tr>
                    <th>Range (KHR)</th>
                    <th>Rate</th>
                    <th>Deduct</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td>0 - 1.5M</td><td>0%</td><td>0</td></tr>
                  <tr><td>1.5M - 2M</td><td>5%</td><td>75k</td></tr>
                  <tr><td>2M - 8.5M</td><td>10%</td><td>175k</td></tr>
                  <tr><td>8.5M - 12.5M</td><td>15%</td><td>600k</td></tr>
                  <tr><td>> 12.5M</td><td>20%</td><td>1,225k</td></tr>
                </tbody>
              </table>
            </div>
            <div class="formula-note">
              <i class="fas fa-info-circle"></i>
              <span>Rebate: 150,000 KHR per dependent.</span>
            </div>
          </div>
        </div>

        <!-- Financial Formulas Section -->
        <div class="modal-section">
          <h3><i class="fas fa-calculator"></i> Financial Formulas</h3>
          <div class="formula-card">
            <div class="formula-grid">
              <div class="formula-box">SI = P Ã— R Ã— T</div>
              <div class="formula-box">CI = P(1 + R/n)<sup>nt</sup></div>
              <div class="formula-box">VAT = Price Ã— 0.10</div>
              <div class="formula-box">Prop Tax = Value Ã— 0.04</div>
            </div>
          </div>
        </div>

        <!-- Formula Explanations -->
        <div class="modal-section">
          <h3><i class="fas fa-book"></i> Formula Explanations</h3>
          <div class="formula-card">
            <div class="formula-explanation">
              <h4>Simple Interest (SI)</h4>
              <p>P = Principal amount, R = Annual interest rate, T = Time in years</p>
            </div>
            <div class="formula-explanation">
              <h4>Compound Interest (CI)</h4>
              <p>P = Principal, R = Annual rate, n = Compounding frequency per year, t = Time in years</p>
            </div>
            <div class="formula-explanation">
              <h4>VAT (Value Added Tax)</h4>
              <p>10% tax applied to the price of goods and services in Cambodia</p>
            </div>
            <div class="formula-explanation">
              <h4>Property Transfer Tax</h4>
              <p>4% tax applied to the value of property transfers in Cambodia</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

</html>
